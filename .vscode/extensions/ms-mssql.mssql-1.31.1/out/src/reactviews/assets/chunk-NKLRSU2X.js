import{Eb as F,Kc as W,Lc as O,P as w,Z as k,c as S,d as X,hb as E,r as M,tb as P,vb as T,wb as B,xb as L,yb as R}from"./chunk-BAOGVYAT.js";var n=S(X());var a=S(M()),h=(e,l)=>{let r=e.text||e.value;return r===""&&l?l:r},$=(e,l)=>e?(e=e.toLowerCase(),l.map(r=>{let c=h(r).toLowerCase(),i=0;return c===e?i=3:c.startsWith(e)?i=2:c.includes(e)&&(i=1),{item:r,score:i}}).filter(r=>r.score>0).sort((r,s)=>s.score-r.score).map(r=>r.item)):l,Z=e=>{let[l,r]=(0,n.useState)(""),[s,c]=(0,n.useState)(e.selectedOption??{value:""}),i=e.id??(0,n.useId)(),H=`${i}-listbox`,[u,K]=(0,n.useState)(0),d=(0,n.useRef)(null),f=(0,n.useRef)(null),[x,p]=(0,n.useState)(!1),y=(0,n.useRef)(null),m=(0,n.useRef)({}),[z,v]=(0,n.useState)(!1),[D,I]=(0,n.useState)(-1),[N,C]=(0,n.useState)(!1),g=t=>{let o=e.options.findIndex(b=>b.value===t.value);c(t),I(o),e.onSelect(t,o),p(!1),v(!1)},V=t=>{if(t.key==="Enter"){if(!l)return;let o=$(l,e.options);o.length>0&&(g(o[0]),t.stopPropagation(),t.preventDefault())}else t.key==="Escape"&&p(!1)},_=(t,o)=>{r(o.value||"")},q=()=>$(l,e.options).map(t=>(0,a.jsx)(T,{ref:o=>{o&&(m.current[t.value]=o)},onClick:()=>{g(t)},style:{width:`${u-10}px`,maxWidth:`${u-10}px`,padding:"5px 0px",margin:"2px"},name:"dropdown-options",value:t.value,onFocus:()=>{N&&(m.current[s.value]&&setTimeout(()=>{m.current[s.value]?.focus()},0),C(!1))},children:h(t)},`${i}-${t.value}`)),A=()=>e.clearable?D===-1?(0,a.jsx)(w,{}):(0,a.jsx)(k,{style:{cursor:"pointer"},onClick:t=>{g({value:""}),t.stopPropagation(),d.current?.focus()},onKeyDown:t=>{t.key==="Enter"&&(g({value:""}),t.stopPropagation(),d.current?.focus())},"aria-label":O.common.clearSelection,title:O.common.clearSelection,role:"button",tabIndex:0}):(0,a.jsx)(w,{});return(0,n.useEffect)(()=>{d.current&&K(Math.max(d.current.offsetWidth-10,200))},[d.current]),(0,n.useEffect)(()=>{c(e.selectedOption??e.options[0]),I(e.options.findIndex(t=>t.value===e.selectedOption?.value))},[e.selectedOption]),(0,a.jsxs)(P,{positioning:{autoSize:!0},onOpenChange:async(t,o)=>{r(""),f.current&&f.current.focus(),p(o.open),D!==-1&&!z&&requestAnimationFrame(()=>{let b=m.current[s.value];b&&y.current&&b.scrollIntoView({block:"nearest",behavior:"instant"}),v(!0)}),o.open||v(!1)},open:x,hasCheckmarks:!0,checkedValues:{"dropdown-options":[s.value]},"aria-label":e.ariaLabel||"options",children:[(0,a.jsx)(R,{disableButtonEnhancement:!0,children:(0,a.jsx)(E,{id:i,size:e.size??"medium",ref:d,icon:A(),iconPosition:"after",role:"combobox","aria-haspopup":"listbox","aria-expanded":x,"aria-label":e.ariaLabel,disabled:e.disabled,className:x?"dropdown-open":"",style:{...e.style,justifyContent:"space-between",fontWeight:400},children:(0,a.jsx)(F,{style:{overflow:"hidden",textOverflow:"ellipsis"},className:h(s,e.placeholder)===e.placeholder?"placeholder":"",title:h(s,e.placeholder),children:h(s,e.placeholder)})})}),(0,a.jsx)(L,{style:{width:u},children:(0,a.jsxs)(B,{children:[(0,a.jsx)(W,{ref:f,placeholder:e.searchBoxPlaceholder,value:l,onChange:(t,o)=>_(t,o),"aria-controls":H,onKeyDown:t=>V(t),style:{width:u,maxWidth:u},onFocus:()=>{C(!0)}}),(0,a.jsx)("div",{style:{maxHeight:"200px",overflowY:"auto",width:`${u}px`,overflowX:"hidden"},role:"presentation",ref:y,onKeyDown:t=>{t.key==="Escape"&&(p(!1),v(!1)),f.current&&(t.key.length===1||t.key==="Backspace")&&(f.current?.focus(),f.current.value=t.key)},children:q()})]})})]})};export{Z as a};
