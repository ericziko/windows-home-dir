import{a as Je,b as h,c as A,d as Ue}from"./chunk-JLQQYAZO.js";import{a as ko}from"./chunk-AIFE2KJ5.js";import{a as Xe}from"./chunk-NKLRSU2X.js";import{A as Ie,Ab as de,Bb as V,Dc as Ee,Eb as E,Gb as ke,Gc as We,Hb as X,Hc as Ge,Ic as qe,Jb as Q,Kb as Y,Lb as j,Lc as t,Ma as Fe,Mb as ee,Mc as Ze,Nb as oe,Nc as Ke,Oa as Ae,Pc as _e,Qc as W,Ra as ce,Sc as $e,Va as Re,Wa as ze,Ya as Ne,a as _,ab as Be,bb as Le,c as a,d as w,g as Mo,hb as D,j as ye,k as T,kb as $,pb as Te,qc as He,r as l,rb as J,rc as Oe,sa as Pe,sb as U,xa as le,xc as Ve,y as we,yc as M,z as he,zb as Me}from"./chunk-BAOGVYAT.js";var lo=_((_n,Vo)=>{Vo.exports="./database_light-P2676YLL.svg"});var co=_(($n,Eo)=>{Eo.exports="./database_dark-Z7UUEBQM.svg"});var fo=_((dt,qo)=>{qo.exports="./azure-inverse-BNVI7L64.svg"});var vo=_((pt,Zo)=>{Zo.exports="./azure-DLOJF6JL.svg"});var yo=a(Mo());var xo=a(ko());var L=a(w());var Qe=a(w());var je=a(l()),S=(0,Qe.createContext)(void 0),Ye=({children:e})=>{let n=Ke(),r=n?.state;return(0,je.jsx)(S.Provider,{value:{state:r,themeKind:n?.themeKind,...$e(n),loadConnection:function(o){n?.extensionRpc.action("loadConnection",{connection:o})},formAction:function(o){n?.extensionRpc.action("formAction",{event:o})},setConnectionInputType:function(o){n?.extensionRpc.action("setConnectionInputType",{inputMode:o})},connect:function(){n?.extensionRpc.action("connect")},loadAzureServers:function(o){n?.extensionRpc.action("loadAzureServers",{subscriptionId:o})},addFirewallRule:function(o){n?.extensionRpc.action("addFirewallRule",{firewallRuleSpec:o})},closeDialog:function(){n?.extensionRpc.action("closeDialog")},filterAzureSubscriptions:function(){n.extensionRpc.action("filterAzureSubscriptions")},refreshConnectionsList:function(){n.extensionRpc.action("refreshConnectionsList")},deleteSavedConnection:function(o){n.extensionRpc.action("deleteSavedConnection",{connection:o})},removeRecentConnection:function(o){n.extensionRpc.action("removeRecentConnection",{connection:o})},loadFromConnectionString:function(o){n.extensionRpc.action("loadFromConnectionString",{connectionString:o})},openConnectionStringDialog:function(){n.extensionRpc.action("openConnectionStringDialog")},getConnectionDisplayName:async function(o){return await n.extensionRpc.call("getConnectionDisplayName",o)},signIntoAzureForFirewallRule:function(){n.extensionRpc.action("signIntoAzureForFirewallRule")}},children:e})};var v=a(l()),pe="buttonContainer",oo=T({paneTitle:{marginTop:"12px",marginBottom:"12px",marginRight:"12px"},main:{gap:"5px",display:"flex",flexDirection:"column",flexWrap:"wrap"},connectionContainer:{width:"100%",maxWidth:"100%",height:"fit-content",padding:"5px",margin:"0px",[`& .${pe}`]:{visibility:"hidden"},":hover":{[`& .${pe}`]:{visibility:"visible"}}},horizontalCardImage:{width:"50px",height:"30px",paddingRight:"0px"},caption:{color:we.colorNeutralForeground3},text:{margin:"0"}}),no=()=>{let e=oo(),n=(0,L.useContext)(S);if(n!==void 0)return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:e.paneTitle,children:[(0,v.jsx)(E,{weight:"semibold",className:e.paneTitle,children:t.connectionDialog.savedConnections}),(0,v.jsx)(D,{icon:(0,v.jsx)(le,{}),appearance:"subtle",onClick:n.refreshConnectionsList})]}),(0,v.jsx)("div",{className:e.main,children:n.state?.savedConnections.map((r,o)=>(0,v.jsx)(eo,{connection:r,actionButton:{icon:(0,v.jsx)(ce,{}),onClick:s=>{n.deleteSavedConnection(r),s.stopPropagation()},tooltip:t.connectionDialog.deleteSavedConnection}},"saved"+o))}),(0,v.jsxs)("div",{className:e.paneTitle,children:[(0,v.jsx)(E,{weight:"semibold",className:e.paneTitle,children:t.connectionDialog.recentConnections}),(0,v.jsx)(D,{icon:(0,v.jsx)(le,{}),appearance:"subtle",onClick:n.refreshConnectionsList})]}),(0,v.jsx)(Ve,{children:n.state?.recentConnections.map((r,o)=>(0,v.jsx)(eo,{connection:r,actionButton:{icon:(0,v.jsx)(ce,{}),onClick:s=>{n.removeRecentConnection(r),s.stopPropagation()},tooltip:t.connectionDialog.removeRecentConnection}},"mru"+o))})]})},eo=({connection:e,actionButton:n})=>{let r=oo(),o=(0,L.useContext)(S),[s,f]=(0,L.useState)(e.profileName||e.server);if((0,L.useEffect)(()=>{let m=!0;return(async()=>{if(o){let F=await o.getConnectionDisplayName(e);m&&f(F)}})(),()=>{m=!1}},[o,e]),o!==void 0)return(0,v.jsx)(He,{className:r.connectionContainer,appearance:"subtle",onClick:()=>{o.loadConnection(e)},children:(0,v.jsx)(Oe,{image:(0,v.jsx)(Pe,{fontSize:20}),header:s,action:n&&(0,v.jsx)("div",{className:pe,children:(0,v.jsx)(D,{icon:n.icon,appearance:"subtle",onClick:n.onClick,title:n.tooltip})})})})};var Do=a(w());var d=a(w());var io=a(w());var ue=a(l()),Ho="connectButton",ne=({style:e,className:n})=>{let r=(0,io.useContext)(S);if(r)return(0,ue.jsx)(D,{id:Ho,type:"submit",appearance:"primary",disabled:r.state.connectionStatus==="loading"||!r.state.readyToConnect,className:n,style:e,iconPosition:"after",icon:r.state.connectionStatus==="loading"?(0,ue.jsx)(V,{size:"tiny"}):void 0,children:t.connectionDialog.connect})};var ro=a(w());var x=a(l()),te=({isAdvancedDrawerOpen:e,setIsAdvancedDrawerOpen:n})=>{let r=(0,ro.useContext)(S);if(r!==void 0)return(0,x.jsxs)(Ee,{position:"end",size:"medium",open:e,onOpenChange:(o,{open:s})=>n(s),children:[(0,x.jsx)(Ge,{children:(0,x.jsx)(qe,{action:(0,x.jsx)(D,{appearance:"subtle","aria-label":"Close",icon:(0,x.jsx)(Re,{}),onClick:()=>n(!1)}),children:t.connectionDialog.advancedConnectionSettings})}),(0,x.jsxs)(We,{children:[(0,x.jsx)("div",{style:{margin:"20px 0px"},children:r.state.connectionComponents.topAdvancedOptions.map((o,s)=>(0,x.jsx)(h,{context:r,component:r.state.formComponents[o],idx:s},s))}),(0,x.jsx)(he,{multiple:!0,collapsible:!0,children:r.state.connectionComponents.groupedAdvancedOptions.map((o,s)=>(0,x.jsxs)(Ie,{value:o.groupName,children:[(0,x.jsx)(Be,{children:o.groupName}),(0,x.jsx)(Le,{children:o.options.map((f,m)=>{if(r.state.formComponents[f]?.hidden!==!0)return(0,x.jsx)(h,{context:r,component:r.state.formComponents[f],idx:m},m)})})]},s))})]})]})};function G(e,n,r,o,s=1){if(e===void 0||e&&!o.includes(e)){let f;if(o.length>0)switch(s){case 0:f=o.length>0?o[0]:void 0;break;case 2:f=o.length===1?o[0]:void 0;break;case 1:default:f=void 0}n(f),r(f??"")}}var ie=a(w());var k=a(l()),Oo=T({decoration:{display:"flex",alignItems:"center",columnGap:"4px"}}),H=({label:e,required:n,clearable:r,content:o,decoration:s})=>{let f=A(),m=Oo(),[y,F]=(0,ie.useState)("");(0,ie.useEffect)(()=>{o.valueList.includes(o.value)&&F("")},[o.value]);let Z=()=>{o.value&&F(o.valueList.includes(o.value)?"":o.invalidOptionErrorMessage)},K=z=>{o.setSelection(z.value??""),o.setValue(z.value??"")};return(0,k.jsx)("div",{className:f.formComponentDiv,children:(0,k.jsx)($,{label:s?(0,k.jsxs)("div",{className:m.decoration,children:[e,s]}):e,orientation:"horizontal",required:n,validationMessage:y,onBlur:Z,children:(0,k.jsx)(Xe,{size:"small",selectedOption:{value:o.value},onSelect:K,placeholder:o.placeholder,searchBoxPlaceholder:o.placeholder,options:o.valueList.map(z=>({value:z,label:z})),clearable:r})})})};var u=a(l()),ao=()=>{let e=(0,d.useContext)(S),n=A(),[r,o]=(0,d.useState)(!1);if(e===void 0)return;let[s,f]=(0,d.useState)([]),[m,y]=(0,d.useState)(void 0),[F,Z]=(0,d.useState)(""),[K,z]=(0,d.useState)([]),[N,me]=(0,d.useState)(void 0),[wo,ge]=(0,d.useState)(""),[Ce,ho]=(0,d.useState)([]),[O,fe]=(0,d.useState)(void 0),[Io,ve]=(0,d.useState)(""),[Po,Fo]=(0,d.useState)([]),[B,Ao]=(0,d.useState)(void 0),[Ro,se]=(0,d.useState)(""),[zo,No]=(0,d.useState)([]),[Bo,De]=(0,d.useState)(void 0),[Lo,To]=(0,d.useState)("");function Se(i){Ao(i),xe("server",i?i+".database.windows.net":"")}(0,d.useEffect)(()=>{let i=W(e.state.azureSubscriptions.map(p=>`${p.name} (${p.id})`));f(i.sort()),G(m,y,Z,i,1)},[e.state.azureSubscriptions]),(0,d.useEffect)(()=>{let i=e.state.azureServers;m&&(i=i.filter(c=>c.subscription===m));let p=W(i.map(c=>c.resourceGroup));z(p.sort()),G(N,me,ge,p,1)},[s,m,e.state.azureServers]),(0,d.useEffect)(()=>{let i=e.state.azureServers;m&&(i=i.filter(c=>c.subscription===m)),N&&(i=i.filter(c=>c.resourceGroup===N));let p=W(i.map(c=>c.location));ho(p.sort()),G(O,fe,ve,p,1)},[K,N,e.state.azureServers]),(0,d.useEffect)(()=>{let i=e.state.azureServers;m&&(i=i.filter(c=>c.subscription===m)),N&&(i=i.filter(c=>c.resourceGroup===N)),O&&(i=i.filter(c=>c.location===O));let p=W(i.map(c=>c.server));Fo(p.sort()),B===""?se(""):G(B,Se,se,p,0)},[Ce,O,e.state.azureServers]),(0,d.useEffect)(()=>{if(!B)return;let i=e.state.azureServers.find(c=>c.server===B);if(!i)return;let p=i.databases;No(p.sort()),De(p.length===1?p[0]:void 0)},[B]);function xe(i,p){e.formAction({propertyName:i,value:p,isAction:!1})}return(0,u.jsxs)("div",{children:[(0,u.jsx)(H,{label:t.connectionDialog.subscriptionLabel,clearable:!0,decoration:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(D,{icon:(0,u.jsx)(ze,{}),appearance:"subtle",title:t.connectionDialog.filterSubscriptions,onClick:()=>{e.filterAzureSubscriptions()},size:"small"}),e.state.loadingAzureSubscriptionsStatus==="loading"?(0,u.jsx)(V,{size:"tiny"}):void 0]}),content:{valueList:s,value:F,setValue:Z,selection:m,setSelection:i=>{if(y(i),i===void 0)return;let p=i.indexOf("(");if(p===-1)return;let c=i.indexOf(")",p);if(c===-1)return;let be=i.substring(p+1,c);be.length!==0&&e.loadAzureServers(be)},placeholder:t.connectionDialog.azureFilterPlaceholder(t.connectionDialog.subscription),invalidOptionErrorMessage:t.connectionDialog.invalidAzureBrowse(t.connectionDialog.subscription)}}),(0,u.jsx)(H,{label:t.connectionDialog.resourceGroupLabel,clearable:!0,content:{valueList:K,value:wo,setValue:ge,selection:N,setSelection:me,placeholder:t.connectionDialog.azureFilterPlaceholder(t.connectionDialog.resourceGroup),invalidOptionErrorMessage:t.connectionDialog.invalidAzureBrowse(t.connectionDialog.resourceGroup)}}),(0,u.jsx)(H,{label:t.connectionDialog.locationLabel,clearable:!0,content:{valueList:Ce,value:Io,setValue:ve,selection:O,setSelection:fe,placeholder:t.connectionDialog.azureFilterPlaceholder(t.connectionDialog.location),invalidOptionErrorMessage:t.connectionDialog.invalidAzureBrowse(t.connectionDialog.location)}}),(0,u.jsx)(H,{label:t.connectionDialog.serverLabel,required:!0,decoration:e.state.loadingAzureServersStatus==="loading"?(0,u.jsx)(V,{size:"tiny"}):void 0,content:{valueList:Po,value:Ro,setValue:se,selection:B,setSelection:Se,invalidOptionErrorMessage:t.connectionDialog.invalidAzureBrowse(t.connectionDialog.server)}}),B&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h,{context:e,component:e.state.formComponents.trustServerCertificate,idx:0,props:{orientation:"horizontal"}}),(0,u.jsx)(H,{label:t.connectionDialog.databaseLabel,clearable:!0,content:{valueList:zo,value:Lo,setValue:To,selection:Bo,setSelection:i=>{De(i),xe("database",i??"")},placeholder:`<${t.connectionDialog.default}>`,invalidOptionErrorMessage:t.connectionDialog.invalidAzureBrowse(t.connectionDialog.database)}}),e.state.connectionComponents.mainOptions.filter(i=>!["server","database","trustServerCertificate"].includes(i)).map((i,p)=>{let c=e.state.formComponents[i];if(c?.hidden===!1)return(0,u.jsx)(h,{context:e,component:c,idx:p,props:{orientation:"horizontal"}},p)})]}),(0,u.jsx)(te,{isAdvancedDrawerOpen:r,setIsAdvancedDrawerOpen:o}),(0,u.jsxs)("div",{className:n.formNavTray,children:[(0,u.jsx)(D,{onClick:i=>{o(!r)},className:n.formNavTrayButton,children:t.connectionDialog.advancedSettings}),(0,u.jsx)("div",{className:n.formNavTrayRight,children:(0,u.jsx)(ne,{className:n.formNavTrayButton})})]})]})};var re=a(w());var I=a(l()),so=()=>{let e=(0,re.useContext)(S),[n,r]=(0,re.useState)(!1),o=A();if(e!==void 0)return(0,I.jsxs)("div",{children:[e.state.connectionComponents.mainOptions.map((s,f)=>{let m=e.state.formComponents[s];if(m?.hidden===!1)return(0,I.jsx)(h,{context:e,component:m,idx:f,props:{orientation:"horizontal"}},f)}),(0,I.jsx)(te,{isAdvancedDrawerOpen:n,setIsAdvancedDrawerOpen:r}),(0,I.jsxs)("div",{className:o.formNavTray,children:[(0,I.jsx)(D,{onClick:s=>{r(!n)},className:o.formNavTrayButton,children:t.connectionDialog.advancedSettings}),(0,I.jsx)("div",{className:o.formNavTrayRight,children:(0,I.jsx)(ne,{className:o.formNavTrayButton})})]})]})};var po=a(w());var q=a(l()),Wo=lo(),Go=co(),uo=()=>{let e=(0,po.useContext)(S);return(0,q.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,q.jsx)(J,{style:{padding:"10px"},src:e?.themeKind===1?Wo:Go,alt:t.connectionDialog.connectToDatabase,height:60,width:60}),(0,q.jsx)(E,{size:500,style:{lineHeight:"60px"},weight:"medium",children:t.connectionDialog.connectToDatabase})]})};var mo=a(w());var b=a(l()),go=({dialogProps:e})=>{let n=(0,mo.useContext)(S);if(n.state.dialog?.type==="trustServerCert")return(0,b.jsx)(X,{open:e.type==="trustServerCert",children:(0,b.jsx)(ee,{children:(0,b.jsxs)(Y,{children:[(0,b.jsx)(j,{children:t.connectionDialog.connectionErrorTitle}),(0,b.jsxs)(oe,{children:[(0,b.jsx)(M,{intent:"error",style:{paddingRight:"12px"},children:e.message}),(0,b.jsx)("br",{}),t.connectionDialog.trustServerCertMessage,(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),t.connectionDialog.trustServerCertPrompt," ",(0,b.jsx)(U,{href:Je,children:t.connectionDialog.readMore})]}),(0,b.jsxs)(Q,{children:[(0,b.jsx)(D,{appearance:"primary",onClick:()=>{n.closeDialog(),n.formAction({propertyName:"trustServerCertificate",value:!0,isAction:!1}),n.connect()},children:t.connectionDialog.enableTrustServerCertificateButton}),(0,b.jsx)(D,{appearance:"secondary",onClick:()=>{n.closeDialog()},children:t.common.cancel})]})]})})})};var R=a(w());var g=a(l()),Co=({dialogProps:e})=>{let n=(0,R.useContext)(S),[r,o]=(0,R.useState)(e.connectionString||""),s=(0,R.useRef)(null);if((0,R.useEffect)(()=>{s.current&&setTimeout(()=>{s.current?.focus()},50)},[]),n.state.dialog?.type!=="loadFromConnectionString")return;let f=async()=>{try{await navigator.clipboard.writeText(r)}catch(y){console.error("Failed to copy connection string: ",y)}},m=async()=>{try{let y=await navigator.clipboard.readText();o(y)}catch(y){console.error("Failed to paste connection string: ",y)}};return(0,g.jsx)(X,{open:e.type==="loadFromConnectionString",children:(0,g.jsx)(ee,{children:(0,g.jsxs)(Y,{children:[(0,g.jsxs)(j,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,g.jsx)("span",{children:t.connectionDialog.loadFromConnectionString}),(0,g.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,g.jsx)(D,{appearance:"transparent",size:"small",icon:(0,g.jsx)(Ae,{}),onClick:f,title:t.connectionDialog.copyConnectionString}),(0,g.jsx)(D,{appearance:"transparent",size:"small",icon:(0,g.jsx)(Fe,{}),onClick:m,title:t.connectionDialog.pasteConnectionString})]})]}),(0,g.jsxs)(oe,{children:[e.connectionStringError&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(M,{intent:"error",style:{paddingRight:"12px"},children:e.connectionStringError}),(0,g.jsx)("br",{})]}),(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"10px"},children:[" ",(0,g.jsx)(ke,{ref:s,value:r,onChange:(y,F)=>o(F.value),resize:"none",style:{height:"200px"}})]})]}),(0,g.jsxs)(Q,{children:[(0,g.jsx)(D,{appearance:"primary",onClick:()=>{n.loadFromConnectionString(r)},children:t.common.load}),(0,g.jsx)(D,{appearance:"secondary",onClick:()=>{n.closeDialog()},children:t.common.cancel})]})]})})})};var C=a(l());function Ko(e){switch(e?.state.selectedInputMode){case"parameters":return(0,C.jsx)(so,{});case"azureBrowse":return(0,C.jsx)(ao,{})}}var So=()=>{let e=(0,Do.useContext)(S),n=A();function r(s){return _e(s)==="dark"?fo():vo()}function o(s){s.preventDefault(),e.connect()}return(0,C.jsxs)("form",{onSubmit:o,className:n.formRoot,children:[(0,C.jsx)(uo,{}),(0,C.jsxs)("div",{className:n.formDiv,style:{overflow:"auto"},children:[e.state.formError&&(0,C.jsx)(M,{intent:"error",style:{minHeight:"min-content"},children:e.state.formError}),e.state.dialog?.type==="trustServerCert"&&(0,C.jsx)(go,{dialogProps:e.state.dialog}),e.state.dialog?.type==="addFirewallRule"&&(0,C.jsx)(Ue,{state:e.state.dialog.props,addFirewallRule:e.addFirewallRule,closeDialog:e.closeDialog,signIntoAzure:e.signIntoAzureForFirewallRule}),e.state.dialog?.type==="loadFromConnectionString"&&(0,C.jsx)(Co,{dialogProps:e.state.dialog}),(0,C.jsx)(h,{context:e,component:e.state.formComponents.profileName,idx:0,props:{orientation:"horizontal"}}),(0,C.jsx)("div",{className:n.formComponentDiv,children:(0,C.jsx)($,{label:"Input type",orientation:"horizontal",children:(0,C.jsxs)(Me,{onChange:(s,f)=>{e.setConnectionInputType(f.value)},value:e.state.selectedInputMode,children:[(0,C.jsx)(de,{value:"parameters",label:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,C.jsx)(Ne,{style:{marginRight:"8px"}}),t.connectionDialog.parameters,(0,C.jsx)("span",{style:{margin:"0 8px"}}),(0,C.jsx)(U,{onClick:()=>{e.openConnectionStringDialog()},inline:!0,children:t.connectionDialog.loadFromConnectionString})]})}),(0,C.jsx)(de,{value:"azureBrowse",label:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,C.jsx)(J,{src:r(e.themeKind),alt:"Azure",height:20,width:20,style:{marginRight:"8px"}}),t.connectionDialog.browseAzure]})})]})})}),Ko(e)]})]})};var P=a(l()),_o=T({root:{flexDirection:"row",display:"flex",height:"100%",width:"100%",maxWidth:"100%",maxHeight:"100%"},mainContainer:{...ye.flex(1),height:"100%"},mruContainer:{position:"relative",height:"100%",width:"325px",padding:"20px"},mruPaneHandle:{position:"absolute",top:"0",left:"0",width:"10px",height:"100%",cursor:"ew-resize",zIndex:1}}),bo=()=>{let e=_o();return(0,P.jsxs)("div",{className:e.root,children:[(0,P.jsx)("div",{className:e.mainContainer,children:(0,P.jsx)(So,{})}),(0,P.jsx)(Te,{style:{width:"5px",height:"100%",flex:0},vertical:!0}),(0,P.jsx)(xo.ResizableBox,{className:e.mruContainer,width:350,height:1/0,maxConstraints:[800,1/0],minConstraints:[300,1/0],resizeHandles:["w"],handle:(0,P.jsx)("div",{className:e.mruPaneHandle}),children:(0,P.jsx)(no,{})})]})};var ae=a(l());yo.default.createRoot(document.getElementById("root")).render((0,ae.jsx)(Ze,{children:(0,ae.jsx)(Ye,{children:(0,ae.jsx)(bo,{})})}));
