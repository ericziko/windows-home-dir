import{a as Gt}from"./chunk-AIFE2KJ5.js";import{a as Pt}from"./chunk-AZ7WHKR6.js";import{a as vt,b as wt,d as Ct}from"./chunk-EQBJOA2X.js";import{a as xe}from"./chunk-NKLRSU2X.js";import{A as Ee,Ac as mt,Bb as J,Bc as bt,Cb as se,Cc as De,Db as me,Eb as be,Gb as et,H as Me,Hb as tt,Ib as Q,J as Ae,Jb as ae,K as Ve,Kb as rt,Lb as nt,Lc as p,Mb as it,Mc as ft,Nb as $,Nc as ht,O as He,Ob as fe,Oc as Dt,Pb as ot,Q as Le,R as We,S as Oe,Sb as st,Sc as xt,Tb as at,Ub as he,V as Fe,Vb as lt,W as Ue,Wb as Se,X as _e,Xb as pt,Y as Ge,Yb as dt,Z as Ke,Zb as ct,_b as ut,ab as Ye,bb as Je,c,cb as Qe,d as M,da as O,g as _t,h as W,hb as T,ia as $e,j as I,jb as Ze,k,kb as F,lb as ce,ma as je,p as ke,pb as ue,qa as Xe,qb as ge,r as C,wa as qe,yc as gt,z as Ne}from"./chunk-BAOGVYAT.js";var Ot=c(_t());var A=c(M()),yt=c(C()),y=(0,A.createContext)(void 0),Tt=({children:n})=>{let e=ht(),[r,l]=(0,A.useState)(300),[s,t]=(0,A.useState)(!1),[a,D]=(0,A.useState)(300),[v,P]=(0,A.useState)(450),[f,o]=(0,A.useState)(!1),[m,u]=(0,A.useState)(450),g=(0,A.useRef)({}),d=e?.state;function S(E){return`${d.tableInfo?.id}_${E.join("_")}`}return(0,yt.jsx)(y.Provider,{value:{...xt(e),processTableEdit:function(E){e?.extensionRpc.action("processTableEdit",{table:d.tableInfo,tableChangeInfo:E})},publishChanges:function(){e?.extensionRpc.action("publishChanges",{table:d.tableInfo})},generateScript:function(){e?.extensionRpc.action("generateScript",{table:d.tableInfo})},generatePreviewReport:function(){e?.extensionRpc.action("generatePreviewReport",{table:d.tableInfo})},initializeTableDesigner:function(){e?.extensionRpc.action("initializeTableDesigner",{table:d.tableInfo})},scriptAsCreate:function(){e?.extensionRpc.action("scriptAsCreate",{})},copyScriptAsCreateToClipboard:function(){e?.extensionRpc.action("copyScriptAsCreateToClipboard",{})},setTab:function(E){e?.extensionRpc.action("setTab",{tabId:E})},getComponentId:S,getErrorMessage:function(E){let K=E.join("."),V=[];for(let U of d.issues??[])U.propertyPath&&U.propertyPath?.join(".")===K&&V.push(U.description);if(V.length!==0)return V.join(`
`)??""},setPropertiesComponents:function(E){e?.extensionRpc.action("setPropertiesComponents",{components:E})},setResultTab:function(E){e?.extensionRpc.action("setResultTab",{tabId:E})},closeDesigner:function(){e?.extensionRpc.action("closeDesigner",{})},continueEditing:function(){e?.extensionRpc.action("continueEditing",{})},copyPublishErrorToClipboard:function(){e?.extensionRpc.action("copyPublishErrorToClipboard",{})},state:e?.state,themeKind:e?.themeKind,resultPaneResizeInfo:{originalHeight:a,setOriginalHeight:D,isMaximized:s,setIsMaximized:t,currentHeight:r,setCurrentHeight:l},propertiesPaneResizeInfo:{originalWidth:m,setOriginalWidth:u,isMaximized:f,setIsMaximized:o,currentWidth:v,setCurrentWidth:P},elementRefs:g,addElementRef:function(E,K,V){let U=S(E);if(!(V==="PropertiesView"&&g.current[U]))return g.current[U]=K}},children:n})};var Lt=c(M());var ze=c(Gt());var St=c(M());var Pe=c(M());var i=c(C()),$t=k({dialogContent:{height:"300px",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",flexDirection:"column"},openScript:{width:"150px"},updateDatabase:{width:"150px"},errorIcon:{fontSize:"100px",opacity:.5,color:"var(--vscode-errorForeground)"},dialogFooterButtons:{marginTop:"10px"},markdownContainer:{width:"calc(100% - 40px)",height:"calc(100% - 80px)",alignItems:"center",justifyContent:"center",border:"1px solid #e0e0e0",overflow:"auto",padding:"10px 5px 5px 10px",margin:"5px",backgroundColor:"var(--vscode-editor-background)"}}),Rt=()=>{let n=(0,Pe.useContext)(y),e=$t();if(!n)return null;let[r,l]=(0,Pe.useState)(!1),s=n.state,t=()=>{switch(s?.apiState?.generateScriptState){case"Loading":return(0,i.jsx)(J,{size:"extra-small"});case"Error":return(0,i.jsx)(O,{});default:return}},a=()=>(0,i.jsx)(Q,{disableButtonEnhancement:!0,children:(0,i.jsx)(T,{appearance:"secondary",onClick:()=>l(!1),children:p.common.close})}),D=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)($,{className:e.dialogContent,children:(0,i.jsx)(J,{label:p.tableDesigner.publishingChanges,labelPosition:"below"})})}),v=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($,{children:(0,i.jsxs)(gt,{intent:"error",style:{paddingRight:"12px"},children:[(0,i.jsx)(bt,{style:{textAlign:"justify"},children:s?.publishingError??""}),(0,i.jsx)(mt,{children:(0,i.jsx)(T,{onClick:()=>n.copyPublishErrorToClipboard(),icon:(0,i.jsx)(Ue,{}),children:p.tableDesigner.copy})})]})}),(0,i.jsxs)(ae,{children:[(0,i.jsx)(T,{appearance:"primary",onClick:()=>{n.publishChanges()},children:p.tableDesigner.retry}),(0,i.jsx)(T,{onClick:()=>{l(!1),n.generatePreviewReport()},style:{width:"150px"},children:p.tableDesigner.backToPreview}),a()]})]}),P=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($,{className:e.dialogContent,children:(0,i.jsx)("div",{children:p.tableDesigner.changesPublishedSuccessfully})}),(0,i.jsxs)(ae,{children:[(0,i.jsx)(T,{size:"medium",appearance:"primary",onClick:n.closeDesigner,children:p.tableDesigner.closeDesigner}),(0,i.jsx)(Q,{action:"close",children:(0,i.jsx)(T,{size:"medium",appearance:"secondary",onClick:()=>{l(!1),n.continueEditing},children:p.tableDesigner.continueEditing})})]})]}),f=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)($,{className:e.dialogContent,children:(0,i.jsx)(J,{label:p.tableDesigner.loadingPreviewReport,labelPosition:"below"})})}),o=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)($,{className:e.dialogContent,children:[(0,i.jsx)(O,{className:e.errorIcon}),(0,i.jsx)("div",{children:n.state.generatePreviewReportResult?.schemaValidationError??p.tableDesigner.errorLoadingPreview})]}),(0,i.jsxs)(ae,{children:[(0,i.jsx)(Q,{action:"close",children:(0,i.jsx)(T,{className:e.dialogFooterButtons,children:p.common.close})}),(0,i.jsx)(T,{className:e.dialogFooterButtons,onClick:()=>{n.generatePreviewReport()},children:p.tableDesigner.retry})]})]}),m=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)($,{children:[(0,i.jsx)("div",{className:e.markdownContainer,children:(0,i.jsx)(Pt,{children:s?.generatePreviewReportResult?.report})}),(0,i.jsx)(ce,{label:p.tableDesigner.designerPreviewConfirmation,required:!0,checked:r,onChange:(g,d)=>{l(d.checked)},autoFocus:!0,onFocus:g=>{g.target.parentElement&&(g.target.parentElement.style.outlineStyle="solid",g.target.parentElement.style.outlineColor="var(--vscode-focusBorder)")},onBlur:g=>{g.target.parentElement&&(g.target.parentElement.style.outline="none",g.target.parentElement.style.outlineColor="")}})]}),(0,i.jsxs)(ae,{children:[a(),(0,i.jsx)(Q,{action:"close",children:(0,i.jsx)(T,{icon:t(),iconPosition:"after",className:e.openScript,disabled:s.apiState?.previewState!=="Loaded",appearance:"secondary",onClick:n.generateScript,children:p.tableDesigner.generateScript})}),(0,i.jsx)(T,{className:e.updateDatabase,disabled:!r,title:r?p.tableDesigner.updateDatabase:p.tableDesigner.youMustReviewAndAccept,appearance:"primary",onClick:()=>{n.publishChanges()},children:p.tableDesigner.updateDatabase})]})]}),u=()=>{if(s?.apiState?.publishState==="Loading")return D();if(s?.apiState?.publishState==="Loaded")return P();if(s?.apiState?.publishState==="Error")return v();if(s?.apiState?.previewState==="Loading")return f();if(s?.apiState?.previewState==="Error")return o();if(s?.apiState?.previewState==="Loaded")return m()};return(0,i.jsxs)(tt,{inertTrapFocus:!0,children:[(0,i.jsx)(Q,{disableButtonEnhancement:!0,children:(0,i.jsx)(ot,{"aria-label":p.tableDesigner.publish,title:p.tableDesigner.publish,icon:(0,i.jsx)(_e,{}),onClick:()=>{n.generatePreviewReport()},disabled:(s?.issues?.length??0)>0,children:p.tableDesigner.publish})}),(0,i.jsx)(it,{children:(0,i.jsxs)(rt,{children:[(0,i.jsx)(nt,{children:p.tableDesigner.previewDatabaseUpdates}),u()]})})]})};var Z=c(C()),jt=k({separator:{...I.margin("0px","-20px","0px","0px"),...I.padding("0px"),fontSize:"5px"}}),zt=()=>{let n=(0,St.useContext)(y),e=jt();if(n)return(0,Z.jsxs)("div",{children:[(0,Z.jsx)(fe,{size:"small",children:(0,Z.jsx)(Rt,{})}),(0,Z.jsx)(ue,{className:e.separator})]})};var q=c(M());var kt=c(M());var ee=c(M());var ve=c(C()),te=({component:n,model:e,componentPath:r,UiArea:l,showLabel:s=!0})=>{let[t,a]=(0,ee.useState)(e.checked),D=(0,ee.useContext)(y);if(D)return(0,ee.useEffect)(()=>{a(e.checked)},[e]),(0,ve.jsx)(F,{size:"small",label:s?(0,ve.jsx)(Ze,{size:"small",style:{lineHeight:"22px"},children:n.componentProperties.title}):void 0,orientation:"horizontal",style:{width:n.componentProperties.width??l==="PropertiesView"?"100%":"400px"},children:(0,ve.jsx)(ce,{ref:v=>D.addElementRef(r,v,l),checked:t,onChange:async(v,P)=>{e.enabled!==!1&&await D.processTableEdit({path:r,value:P.checked,type:2,source:l})},style:{fontSize:"12px"},size:"medium",disabled:e.enabled===void 0?!1:!e.enabled})})};var ne=c(M());var re=c(C()),j=({component:n,model:e,componentPath:r,UiArea:l,multiline:s=!1,showLabel:t=!0,showError:a=!0,horizontal:D=!1})=>{let[v,P]=(0,ne.useState)(e.value),f=(0,ne.useContext)(y);if(!f)return;let o=ke(f.getComponentId(r)??""),m=l==="PropertiesView"?"100%":n.componentProperties.width??"400px";return(0,ne.useEffect)(()=>{P(e.value)},[e]),(0,re.jsx)(F,{label:{children:t?(0,re.jsx)(De,{size:"small",info:n.description,children:t?n.componentProperties.title:void 0}):void 0},validationState:f.getErrorMessage(r)?"error":void 0,validationMessage:a?f.getErrorMessage(r):void 0,validationMessageIcon:a&&f.getErrorMessage(r)?(0,re.jsx)(O,{}):void 0,style:{width:m},size:"small",orientation:D?"horizontal":"vertical",children:s?(0,re.jsx)(et,{"aria-labelledby":o,ref:u=>f.addElementRef(r,u,l),value:v??"",onChange:(u,g)=>{P(g.value??"")},onBlur:async()=>{v!==e.value&&await f?.processTableEdit({path:r,value:v,type:2,source:l})},disabled:e.enabled===void 0?!1:!e.enabled,size:"small"}):(0,re.jsx)(ge,{"aria-labelledby":o,ref:u=>f.addElementRef(r,u,l),value:v??"",onChange:(u,g)=>{P(g.value??"")},onBlur:async()=>{v!==e.value&&await f.processTableEdit({path:r,value:v,type:2,source:l})},disabled:e.enabled===void 0?!1:!e.enabled,type:e.inputType,size:"small"})})};var ie=c(M());var Ce=c(C()),oe=({component:n,model:e,componentPath:r,UiArea:l,showLabel:s=!0,showError:t=!0,horizontal:a=!1})=>{let[D,v]=(0,ie.useState)([]),P=(0,ie.useContext)(y);if(!P)return;let f=l==="PropertiesView"?"100%":n.componentProperties.width??"350px";return(0,ie.useEffect)(()=>{v([e.value])},[e]),(0,Ce.jsx)(F,{label:{children:s?(0,Ce.jsx)(De,{size:"small",info:n.description,children:s?n.componentProperties.title:void 0}):void 0},validationState:t&&P.getErrorMessage(r)?"error":void 0,validationMessage:t?P.getErrorMessage(r):"",style:{width:f},size:"small",orientation:a?"horizontal":"vertical",children:(0,Ce.jsx)(xe,{style:{width:f,minWidth:f,maxWidth:f,border:P.getErrorMessage(r)?"1px solid var(--vscode-errorForeground)":void 0},options:e.values.sort((o,m)=>o.localeCompare(m)).map(o=>({text:o,value:o})),onSelect:o=>{e.enabled!==!1&&P.processTableEdit({path:r,value:o.value.toString(),type:2,source:l})},size:"small",selectedOption:{value:D[0]}})})};var G=c(M());var h=c(C()),Bt=c(M()),qt=k({tableCell:{display:"flex",flexDirection:"row"},tableActionIcon:{height:"14px",width:"14px"}}),Te=({component:n,model:e,componentPath:r,UiArea:l,loadPropertiesTabData:s=!0})=>{let t=n.componentProperties,a=(0,G.useContext)(y);if(!a)return;let D=qt(),v=W("Move Up"),P=W("Move Down"),f=t.columns.map(b=>{let x=t.itemProperties?.find(B=>B.propertyName===b);return he({columnId:b,renderHeaderCell:()=>(0,h.jsx)(h.Fragment,{children:x?.componentProperties.title??b})})});t.canMoveRows&&f.unshift(he({columnId:"dragHandle",renderHeaderCell:()=>(0,h.jsx)(h.Fragment,{})})),t.canRemoveRows&&f.push(he({columnId:"remove",renderHeaderCell:()=>{let b=W("Delete");return(0,h.jsx)(h.Fragment,{children:b})}}));let o=e.data?.map(b=>b)??[],[m]=(0,G.useState)(f),u=()=>{let b={};return t.columns.forEach(x=>{let B=t.itemProperties?.find(L=>L.propertyName===x);B&&(b[x]={minWidth:B?.componentProperties.width??70,idealWidth:B?.componentProperties.width??70,defaultWidth:B?.componentProperties.width??70})}),t.canMoveRows&&(b.dragHandle={minWidth:15,idealWidth:15,defaultWidth:15}),t.canRemoveRows&&(b.remove={minWidth:35,idealWidth:35,defaultWidth:35}),b},[g]=(0,G.useState)(u()),{getRows:d,columnSizing_unstable:S,tableRef:E}=at({columns:m,items:o},[st({columnSizingOptions:g,autoFitColumns:!1,containerWidthOffset:20})]),K=d(),V=(b,x)=>{a.processTableEdit({type:3,path:[...r,b],value:x,source:l});let B=a?.getComponentId([...r,x,m[1].columnId]);a.elementRefs.current[B]?.focus()},U=b=>a?.state.issues?.find(B=>B.propertyPath?B.propertyPath.join(".")===[...r,b].join("."):!1)?.description??void 0,Ft=(b,x,B)=>{let L=t.itemProperties?.find(pe=>pe.propertyName===x),_=b.item[x];switch(x){case"dragHandle":return(0,h.jsx)("div",{className:D.tableCell,children:t.canMoveRows&&(0,h.jsx)(T,{appearance:"subtle",size:"small",icon:(0,h.jsx)(Xe,{}),draggable:!0,onDragEnter:()=>{Re(B)},onDragEnd:()=>{Y===-1||le===-1||(V(Y,le),Ie(-1),Re(-1))},onDrag:()=>{Ie(B)},onDragStart:()=>{Re(-1),Ie(B)}})});case"remove":return(0,h.jsx)(T,{disabled:b.item.canBeDeleted?!b.item.canBeDeleted:!1,appearance:"subtle",size:"small",icon:(0,h.jsx)(Ge,{}),onClick:async()=>{a.processTableEdit({path:[...r,b.rowId],source:l,type:1,value:void 0})},title:p.tableDesigner.remove(t.objectTypeDisplayName)});default:switch(L?.componentType){case"input":return(0,h.jsx)(j,{component:L,model:_,componentPath:[...r,b.rowId,x],UiArea:l,showLabel:!1,showError:!1});case"dropdown":return(0,h.jsx)("div",{className:D.tableCell,children:(0,h.jsx)(oe,{component:L,model:_,componentPath:[...r,b.rowId,x],UiArea:"TabsView",showLabel:!1,showError:!1})});case"checkbox":return(0,h.jsx)("div",{className:D.tableCell,children:(0,h.jsx)(te,{component:L,model:_,componentPath:[...r,b.rowId,x],UiArea:l,showLabel:!1})});default:return"Unknown component type"}}},[Y,Ie]=(0,G.useState)(-1),[le,Re]=(0,G.useState)(-1),[H,Ut]=(0,G.useState)(void 0);return(0,h.jsxs)("div",{children:[(0,h.jsxs)(fe,{size:"small",children:[t.canAddRows&&(0,h.jsx)(T,{appearance:"transparent",icon:(0,h.jsx)(Me,{className:D.tableActionIcon}),onClick:()=>{a.processTableEdit({path:[...r,K.length],source:l,type:0,value:void 0})},size:"small",children:t.labelForAddNewButton}),t.canMoveRows&&(0,h.jsx)(T,{icon:(0,h.jsx)(Ve,{className:D.tableActionIcon}),onClick:b=>{b.target.focus(),V(H,H-1)},disabled:H===void 0||H===0,size:"small",appearance:"transparent",children:v}),t.canMoveRows&&(0,h.jsx)(T,{icon:(0,h.jsx)(Ae,{className:D.tableActionIcon}),onClick:b=>{b.target.focus(),V(H,H+1)},disabled:H===void 0||H===K.length-1,size:"small",appearance:"transparent",children:P})]}),(0,h.jsx)("div",{style:{maxWidth:"calc(100% - 20px)",width:"fit-content",overflowX:"auto",paddingBottom:"5px",paddingRight:"5px",paddingLeft:"5px"},children:(0,h.jsxs)(dt,{as:"table",size:"extra-small",...S.getTableProps(),ref:E,style:{marginRight:"5px",width:Object.keys(g).reduce((b,x)=>b+g[x].idealWidth+22,0)-20},children:[(0,h.jsx)(ct,{style:{marginBottom:"5px",backgroundColor:"var(--vscode-keybindingTable-headerBackground)"},children:(0,h.jsx)(Se,{children:f.map(b=>(0,Bt.createElement)(ut,{...S.getTableHeaderCellProps(b.columnId),key:b.columnId},b.renderHeaderCell()))})}),(0,h.jsx)(pt,{children:K.map((b,x)=>{let B=U(x),L=H===x?"var(--vscode-list-hoverBackground)":"var(--vscode-editor-background)",_=B?"1px solid var(--vscode-errorForeground)":"",pe="3px solid var(--vscode-focusBorder)";return(0,h.jsx)(Se,{style:{backgroundColor:L,width:"calc(100% - 10px)",borderTop:le===x&&Y!==x&&Y>x?pe:_,borderBottom:le===x&&Y!==x&&Y<x?pe:_,borderLeft:_,borderRight:_,marginTop:B?"5px":""},onFocus:de=>{!s||t.showItemDetailInPropertiesView===!1||(a?.setPropertiesComponents({componentPath:[...r,b.rowId],component:n,model:e}),Ut(x),de.preventDefault())},children:f.map((de,Be)=>(0,h.jsx)(lt,{...S.getTableCellProps(de.columnId),id:`table-cell-${a?.state.tableInfo?.id}-${r.join("-")}_${x}-${Be}`,style:{height:"30px",paddingBottom:"5px"},children:Ft(b,de.columnId,x)},r.join(".")+x+Be))},r.join(".")+x)})})]})})]})};var X=c(C()),Yt=k({root:{width:"100%",height:"100%",overflowX:"auto",display:"flex",flexDirection:"column",paddingTop:"10px",paddingLeft:"10px",...I.gap("10px")}}),Nt=({tabId:n})=>{let e=Yt(),l=(0,kt.useContext)(y)?.state;if(!l)return null;let s=l.view?.tabs.find(t=>t.id===n)?.components;return(0,X.jsx)("div",{className:e.root,children:s?.filter(t=>t.componentProperties.enabled===void 0||t.componentProperties.enabled).map(t=>{switch(t.componentType){case"input":{let a=l.model[t.propertyName];return(0,X.jsx)(j,{component:t,model:a,componentPath:[t.propertyName],UiArea:"TabsView"},t.propertyName)}case"textarea":{let a=l.model[t.propertyName];return(0,X.jsx)(j,{component:t,model:a,componentPath:[t.propertyName],UiArea:"TabsView",multiline:!0,autoAdjustHeight:!0},t.propertyName)}case"dropdown":{let a=l.model[t.propertyName];return(0,X.jsx)(oe,{component:t,model:a,componentPath:[t.propertyName],UiArea:"TabsView"},t.propertyName)}case"checkbox":{let a=l.model[t.propertyName];return(0,X.jsx)(te,{component:t,model:a,componentPath:[t.propertyName],UiArea:"TabsView"},t.propertyName)}case"table":{let a=l.model[t.propertyName];return(0,X.jsx)(Te,{component:t,model:a,componentPath:[t.propertyName],UiArea:"TabsView"},t.propertyName)}default:return null}})})};var N=c(C()),Jt=k({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},title:{...I.margin("10px","5px","5px","5px"),gap:"10px",width:"400px",maxWidth:"100%",padding:"10px","> *":{marginBottom:"10px"}},separator:{...I.margin("0px","-20px","0px","0px"),...I.padding("0px"),fontSize:"5px"},form:{height:"100%",maxWidth:"100%",overflow:"hidden"},tabButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center","> *":{marginRight:"5px"}}}),Et=()=>{let n=Jt(),e=(0,q.useContext)(y),r=e?.state;if(!r)return null;let[l,s]=(0,q.useState)(r.model.name.value),[t,a]=(0,q.useState)(r.model.schema.value);(0,q.useEffect)(()=>{s(r.model.name.value),a(r.model.schema.value)},[r.model]);let D=o=>{let m=r.view?.tabs.find(g=>g.id===o)?.components;if(!m||r.issues?.length===0)return 0;let u=0;for(let g=0;g<r?.issues.length;g++){let d=r.issues[g];d.propertyPath&&d.propertyPath.length>0&&m.find(S=>S.propertyName===d.propertyPath[0])&&u++}return u};function v(o){let m=D(o);if(m===1)return W({message:"{0} issue",args:[m],comment:["{0} is the number of issues"]});if(m>1||m===0)return W({message:"{0} issues",args:[m],comment:["{0} is the number of issues"]})}function P(o){let m=D(o);return m===0?o:m===1?W({message:"{0} {1} issue",args:[o,m],comment:["{0} is the tab name","{1} is the number of issues"]}):W({message:"{0} {1} issues",args:[o,m],comment:["{0} is the tab name","{1} is the number of issues"]})}function f(){let o=(r?.model?.schema).values,m=new Set(["db_accessadmin","db_backupoperator","db_datareader","db_datawriter","db_ddladmin","db_denydatareader","db_denydatawriter","db_owner","db_securityadmin"]),u=[],g=[];for(let d of o)m.has(d)?g.push(d):u.push(d);return u.sort((d,S)=>d.localeCompare(S)),g.sort((d,S)=>d.localeCompare(S)),[...u,...g]}return(0,N.jsxs)("div",{className:n.root,children:[(0,N.jsxs)("div",{className:n.title,children:[(0,N.jsx)(F,{label:p.tableDesigner.tableName,orientation:"horizontal",children:(0,N.jsx)(ge,{size:"medium",value:l,onChange:(o,m)=>{s(m.value)},autoFocus:!0,onBlur:o=>{e.processTableEdit({source:"TabsView",type:2,path:["name"],value:l})}})}),(0,N.jsx)(F,{label:p.tableDesigner.schema,orientation:"horizontal",children:(0,N.jsx)(xe,{size:"medium",options:f().map(o=>({value:o})),onSelect:o=>{e.processTableEdit({source:"TabsView",type:2,path:["schema"],value:o.value})},selectedOption:{value:t}})})]}),(0,N.jsx)(me,{size:"small",selectedValue:r.tabStates?.mainPaneTab,onTabSelect:(o,m)=>{e.setTab(m.value),e.setPropertiesComponents(void 0)},children:r.view?.tabs.map(o=>{let m=P(o.id);return(0,N.jsx)(se,{title:m,value:o.id,children:(0,N.jsxs)("div",{className:n.tabButtonContainer,children:[(0,N.jsx)(be,{children:o.title}),D(o.id)>0&&(0,N.jsx)(Qe,{color:"important",size:"small",title:v(o.id),count:D(o.id)})]})},o.id)})}),(0,N.jsx)("div",{className:n.form,children:r.view?.tabs.map(o=>(0,N.jsx)("div",{style:{display:r.tabStates?.mainPaneTab===o.id?"":"none",width:"100%",height:"100%"},children:(0,N.jsx)(Nt,{tabId:o.id})},o.id))})]})};var Mt=c(M());var z=c(C()),Qt=k({root:{display:"flex",flexDirection:"column",height:"100%",overflowX:"hidden",...I.overflow("hidden")},title:{display:"flex",height:"30px",paddingTop:"10px",paddingBottom:"10px","> *":{marginRight:"10px"},lineHeight:"30px"},stack:{marginBottom:"10px",flexDirection:"column","> *":{marginBottom:"10px"},overflowY:"auto",backgroundColor:"var(--vscode-editor-background)"},group:{overflowX:"auto",overflowY:"hidden","> *":{marginBottom:"10px"}}}),At=()=>{let n=Qt(),e=(0,Mt.useContext)(y);if(!e)return null;let r=e.state.propertiesPaneData,l=r.componentPath,s=l[0],t=l[l.length-1],a=e.state.propertiesPaneData?.component.componentProperties,v=e.state.model[s].data[t],P=Array.from(new Set(a.itemProperties?.filter(u=>u.group).map(u=>u.group)));if(P?.unshift("General"),!v)return;let f=(u,g)=>{if(u)return(0,z.jsxs)(Ee,{value:u,style:{border:"0.5px solid var(--vscode-editorWidget-border)",borderRadius:"2px",margin:"10px"},children:[(0,z.jsx)(Ye,{children:u}),(0,z.jsx)(Je,{children:(0,z.jsx)("div",{className:n.group,children:g.map(d=>{if(!v)return;let S=v[d.propertyName];switch(d.componentType){case"checkbox":return(0,z.jsx)(te,{UiArea:"PropertiesView",component:d,model:S,componentPath:[...r.componentPath,d.propertyName]},`${u}-${d.propertyName}`);case"input":return(0,z.jsx)(j,{UiArea:"PropertiesView",component:d,model:S,componentPath:[...r.componentPath,d.propertyName],horizontal:!0},`${u}-${d.propertyName}`);case"dropdown":return(0,z.jsx)(oe,{UiArea:"PropertiesView",component:d,model:S,componentPath:[...r.componentPath,d.propertyName],horizontal:!0},`${u}-${d.propertyName}`);case"table":return(0,z.jsx)(Te,{UiArea:"PropertiesView",component:d,model:S,componentPath:[...r.componentPath,d.propertyName],loadPropertiesTabData:!1},`${u}-${d.propertyName}`)}})})})]},u)},o=()=>P?.sort((u,g)=>!u||!g?0:a.expandedGroups?.includes(u)&&!a.expandedGroups?.includes(g)?-1:a.expandedGroups?.includes(g)&&!a.expandedGroups?.includes(u)?1:0).map(u=>{let g=a.itemProperties.filter(d=>u==="General"&&!d.group||u===d.group).filter(d=>{if(d.showInPropertiesView===!1)return!1;let S=v[d.propertyName];return!(!S||S?.enabled===!1)});if(g.length!==0)return f(u,g)}),m=()=>a.expandedGroups?a.expandedGroups:o().length>0?[P[0]]:[];return(0,z.jsxs)("div",{className:n.root,children:[(0,z.jsxs)("div",{className:n.title,children:[(0,z.jsx)(T,{appearance:"transparent",onClick:()=>{e.propertiesPaneResizeInfo.isMaximized&&e.propertiesPaneResizeInfo.setCurrentWidth(e.propertiesPaneResizeInfo.originalWidth),e.propertiesPaneResizeInfo.setIsMaximized(!e.propertiesPaneResizeInfo.isMaximized)},title:e.propertiesPaneResizeInfo.isMaximized?p.tableDesigner.restorePanelSize:p.tableDesigner.maximizePanelSize,icon:e.propertiesPaneResizeInfo.isMaximized?(0,z.jsx)(We,{}):(0,z.jsx)(Le,{}),style:{marginRight:"0px"}}),(0,z.jsx)(be,{size:500,weight:"semibold",style:{flex:1,lineHeight:"28px"},children:p.tableDesigner.propertiesPaneTitle(a.objectTypeDisplayName??"")}),(0,z.jsx)(T,{appearance:"transparent",onClick:()=>{e.setPropertiesComponents(void 0)},title:e.propertiesPaneResizeInfo.isMaximized?p.tableDesigner.restorePanelSize:p.tableDesigner.maximizePanelSize,icon:(0,z.jsx)(Ke,{})})]}),(0,z.jsx)("div",{className:n.stack,children:(0,z.jsx)(Ne,{multiple:!0,collapsible:!0,defaultOpenItems:m(),children:v&&o()})})]})};var Vt=c(M()),w=c(C()),Zt=k({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},ribbon:{width:"100%",display:"flex",flexDirection:"row","> *":{marginRight:"10px"},padding:"5px 0px"},designerResultPaneTabs:{flex:1},tabContent:{...I.flex(1),width:"100%",height:"100%",display:"flex",...I.overflow("auto")},designerResultPaneScript:{width:"100%",height:"100%",position:"relative"},designerResultPaneScriptOpenButton:{position:"absolute",top:"0px",right:"0px"},issuesContainer:{width:"100%",height:"calc( 100% - 10px )",flexDirection:"column","> *":{marginBottom:"10px"},backgroundColor:"var(--vscode-editor-background)",padding:"5px",overflow:"hidden auto"},issuesRows:{display:"flex",lineHeight:"20px",padding:"5px","> *":{marginRight:"10px"},":hover":{backgroundColor:"var(--vscode-editor-selectionHighlightBackground)"},width:"100%"}}),Ht=()=>{let n=Zt(),e=(0,Vt.useContext)(y),r=e?.state;if(!r)return;let l=async s=>{let t=s.propertyPath??[];if(e?.log(`focusing on ${t}`),!r?.view?.tabs)return;let a=r.view.tabs.find(f=>f.components.find(o=>o.propertyName===t[0]));if(a)e.setTab(a.id),await new Promise(f=>setTimeout(f,100));else return;let D,v;if(t.length>1){if(D=a.components.find(f=>f.propertyName===t[0]),!D||(v=r.model[D.propertyName],!v))return;e.setPropertiesComponents({componentPath:[t[0],t[1]],component:D,model:v})}let P;switch(t.length){case 1:case 3:case 5:P=e.elementRefs.current[e.getComponentId(t)];break;case 2:if(!D)return;let f=D.componentProperties.itemProperties[0].propertyName;P=e.elementRefs.current[e.getComponentId([...t,f])];break;case 4:if(!D)return;let o=t[2],m=D.componentProperties.itemProperties.find(g=>g.propertyName===o);if(!m)return;let u=m.componentProperties.itemProperties[0].propertyName;P=e.elementRefs.current[e.getComponentId([...t,u])];break;default:break}P&&(P.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),P.focus())};return(0,w.jsxs)("div",{className:n.root,children:[(0,w.jsxs)("div",{className:n.ribbon,children:[(0,w.jsxs)(me,{size:"small",selectedValue:r.tabStates.resultPaneTab,onTabSelect:(s,t)=>{e.setResultTab(t.value)},className:n.designerResultPaneTabs,children:[(0,w.jsx)(se,{value:"script",children:p.tableDesigner.scriptAsCreate},"script"),r.issues?.length!==0&&(0,w.jsx)(se,{value:"issues",children:p.tableDesigner.issuesTabHeader(r.issues?.length)},"issues")]}),r.tabStates.resultPaneTab==="script"&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(T,{size:"small",appearance:"outline",onClick:()=>e.scriptAsCreate(),title:p.tableDesigner.openInEditor,icon:(0,w.jsx)(je,{}),children:p.tableDesigner.openInEditor}),(0,w.jsx)(T,{size:"small",appearance:"outline",onClick:()=>e.copyScriptAsCreateToClipboard(),title:p.tableDesigner.copyScript,icon:(0,w.jsx)(Fe,{}),children:p.tableDesigner.copyScript})]}),(0,w.jsx)(T,{size:"small",appearance:"transparent",onClick:()=>{e.resultPaneResizeInfo.isMaximized&&e.resultPaneResizeInfo.setCurrentHeight(e.resultPaneResizeInfo.originalHeight),e.resultPaneResizeInfo.setIsMaximized(!e.resultPaneResizeInfo.isMaximized)},title:e.resultPaneResizeInfo.isMaximized?p.tableDesigner.restorePanelSize:p.tableDesigner.maximizePanelSize,icon:e.resultPaneResizeInfo.isMaximized?(0,w.jsx)(He,{}):(0,w.jsx)(Oe,{})})]}),(0,w.jsxs)("div",{className:n.tabContent,children:[r.tabStates.resultPaneTab==="script"&&(0,w.jsx)("div",{className:n.designerResultPaneScript,children:(0,w.jsx)(Ct,{height:"100%",width:"100%",language:"sql",theme:Dt(e?.themeKind),value:(r?.model.script).value??"",options:{readOnly:!0}})}),r.tabStates.resultPaneTab==="issues"&&r.issues?.length!==0&&(0,w.jsx)("div",{className:n.issuesContainer,children:(0,w.jsx)(vt,{navigationMode:"items",children:r.issues.map((s,t)=>(0,w.jsx)(wt,{onAction:async()=>l(s),children:(0,w.jsxs)("div",{className:n.issuesRows,children:[s.severity==="error"&&(0,w.jsx)(O,{fontSize:20,color:"var(--vscode-errorForeground)"}),s.severity==="warning"&&(0,w.jsx)(qe,{fontSize:20,color:"yellow"}),s.severity==="information"&&(0,w.jsx)($e,{fontSize:20,color:"blue"}),s.description]})},`issue-${t}`))})})]})]})};var R=c(C()),er=k({root:{display:"flex",flexDirection:"column",height:"100%",width:"100%",maxWidth:"100%",maxHeight:"100%"},pageContext:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",flexDirection:"column"},errorIcon:{fontSize:"100px",opacity:.5},retryButton:{marginTop:"10px"},resultPaneHandle:{position:"absolute",top:"0",right:"0",width:"100%",height:"10px",cursor:"ns-resize",zIndex:1,boxShadow:"0px -1px 1px  var(--vscode-editorWidget-border)"},propertiesPaneHandle:{position:"absolute",top:"0",left:"0",width:"10px",height:"100%",cursor:"ew-resize",zIndex:1,boxShadow:"-1px 0px 1px  var(--vscode-editorWidget-border)"},designerRibbon:{width:"100%"},mainContent:{height:"100%",width:"100%",minHeight:"100%",display:"flex",...I.flex(1),flexDirection:"column",...I.overflow("hidden")},editor:{...I.overflow("hidden"),...I.flex(1),width:"100%",display:"flex",flexDirection:"row"},resultPaneContainer:{width:"100%",position:"relative"},mainPaneContainer:{...I.flex(1),height:"100%",...I.overflow("hidden")},propertiesPaneContainer:{position:"relative",height:"100%",width:"300px",...I.overflow("hidden")}}),Wt=()=>{let n=er(),e=(0,Lt.useContext)(y),r=e?.state;return r?(0,R.jsxs)("div",{className:n.root,children:[r.apiState?.initializeState==="Loading"&&(0,R.jsx)("div",{className:n.pageContext,children:(0,R.jsx)(J,{label:p.tableDesigner.loadingTableDesigner,labelPosition:"below"})}),r.apiState?.initializeState==="Error"&&(0,R.jsxs)("div",{className:n.pageContext,children:[(0,R.jsx)(O,{className:n.errorIcon}),(0,R.jsx)("div",{children:p.tableDesigner.errorLoadingDesigner}),(0,R.jsx)(T,{className:n.retryButton,children:p.tableDesigner.retry})]}),r.apiState?.initializeState==="Loaded"&&(0,R.jsxs)("div",{className:n.mainContent,children:[(0,R.jsx)(zt,{}),(0,R.jsxs)("div",{className:n.editor,children:[(0,R.jsx)("div",{className:n.mainPaneContainer,children:(0,R.jsx)(Et,{})}),(0,R.jsx)(ue,{style:{width:"5px",height:"100%",flex:0},vertical:!0}),e.state.propertiesPaneData&&(0,R.jsx)(ze.ResizableBox,{width:e.propertiesPaneResizeInfo.isMaximized?9999999:e.propertiesPaneResizeInfo.currentWidth,onResizeStart:(l,s)=>{e.propertiesPaneResizeInfo.setIsMaximized(!1)},onResizeStop:(l,s)=>{let t=s.node.parentElement.parentElement.offsetWidth;s.size.width>=t-50?(e.propertiesPaneResizeInfo.setIsMaximized(!0),e.propertiesPaneResizeInfo.setCurrentWidth(t)):(e.propertiesPaneResizeInfo.setCurrentWidth(s.size.width),e.propertiesPaneResizeInfo.setOriginalWidth(s.size.width))},height:1/0,maxConstraints:[1/0,1/0],minConstraints:[10,1/0],resizeHandles:["w"],handle:(0,R.jsx)("div",{className:n.propertiesPaneHandle}),className:n.propertiesPaneContainer,children:(0,R.jsx)(At,{})})]}),(0,R.jsx)(ze.ResizableBox,{width:1/0,height:e.resultPaneResizeInfo.isMaximized?9999999:e.resultPaneResizeInfo.currentHeight,maxConstraints:[1/0,1/0],minConstraints:[1/0,10],resizeHandles:["n"],handle:(0,R.jsx)("div",{className:n.resultPaneHandle}),className:n.resultPaneContainer,onResizeStart:(l,s)=>{e.resultPaneResizeInfo.setIsMaximized(!1)},onResizeStop:(l,s)=>{let t=s.node.parentElement.parentElement.offsetHeight;s.size.height>=t-50?(e.resultPaneResizeInfo.setIsMaximized(!0),e.resultPaneResizeInfo.setCurrentHeight(t)):(e.resultPaneResizeInfo.setCurrentHeight(s.size.height),e.resultPaneResizeInfo.setOriginalHeight(s.size.height))},children:(0,R.jsx)(Ht,{})})]})]}):null};var ye=c(C());Ot.default.createRoot(document.getElementById("root")).render((0,ye.jsx)(ft,{children:(0,ye.jsx)(Tt,{children:(0,ye.jsx)(Wt,{})})}));
