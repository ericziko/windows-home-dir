import{a as Za}from"./chunk-AZ7WHKR6.js";import{a as ja,b as Qa,d as Ja}from"./chunk-EQBJOA2X.js";import{a as cn}from"./chunk-NKLRSU2X.js";import{$a as Ca,Aa as ma,Bb as Cr,Cb as ka,Cc as Ar,Da as ga,Db as Da,Dc as Ka,Ea as ya,Eb as Ee,Ec as qa,Fa as ba,Gb as Ia,Gc as Fr,Hb as Ma,Hc as Lr,I as nn,Ib as Nr,Ic as zr,Jb as Oa,Kb as Ra,Kc as Br,Lb as Pa,Lc as O,M as ta,Mb as Aa,Mc as Ua,N as na,Na as xa,Nb as Fa,Nc as Ya,Ob as Tr,Oc as Ga,Pa as wa,Pb as ke,Qa as va,Qb as fi,Sb as kr,Sc as Xa,Ta as Sa,Tb as Dr,Ub as nt,Va as vr,Vb as Ir,W as ra,Wa as Ea,Wb as an,Xa as _a,Xb as Mr,Y as Rt,Yb as Or,Z as oa,Zb as Rr,_b as Pr,a as Z,aa as ia,c as V,ca as sa,cb as li,d as de,da as aa,db as ci,eb as di,f as xg,fb as ui,g as wg,ga as la,hb as se,ib as Na,ja as ca,jb as _t,k as ze,ka as da,kb as Ge,la as ua,lb as Rn,mb as Sr,na as fa,ob as Er,p as ea,pb as Ta,qb as Pt,qc as La,r as te,rc as za,sc as Ba,tb as rn,tc as $a,ub as At,uc as Ha,va as ha,vc as Va,wb as _r,wc as Wa,x as wr,xb as on,ya as pa,yb as sn,yc as ln}from"./chunk-BAOGVYAT.js";var Nd=Z(Cd=>{"use strict";var Sn=de();function dx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ux=typeof Object.is=="function"?Object.is:dx,fx=Sn.useState,hx=Sn.useEffect,px=Sn.useLayoutEffect,mx=Sn.useDebugValue;function gx(e,t){var n=t(),r=fx({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return px(function(){o.value=n,o.getSnapshot=t,ts(o)&&i({inst:o})},[e,n,t]),hx(function(){return ts(o)&&i({inst:o}),e(function(){ts(o)&&i({inst:o})})},[e]),mx(n),n}function ts(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ux(e,n)}catch{return!0}}function yx(e,t){return t()}var bx=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?yx:gx;Cd.useSyncExternalStore=Sn.useSyncExternalStore!==void 0?Sn.useSyncExternalStore:bx});var kd=Z((bD,Td)=>{"use strict";Td.exports=Nd()});var Id=Z(Dd=>{"use strict";var Ro=de(),xx=kd();function wx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vx=typeof Object.is=="function"?Object.is:wx,Sx=xx.useSyncExternalStore,Ex=Ro.useRef,_x=Ro.useEffect,Cx=Ro.useMemo,Nx=Ro.useDebugValue;Dd.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=Ex(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=Cx(function(){function l(h){if(!c){if(c=!0,d=h,h=r(h),o!==void 0&&s.hasValue){var p=s.value;if(o(p,h))return u=p}return u=h}if(p=u,vx(d,h))return p;var g=r(h);return o!==void 0&&o(p,g)?(d=h,p):(d=h,u=g)}var c=!1,d,u,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,r,o]);var a=Sx(e,i[0],i[1]);return _x(function(){s.hasValue=!0,s.value=a},[a]),Nx(a),a}});var Od=Z((wD,Md)=>{"use strict";Md.exports=Id()});var Ho=Z((WD,ju)=>{"use strict";var Fw="\0",jt="\0",Gu="",cs=class{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(t){t&&(this._isDirected=Object.hasOwn(t,"directed")?t.directed:!0,this._isMultigraph=Object.hasOwn(t,"multigraph")?t.multigraph:!1,this._isCompound=Object.hasOwn(t,"compound")?t.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[jt]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(t){return this._label=t,this}graph(){return this._label}setDefaultNodeLabel(t){return this._defaultNodeLabelFn=t,typeof t!="function"&&(this._defaultNodeLabelFn=()=>t),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var t=this;return this.nodes().filter(n=>Object.keys(t._in[n]).length===0)}sinks(){var t=this;return this.nodes().filter(n=>Object.keys(t._out[n]).length===0)}setNodes(t,n){var r=arguments,o=this;return t.forEach(function(i){r.length>1?o.setNode(i,n):o.setNode(i)}),this}setNode(t,n){return Object.hasOwn(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=n),this):(this._nodes[t]=arguments.length>1?n:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=jt,this._children[t]={},this._children[jt][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)}node(t){return this._nodes[t]}hasNode(t){return Object.hasOwn(this._nodes,t)}removeNode(t){var n=this;if(Object.hasOwn(this._nodes,t)){var r=o=>n.removeEdge(n._edgeObjs[o]);delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],this.children(t).forEach(function(o){n.setParent(o)}),delete this._children[t]),Object.keys(this._in[t]).forEach(r),delete this._in[t],delete this._preds[t],Object.keys(this._out[t]).forEach(r),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this}setParent(t,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n===void 0)n=jt;else{n+="";for(var r=n;r!==void 0;r=this.parent(r))if(r===t)throw new Error("Setting "+n+" as parent of "+t+" would create a cycle");this.setNode(n)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=n,this._children[n][t]=!0,this}_removeFromParentsChildList(t){delete this._children[this._parent[t]][t]}parent(t){if(this._isCompound){var n=this._parent[t];if(n!==jt)return n}}children(t=jt){if(this._isCompound){var n=this._children[t];if(n)return Object.keys(n)}else{if(t===jt)return this.nodes();if(this.hasNode(t))return[]}}predecessors(t){var n=this._preds[t];if(n)return Object.keys(n)}successors(t){var n=this._sucs[t];if(n)return Object.keys(n)}neighbors(t){var n=this.predecessors(t);if(n){let o=new Set(n);for(var r of this.successors(t))o.add(r);return Array.from(o.values())}}isLeaf(t){var n;return this.isDirected()?n=this.successors(t):n=this.neighbors(t),n.length===0}filterNodes(t){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;Object.entries(this._nodes).forEach(function([s,a]){t(s)&&n.setNode(s,a)}),Object.values(this._edgeObjs).forEach(function(s){n.hasNode(s.v)&&n.hasNode(s.w)&&n.setEdge(s,r.edge(s))});var o={};function i(s){var a=r.parent(s);return a===void 0||n.hasNode(a)?(o[s]=a,a):a in o?o[a]:i(a)}return this._isCompound&&n.nodes().forEach(s=>n.setParent(s,i(s))),n}setDefaultEdgeLabel(t){return this._defaultEdgeLabelFn=t,typeof t!="function"&&(this._defaultEdgeLabelFn=()=>t),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(t,n){var r=this,o=arguments;return t.reduce(function(i,s){return o.length>1?r.setEdge(i,s,n):r.setEdge(i,s),s}),this}setEdge(){var t,n,r,o,i=!1,s=arguments[0];typeof s=="object"&&s!==null&&"v"in s?(t=s.v,n=s.w,r=s.name,arguments.length===2&&(o=arguments[1],i=!0)):(t=s,n=arguments[1],r=arguments[3],arguments.length>2&&(o=arguments[2],i=!0)),t=""+t,n=""+n,r!==void 0&&(r=""+r);var a=dr(this._isDirected,t,n,r);if(Object.hasOwn(this._edgeLabels,a))return i&&(this._edgeLabels[a]=o),this;if(r!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(n),this._edgeLabels[a]=i?o:this._defaultEdgeLabelFn(t,n,r);var l=Lw(this._isDirected,t,n,r);return t=l.v,n=l.w,Object.freeze(l),this._edgeObjs[a]=l,Xu(this._preds[n],t),Xu(this._sucs[t],n),this._in[n][a]=l,this._out[t][a]=l,this._edgeCount++,this}edge(t,n,r){var o=arguments.length===1?ls(this._isDirected,arguments[0]):dr(this._isDirected,t,n,r);return this._edgeLabels[o]}edgeAsObj(){let t=this.edge(...arguments);return typeof t!="object"?{label:t}:t}hasEdge(t,n,r){var o=arguments.length===1?ls(this._isDirected,arguments[0]):dr(this._isDirected,t,n,r);return Object.hasOwn(this._edgeLabels,o)}removeEdge(t,n,r){var o=arguments.length===1?ls(this._isDirected,arguments[0]):dr(this._isDirected,t,n,r),i=this._edgeObjs[o];return i&&(t=i.v,n=i.w,delete this._edgeLabels[o],delete this._edgeObjs[o],Zu(this._preds[n],t),Zu(this._sucs[t],n),delete this._in[n][o],delete this._out[t][o],this._edgeCount--),this}inEdges(t,n){var r=this._in[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.v===n):o}}outEdges(t,n){var r=this._out[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.w===n):o}}nodeEdges(t,n){var r=this.inEdges(t,n);if(r)return r.concat(this.outEdges(t,n))}};function Xu(e,t){e[t]?e[t]++:e[t]=1}function Zu(e,t){--e[t]||delete e[t]}function dr(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}return o+Gu+i+Gu+(r===void 0?Fw:r)}function Lw(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}var a={v:o,w:i};return r&&(a.name=r),a}function ls(e,t){return dr(e,t.v,t.w,t.name)}ju.exports=cs});var Ju=Z((KD,Qu)=>{"use strict";Qu.exports="2.2.4"});var tf=Z((qD,ef)=>{"use strict";ef.exports={Graph:Ho(),version:Ju()}});var rf=Z((UD,nf)=>{"use strict";var zw=Ho();nf.exports={write:Bw,read:Vw};function Bw(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:$w(e),edges:Hw(e)};return e.graph()!==void 0&&(t.value=structuredClone(e.graph())),t}function $w(e){return e.nodes().map(function(t){var n=e.node(t),r=e.parent(t),o={v:t};return n!==void 0&&(o.value=n),r!==void 0&&(o.parent=r),o})}function Hw(e){return e.edges().map(function(t){var n=e.edge(t),r={v:t.v,w:t.w};return t.name!==void 0&&(r.name=t.name),n!==void 0&&(r.value=n),r})}function Vw(e){var t=new zw(e.options).setGraph(e.value);return e.nodes.forEach(function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),e.edges.forEach(function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}});var sf=Z((YD,of)=>{"use strict";of.exports=Ww;function Ww(e){var t={},n=[],r;function o(i){Object.hasOwn(t,i)||(t[i]=!0,r.push(i),e.successors(i).forEach(o),e.predecessors(i).forEach(o))}return e.nodes().forEach(function(i){r=[],o(i),r.length&&n.push(r)}),n}});var us=Z((GD,af)=>{"use strict";var ds=class{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(t){return t.key})}has(t){return Object.hasOwn(this._keyIndices,t)}priority(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(t,n){var r=this._keyIndices;if(t=String(t),!Object.hasOwn(r,t)){var o=this._arr,i=o.length;return r[t]=i,o.push({key:t,priority:n}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key}decrease(t,n){var r=this._keyIndices[t];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)}_heapify(t){var n=this._arr,r=2*t,o=r+1,i=t;r<n.length&&(i=n[r].priority<n[i].priority?r:i,o<n.length&&(i=n[o].priority<n[i].priority?o:i),i!==t&&(this._swap(t,i),this._heapify(i)))}_decrease(t){for(var n=this._arr,r=n[t].priority,o;t!==0&&(o=t>>1,!(n[o].priority<r));)this._swap(t,o),t=o}_swap(t,n){var r=this._arr,o=this._keyIndices,i=r[t],s=r[n];r[t]=s,r[n]=i,o[s.key]=t,o[i.key]=n}};af.exports=ds});var fs=Z((XD,lf)=>{"use strict";var Kw=us();lf.exports=Uw;var qw=()=>1;function Uw(e,t,n,r){return Yw(e,String(t),n||qw,r||function(o){return e.outEdges(o)})}function Yw(e,t,n,r){var o={},i=new Kw,s,a,l=function(c){var d=c.v!==s?c.v:c.w,u=o[d],f=n(c),h=a.distance+f;if(f<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+c+" Weight: "+f);h<u.distance&&(u.distance=h,u.predecessor=s,i.decrease(d,h))};for(e.nodes().forEach(function(c){var d=c===t?0:Number.POSITIVE_INFINITY;o[c]={distance:d},i.add(c,d)});i.size()>0&&(s=i.removeMin(),a=o[s],a.distance!==Number.POSITIVE_INFINITY);)r(s).forEach(l);return o}});var df=Z((ZD,cf)=>{"use strict";var Gw=fs();cf.exports=Xw;function Xw(e,t,n){return e.nodes().reduce(function(r,o){return r[o]=Gw(e,o,t,n),r},{})}});var hs=Z((jD,uf)=>{"use strict";uf.exports=Zw;function Zw(e){var t=0,n=[],r={},o=[];function i(s){var a=r[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(d){Object.hasOwn(r,d)?r[d].onStack&&(a.lowlink=Math.min(a.lowlink,r[d].index)):(i(d),a.lowlink=Math.min(a.lowlink,r[d].lowlink))}),a.lowlink===a.index){var l=[],c;do c=n.pop(),r[c].onStack=!1,l.push(c);while(s!==c);o.push(l)}}return e.nodes().forEach(function(s){Object.hasOwn(r,s)||i(s)}),o}});var hf=Z((QD,ff)=>{"use strict";var jw=hs();ff.exports=Qw;function Qw(e){return jw(e).filter(function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}});var mf=Z((JD,pf)=>{"use strict";pf.exports=ev;var Jw=()=>1;function ev(e,t,n){return tv(e,t||Jw,n||function(r){return e.outEdges(r)})}function tv(e,t,n){var r={},o=e.nodes();return o.forEach(function(i){r[i]={},r[i][i]={distance:0},o.forEach(function(s){i!==s&&(r[i][s]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var a=s.v===i?s.w:s.v,l=t(s);r[i][a]={distance:l,predecessor:i}})}),o.forEach(function(i){var s=r[i];o.forEach(function(a){var l=r[a];o.forEach(function(c){var d=l[i],u=s[c],f=l[c],h=d.distance+u.distance;h<f.distance&&(f.distance=h,f.predecessor=u.predecessor)})})}),r}});var ps=Z((eI,yf)=>{"use strict";function gf(e){var t={},n={},r=[];function o(i){if(Object.hasOwn(n,i))throw new ur;Object.hasOwn(t,i)||(n[i]=!0,t[i]=!0,e.predecessors(i).forEach(o),delete n[i],r.push(i))}if(e.sinks().forEach(o),Object.keys(t).length!==e.nodeCount())throw new ur;return r}var ur=class extends Error{constructor(){super(...arguments)}};yf.exports=gf;gf.CycleException=ur});var wf=Z((tI,xf)=>{"use strict";var bf=ps();xf.exports=nv;function nv(e){try{bf(e)}catch(t){if(t instanceof bf.CycleException)return!1;throw t}return!0}});var ms=Z((nI,Sf)=>{"use strict";Sf.exports=rv;function rv(e,t,n){Array.isArray(t)||(t=[t]);var r=e.isDirected()?a=>e.successors(a):a=>e.neighbors(a),o=n==="post"?ov:iv,i=[],s={};return t.forEach(a=>{if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);o(a,r,s,i)}),i}function ov(e,t,n,r){for(var o=[[e,!1]];o.length>0;){var i=o.pop();i[1]?r.push(i[0]):Object.hasOwn(n,i[0])||(n[i[0]]=!0,o.push([i[0],!0]),vf(t(i[0]),s=>o.push([s,!1])))}}function iv(e,t,n,r){for(var o=[e];o.length>0;){var i=o.pop();Object.hasOwn(n,i)||(n[i]=!0,r.push(i),vf(t(i),s=>o.push(s)))}}function vf(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}});var _f=Z((rI,Ef)=>{"use strict";var sv=ms();Ef.exports=av;function av(e,t){return sv(e,t,"post")}});var Nf=Z((oI,Cf)=>{"use strict";var lv=ms();Cf.exports=cv;function cv(e,t){return lv(e,t,"pre")}});var kf=Z((iI,Tf)=>{"use strict";var dv=Ho(),uv=us();Tf.exports=fv;function fv(e,t){var n=new dv,r={},o=new uv,i;function s(l){var c=l.v===i?l.w:l.v,d=o.priority(c);if(d!==void 0){var u=t(l);u<d&&(r[c]=i,o.decrease(c,u))}}if(e.nodeCount()===0)return n;e.nodes().forEach(function(l){o.add(l,Number.POSITIVE_INFINITY),n.setNode(l)}),o.decrease(e.nodes()[0],0);for(var a=!1;o.size()>0;){if(i=o.removeMin(),Object.hasOwn(r,i))n.setEdge(i,r[i]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(i).forEach(s)}return n}});var If=Z((sI,Df)=>{"use strict";Df.exports={components:sf(),dijkstra:fs(),dijkstraAll:df(),findCycles:hf(),floydWarshall:mf(),isAcyclic:wf(),postorder:_f(),preorder:Nf(),prim:kf(),tarjan:hs(),topsort:ps()}});var je=Z((aI,Of)=>{"use strict";var Mf=tf();Of.exports={Graph:Mf.Graph,json:rf(),alg:If(),version:Mf.version}});var Af=Z((lI,Pf)=>{"use strict";var gs=class{constructor(){let t={};t._next=t._prev=t,this._sentinel=t}dequeue(){let t=this._sentinel,n=t._prev;if(n!==t)return Rf(n),n}enqueue(t){let n=this._sentinel;t._prev&&t._next&&Rf(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n}toString(){let t=[],n=this._sentinel,r=n._prev;for(;r!==n;)t.push(JSON.stringify(r,hv)),r=r._prev;return"["+t.join(", ")+"]"}};function Rf(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function hv(e,t){if(e!=="_next"&&e!=="_prev")return t}Pf.exports=gs});var Lf=Z((cI,Ff)=>{"use strict";var pv=je().Graph,mv=Af();Ff.exports=yv;var gv=()=>1;function yv(e,t){if(e.nodeCount()<=1)return[];let n=xv(e,t||gv);return bv(n.graph,n.buckets,n.zeroIdx).flatMap(o=>e.outEdges(o.v,o.w))}function bv(e,t,n){let r=[],o=t[t.length-1],i=t[0],s;for(;e.nodeCount();){for(;s=i.dequeue();)ys(e,t,n,s);for(;s=o.dequeue();)ys(e,t,n,s);if(e.nodeCount()){for(let a=t.length-2;a>0;--a)if(s=t[a].dequeue(),s){r=r.concat(ys(e,t,n,s,!0));break}}}return r}function ys(e,t,n,r,o){let i=o?[]:void 0;return e.inEdges(r.v).forEach(s=>{let a=e.edge(s),l=e.node(s.v);o&&i.push({v:s.v,w:s.w}),l.out-=a,bs(t,n,l)}),e.outEdges(r.v).forEach(s=>{let a=e.edge(s),l=s.w,c=e.node(l);c.in-=a,bs(t,n,c)}),e.removeNode(r.v),i}function xv(e,t){let n=new pv,r=0,o=0;e.nodes().forEach(a=>{n.setNode(a,{v:a,in:0,out:0})}),e.edges().forEach(a=>{let l=n.edge(a.v,a.w)||0,c=t(a),d=l+c;n.setEdge(a.v,a.w,d),o=Math.max(o,n.node(a.v).out+=c),r=Math.max(r,n.node(a.w).in+=c)});let i=wv(o+r+3).map(()=>new mv),s=r+1;return n.nodes().forEach(a=>{bs(i,s,n.node(a))}),{graph:n,buckets:i,zeroIdx:s}}function bs(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function wv(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}});var we=Z((dI,Kf)=>{"use strict";var zf=je().Graph;Kf.exports={addBorderNode:Dv,addDummyNode:Bf,applyWithChunking:Vo,asNonCompoundGraph:Sv,buildLayerMatrix:Nv,intersectRect:Cv,mapValues:Fv,maxRank:Hf,normalizeRanks:Tv,notime:Rv,partition:Mv,pick:Av,predecessorWeights:_v,range:Wf,removeEmptyRanks:kv,simplify:vv,successorWeights:Ev,time:Ov,uniqueId:Vf,zipObject:xs};function Bf(e,t,n,r){let o;do o=Vf(r);while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}function vv(e){let t=new zf().setGraph(e.graph());return e.nodes().forEach(n=>t.setNode(n,e.node(n))),e.edges().forEach(n=>{let r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t}function Sv(e){let t=new zf({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{e.children(n).length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdge(n,e.edge(n))}),t}function Ev(e){let t=e.nodes().map(n=>{let r={};return e.outEdges(n).forEach(o=>{r[o.w]=(r[o.w]||0)+e.edge(o).weight}),r});return xs(e.nodes(),t)}function _v(e){let t=e.nodes().map(n=>{let r={};return e.inEdges(n).forEach(o=>{r[o.v]=(r[o.v]||0)+e.edge(o).weight}),r});return xs(e.nodes(),t)}function Cv(e,t){let n=e.x,r=e.y,o=t.x-n,i=t.y-r,s=e.width/2,a=e.height/2;if(!o&&!i)throw new Error("Not possible to find intersection inside of the rectangle");let l,c;return Math.abs(i)*s>Math.abs(o)*a?(i<0&&(a=-a),l=a*o/i,c=a):(o<0&&(s=-s),l=s,c=s*i/o),{x:n+l,y:r+c}}function Nv(e){let t=Wf(Hf(e)+1).map(()=>[]);return e.nodes().forEach(n=>{let r=e.node(n),o=r.rank;o!==void 0&&(t[o][r.order]=n)}),t}function Tv(e){let t=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MAX_VALUE:o}),n=Vo(Math.min,t);e.nodes().forEach(r=>{let o=e.node(r);Object.hasOwn(o,"rank")&&(o.rank-=n)})}function kv(e){let t=e.nodes().map(s=>e.node(s).rank),n=Vo(Math.min,t),r=[];e.nodes().forEach(s=>{let a=e.node(s).rank-n;r[a]||(r[a]=[]),r[a].push(s)});let o=0,i=e.graph().nodeRankFactor;Array.from(r).forEach((s,a)=>{s===void 0&&a%i!==0?--o:s!==void 0&&o&&s.forEach(l=>e.node(l).rank+=o)})}function Dv(e,t,n,r){let o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=r),Bf(e,"border",o,t)}function Iv(e,t=$f){let n=[];for(let r=0;r<e.length;r+=t){let o=e.slice(r,r+t);n.push(o)}return n}var $f=65535;function Vo(e,t){if(t.length>$f){let n=Iv(t);return e.apply(null,n.map(r=>e.apply(null,r)))}else return e.apply(null,t)}function Hf(e){let n=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MIN_VALUE:o});return Vo(Math.max,n)}function Mv(e,t){let n={lhs:[],rhs:[]};return e.forEach(r=>{t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function Ov(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function Rv(e,t){return t()}var Pv=0;function Vf(e){var t=++Pv;return toString(e)+t}function Wf(e,t,n=1){t==null&&(t=e,e=0);let r=i=>i<t;n<0&&(r=i=>t<i);let o=[];for(let i=e;r(i);i+=n)o.push(i);return o}function Av(e,t){let n={};for(let r of t)e[r]!==void 0&&(n[r]=e[r]);return n}function Fv(e,t){let n=t;return typeof t=="string"&&(n=r=>r[t]),Object.entries(e).reduce((r,[o,i])=>(r[o]=n(i,o),r),{})}function xs(e,t){return e.reduce((n,r,o)=>(n[r]=t[o],n),{})}});var Uf=Z((uI,qf)=>{"use strict";var Lv=Lf(),zv=we().uniqueId;qf.exports={run:Bv,undo:Hv};function Bv(e){(e.graph().acyclicer==="greedy"?Lv(e,n(e)):$v(e)).forEach(r=>{let o=e.edge(r);e.removeEdge(r),o.forwardName=r.name,o.reversed=!0,e.setEdge(r.w,r.v,o,zv("rev"))});function n(r){return o=>r.edge(o).weight}}function $v(e){let t=[],n={},r={};function o(i){Object.hasOwn(r,i)||(r[i]=!0,n[i]=!0,e.outEdges(i).forEach(s=>{Object.hasOwn(n,s.w)?t.push(s):o(s.w)}),delete n[i])}return e.nodes().forEach(o),t}function Hv(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}});var Gf=Z((fI,Yf)=>{"use strict";var Vv=we();Yf.exports={run:Wv,undo:qv};function Wv(e){e.graph().dummyChains=[],e.edges().forEach(t=>Kv(e,t))}function Kv(e,t){let n=t.v,r=e.node(n).rank,o=t.w,i=e.node(o).rank,s=t.name,a=e.edge(t),l=a.labelRank;if(i===r+1)return;e.removeEdge(t);let c,d,u;for(u=0,++r;r<i;++u,++r)a.points=[],d={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},c=Vv.addDummyNode(e,"edge",d,"_d"),r===l&&(d.width=a.width,d.height=a.height,d.dummy="edge-label",d.labelpos=a.labelpos),e.setEdge(n,c,{weight:a.weight},s),u===0&&e.graph().dummyChains.push(c),n=c;e.setEdge(n,o,{weight:a.weight},s)}function qv(e){e.graph().dummyChains.forEach(t=>{let n=e.node(t),r=n.edgeLabel,o;for(e.setEdge(n.edgeObj,r);n.dummy;)o=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=o,n=e.node(t)})}});var fr=Z((hI,Xf)=>{"use strict";var{applyWithChunking:Uv}=we();Xf.exports={longestPath:Yv,slack:Gv};function Yv(e){var t={};function n(r){var o=e.node(r);if(Object.hasOwn(t,r))return o.rank;t[r]=!0;let i=e.outEdges(r).map(a=>a==null?Number.POSITIVE_INFINITY:n(a.w)-e.edge(a).minlen);var s=Uv(Math.min,i);return s===Number.POSITIVE_INFINITY&&(s=0),o.rank=s}e.sources().forEach(n)}function Gv(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}});var ws=Z((pI,Zf)=>{"use strict";var Xv=je().Graph,Wo=fr().slack;Zf.exports=Zv;function Zv(e){var t=new Xv({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var o,i;jv(t,e)<r;)o=Qv(t,e),i=t.hasNode(o.v)?Wo(e,o):-Wo(e,o),Jv(t,e,i);return t}function jv(e,t){function n(r){t.nodeEdges(r).forEach(o=>{var i=o.v,s=r===i?o.w:i;!e.hasNode(s)&&!Wo(t,o)&&(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))})}return e.nodes().forEach(n),e.nodeCount()}function Qv(e,t){return t.edges().reduce((r,o)=>{let i=Number.POSITIVE_INFINITY;return e.hasNode(o.v)!==e.hasNode(o.w)&&(i=Wo(t,o)),i<r[0]?[i,o]:r},[Number.POSITIVE_INFINITY,null])[1]}function Jv(e,t,n){e.nodes().forEach(r=>t.node(r).rank+=n)}});var ih=Z((mI,oh)=>{"use strict";var eS=ws(),jf=fr().slack,tS=fr().longestPath,nS=je().alg.preorder,rS=je().alg.postorder,oS=we().simplify;oh.exports=Qt;Qt.initLowLimValues=Ss;Qt.initCutValues=vs;Qt.calcCutValue=Jf;Qt.leaveEdge=th;Qt.enterEdge=nh;Qt.exchangeEdges=rh;function Qt(e){e=oS(e),tS(e);var t=eS(e);Ss(t),vs(t,e);for(var n,r;n=th(t);)r=nh(t,e,n),rh(t,e,n,r)}function vs(e,t){var n=rS(e,e.nodes());n=n.slice(0,n.length-1),n.forEach(r=>iS(e,t,r))}function iS(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=Jf(e,t,n)}function Jf(e,t,n){var r=e.node(n),o=r.parent,i=!0,s=t.edge(n,o),a=0;return s||(i=!1,s=t.edge(o,n)),a=s.weight,t.nodeEdges(n).forEach(l=>{var c=l.v===n,d=c?l.w:l.v;if(d!==o){var u=c===i,f=t.edge(l).weight;if(a+=u?f:-f,aS(e,n,d)){var h=e.edge(n,d).cutvalue;a+=u?-h:h}}}),a}function Ss(e,t){arguments.length<2&&(t=e.nodes()[0]),eh(e,{},1,t)}function eh(e,t,n,r,o){var i=n,s=e.node(r);return t[r]=!0,e.neighbors(r).forEach(a=>{Object.hasOwn(t,a)||(n=eh(e,t,n,a,r))}),s.low=i,s.lim=n++,o?s.parent=o:delete s.parent,n}function th(e){return e.edges().find(t=>e.edge(t).cutvalue<0)}function nh(e,t,n){var r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);var i=e.node(r),s=e.node(o),a=i,l=!1;i.lim>s.lim&&(a=s,l=!0);var c=t.edges().filter(d=>l===Qf(e,e.node(d.v),a)&&l!==Qf(e,e.node(d.w),a));return c.reduce((d,u)=>jf(t,u)<jf(t,d)?u:d)}function rh(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),Ss(e),vs(e,t),sS(e,t)}function sS(e,t){var n=e.nodes().find(o=>!t.node(o).parent),r=nS(e,n);r=r.slice(1),r.forEach(o=>{var i=e.node(o).parent,s=t.edge(o,i),a=!1;s||(s=t.edge(i,o),a=!0),t.node(o).rank=t.node(i).rank+(a?s.minlen:-s.minlen)})}function aS(e,t,n){return e.hasEdge(t,n)}function Qf(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}});var ch=Z((gI,lh)=>{"use strict";var lS=fr(),ah=lS.longestPath,cS=ws(),dS=ih();lh.exports=uS;function uS(e){switch(e.graph().ranker){case"network-simplex":sh(e);break;case"tight-tree":hS(e);break;case"longest-path":fS(e);break;default:sh(e)}}var fS=ah;function hS(e){ah(e),cS(e)}function sh(e){dS(e)}});var uh=Z((yI,dh)=>{"use strict";dh.exports=pS;function pS(e){let t=gS(e);e.graph().dummyChains.forEach(n=>{let r=e.node(n),o=r.edgeObj,i=mS(e,t,o.v,o.w),s=i.path,a=i.lca,l=0,c=s[l],d=!0;for(;n!==o.w;){if(r=e.node(n),d){for(;(c=s[l])!==a&&e.node(c).maxRank<r.rank;)l++;c===a&&(d=!1)}if(!d){for(;l<s.length-1&&e.node(c=s[l+1]).minRank<=r.rank;)l++;c=s[l]}e.setParent(n,c),n=e.successors(n)[0]}})}function mS(e,t,n,r){let o=[],i=[],s=Math.min(t[n].low,t[r].low),a=Math.max(t[n].lim,t[r].lim),l,c;l=n;do l=e.parent(l),o.push(l);while(l&&(t[l].low>s||a>t[l].lim));for(c=l,l=r;(l=e.parent(l))!==c;)i.push(l);return{path:o.concat(i.reverse()),lca:c}}function gS(e){let t={},n=0;function r(o){let i=n;e.children(o).forEach(r),t[o]={low:i,lim:n++}}return e.children().forEach(r),t}});var ph=Z((bI,hh)=>{"use strict";var Ko=we();hh.exports={run:yS,cleanup:wS};function yS(e){let t=Ko.addDummyNode(e,"root",{},"_root"),n=bS(e),r=Object.values(n),o=Ko.applyWithChunking(Math.max,r)-1,i=2*o+1;e.graph().nestingRoot=t,e.edges().forEach(a=>e.edge(a).minlen*=i);let s=xS(e)+1;e.children().forEach(a=>fh(e,t,i,s,o,n,a)),e.graph().nodeRankFactor=i}function fh(e,t,n,r,o,i,s){let a=e.children(s);if(!a.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:n});return}let l=Ko.addBorderNode(e,"_bt"),c=Ko.addBorderNode(e,"_bb"),d=e.node(s);e.setParent(l,s),d.borderTop=l,e.setParent(c,s),d.borderBottom=c,a.forEach(u=>{fh(e,t,n,r,o,i,u);let f=e.node(u),h=f.borderTop?f.borderTop:u,p=f.borderBottom?f.borderBottom:u,g=f.borderTop?r:2*r,v=h!==p?1:o-i[s]+1;e.setEdge(l,h,{weight:g,minlen:v,nestingEdge:!0}),e.setEdge(p,c,{weight:g,minlen:v,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,l,{weight:0,minlen:o+i[s]})}function bS(e){var t={};function n(r,o){var i=e.children(r);i&&i.length&&i.forEach(s=>n(s,o+1)),t[r]=o}return e.children().forEach(r=>n(r,1)),t}function xS(e){return e.edges().reduce((t,n)=>t+e.edge(n).weight,0)}function wS(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}});var yh=Z((xI,gh)=>{"use strict";var vS=we();gh.exports=SS;function SS(e){function t(n){let r=e.children(n),o=e.node(n);if(r.length&&r.forEach(t),Object.hasOwn(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(let i=o.minRank,s=o.maxRank+1;i<s;++i)mh(e,"borderLeft","_bl",n,o,i),mh(e,"borderRight","_br",n,o,i)}}e.children().forEach(t)}function mh(e,t,n,r,o,i){let s={width:0,height:0,rank:i,borderType:t},a=o[t][i-1],l=vS.addDummyNode(e,"border",s,n);o[t][i]=l,e.setParent(l,r),a&&e.setEdge(a,l,{weight:1})}});var vh=Z((wI,wh)=>{"use strict";wh.exports={adjust:ES,undo:_S};function ES(e){let t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&xh(e)}function _S(e){let t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&CS(e),(t==="lr"||t==="rl")&&(NS(e),xh(e))}function xh(e){e.nodes().forEach(t=>bh(e.node(t))),e.edges().forEach(t=>bh(e.edge(t)))}function bh(e){let t=e.width;e.width=e.height,e.height=t}function CS(e){e.nodes().forEach(t=>Es(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(Es),Object.hasOwn(n,"y")&&Es(n)})}function Es(e){e.y=-e.y}function NS(e){e.nodes().forEach(t=>_s(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(_s),Object.hasOwn(n,"x")&&_s(n)})}function _s(e){let t=e.x;e.x=e.y,e.y=t}});var _h=Z((vI,Eh)=>{"use strict";var Sh=we();Eh.exports=TS;function TS(e){let t={},n=e.nodes().filter(l=>!e.children(l).length),r=n.map(l=>e.node(l).rank),o=Sh.applyWithChunking(Math.max,r),i=Sh.range(o+1).map(()=>[]);function s(l){if(t[l])return;t[l]=!0;let c=e.node(l);i[c.rank].push(l),e.successors(l).forEach(s)}return n.sort((l,c)=>e.node(l).rank-e.node(c).rank).forEach(s),i}});var Nh=Z((SI,Ch)=>{"use strict";var kS=we().zipObject;Ch.exports=DS;function DS(e,t){let n=0;for(let r=1;r<t.length;++r)n+=IS(e,t[r-1],t[r]);return n}function IS(e,t,n){let r=kS(n,n.map((c,d)=>d)),o=t.flatMap(c=>e.outEdges(c).map(d=>({pos:r[d.w],weight:e.edge(d).weight})).sort((d,u)=>d.pos-u.pos)),i=1;for(;i<n.length;)i<<=1;let s=2*i-1;i-=1;let a=new Array(s).fill(0),l=0;return o.forEach(c=>{let d=c.pos+i;a[d]+=c.weight;let u=0;for(;d>0;)d%2&&(u+=a[d+1]),d=d-1>>1,a[d]+=c.weight;l+=c.weight*u}),l}});var kh=Z((EI,Th)=>{"use strict";Th.exports=MS;function MS(e,t=[]){return t.map(n=>{let r=e.inEdges(n);if(r.length){let o=r.reduce((i,s)=>{let a=e.edge(s),l=e.node(s.v);return{sum:i.sum+a.weight*l.order,weight:i.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:o.sum/o.weight,weight:o.weight}}else return{v:n}})}});var Ih=Z((_I,Dh)=>{"use strict";var OS=we();Dh.exports=RS;function RS(e,t){let n={};e.forEach((o,i)=>{let s=n[o.v]={indegree:0,in:[],out:[],vs:[o.v],i};o.barycenter!==void 0&&(s.barycenter=o.barycenter,s.weight=o.weight)}),t.edges().forEach(o=>{let i=n[o.v],s=n[o.w];i!==void 0&&s!==void 0&&(s.indegree++,i.out.push(n[o.w]))});let r=Object.values(n).filter(o=>!o.indegree);return PS(r)}function PS(e){let t=[];function n(o){return i=>{i.merged||(i.barycenter===void 0||o.barycenter===void 0||i.barycenter>=o.barycenter)&&AS(o,i)}}function r(o){return i=>{i.in.push(o),--i.indegree===0&&e.push(i)}}for(;e.length;){let o=e.pop();t.push(o),o.in.reverse().forEach(n(o)),o.out.forEach(r(o))}return t.filter(o=>!o.merged).map(o=>OS.pick(o,["vs","i","barycenter","weight"]))}function AS(e,t){let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}});var Rh=Z((CI,Oh)=>{"use strict";var FS=we();Oh.exports=LS;function LS(e,t){let n=FS.partition(e,d=>Object.hasOwn(d,"barycenter")),r=n.lhs,o=n.rhs.sort((d,u)=>u.i-d.i),i=[],s=0,a=0,l=0;r.sort(zS(!!t)),l=Mh(i,o,l),r.forEach(d=>{l+=d.vs.length,i.push(d.vs),s+=d.barycenter*d.weight,a+=d.weight,l=Mh(i,o,l)});let c={vs:i.flat(!0)};return a&&(c.barycenter=s/a,c.weight=a),c}function Mh(e,t,n){let r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e.push(r.vs),n++;return n}function zS(e){return(t,n)=>t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}});var Fh=Z((NI,Ah)=>{"use strict";var BS=kh(),$S=Ih(),HS=Rh();Ah.exports=Ph;function Ph(e,t,n,r){let o=e.children(t),i=e.node(t),s=i?i.borderLeft:void 0,a=i?i.borderRight:void 0,l={};s&&(o=o.filter(f=>f!==s&&f!==a));let c=BS(e,o);c.forEach(f=>{if(e.children(f.v).length){let h=Ph(e,f.v,n,r);l[f.v]=h,Object.hasOwn(h,"barycenter")&&WS(f,h)}});let d=$S(c,n);VS(d,l);let u=HS(d,r);if(s&&(u.vs=[s,u.vs,a].flat(!0),e.predecessors(s).length)){let f=e.node(e.predecessors(s)[0]),h=e.node(e.predecessors(a)[0]);Object.hasOwn(u,"barycenter")||(u.barycenter=0,u.weight=0),u.barycenter=(u.barycenter*u.weight+f.order+h.order)/(u.weight+2),u.weight+=2}return u}function VS(e,t){e.forEach(n=>{n.vs=n.vs.flatMap(r=>t[r]?t[r].vs:r)})}function WS(e,t){e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}});var zh=Z((TI,Lh)=>{"use strict";var KS=je().Graph,qS=we();Lh.exports=US;function US(e,t,n){let r=YS(e),o=new KS({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{let s=e.node(i),a=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(o.setNode(i),o.setParent(i,a||r),e[n](i).forEach(l=>{let c=l.v===i?l.w:l.v,d=o.edge(c,i),u=d!==void 0?d.weight:0;o.setEdge(c,i,{weight:e.edge(l).weight+u})}),Object.hasOwn(s,"minRank")&&o.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),o}function YS(e){for(var t;e.hasNode(t=qS.uniqueId("_root")););return t}});var $h=Z((kI,Bh)=>{"use strict";Bh.exports=GS;function GS(e,t,n){let r={},o;n.forEach(i=>{let s=e.parent(i),a,l;for(;s;){if(a=e.parent(s),a?(l=r[a],r[a]=s):(l=o,o=s),l&&l!==s){t.setEdge(l,s);return}s=a}})}});var qh=Z((DI,Kh)=>{"use strict";var XS=_h(),ZS=Nh(),jS=Fh(),QS=zh(),JS=$h(),eE=je().Graph,qo=we();Kh.exports=Wh;function Wh(e,t){if(t&&typeof t.customOrder=="function"){t.customOrder(e,Wh);return}let n=qo.maxRank(e),r=Hh(e,qo.range(1,n+1),"inEdges"),o=Hh(e,qo.range(n-1,-1,-1),"outEdges"),i=XS(e);if(Vh(e,i),t&&t.disableOptimalOrderHeuristic)return;let s=Number.POSITIVE_INFINITY,a;for(let l=0,c=0;c<4;++l,++c){tE(l%2?r:o,l%4>=2),i=qo.buildLayerMatrix(e);let d=ZS(e,i);d<s&&(c=0,a=Object.assign({},i),s=d)}Vh(e,a)}function Hh(e,t,n){return t.map(function(r){return QS(e,r,n)})}function tE(e,t){let n=new eE;e.forEach(function(r){let o=r.graph().root,i=jS(r,o,n,t);i.vs.forEach((s,a)=>r.node(s).order=a),JS(r,n,i.vs)})}function Vh(e,t){Object.values(t).forEach(n=>n.forEach((r,o)=>e.node(r).order=o))}});var tp=Z((II,ep)=>{"use strict";var nE=je().Graph,vt=we();ep.exports={positionX:iE,findType1Conflicts:Uh,findType2Conflicts:Yh,addConflict:Cs,hasConflict:Gh,verticalAlignment:Xh,horizontalCompaction:Zh,alignCoordinates:Qh,findSmallestWidthAlignment:jh,balance:Jh};function Uh(e,t){let n={};function r(o,i){let s=0,a=0,l=o.length,c=i[i.length-1];return i.forEach((d,u)=>{let f=rE(e,d),h=f?e.node(f).order:l;(f||d===c)&&(i.slice(a,u+1).forEach(p=>{e.predecessors(p).forEach(g=>{let v=e.node(g),y=v.order;(y<s||h<y)&&!(v.dummy&&e.node(p).dummy)&&Cs(n,g,p)})}),a=u+1,s=h)}),i}return t.length&&t.reduce(r),n}function Yh(e,t){let n={};function r(i,s,a,l,c){let d;vt.range(s,a).forEach(u=>{d=i[u],e.node(d).dummy&&e.predecessors(d).forEach(f=>{let h=e.node(f);h.dummy&&(h.order<l||h.order>c)&&Cs(n,f,d)})})}function o(i,s){let a=-1,l,c=0;return s.forEach((d,u)=>{if(e.node(d).dummy==="border"){let f=e.predecessors(d);f.length&&(l=e.node(f[0]).order,r(s,c,u,a,l),c=u,a=l)}r(s,c,s.length,l,i.length)}),s}return t.length&&t.reduce(o),n}function rE(e,t){if(e.node(t).dummy)return e.predecessors(t).find(n=>e.node(n).dummy)}function Cs(e,t,n){if(t>n){let o=t;t=n,n=o}let r=e[t];r||(e[t]=r={}),r[n]=!0}function Gh(e,t,n){if(t>n){let r=t;t=n,n=r}return!!e[t]&&Object.hasOwn(e[t],n)}function Xh(e,t,n,r){let o={},i={},s={};return t.forEach(a=>{a.forEach((l,c)=>{o[l]=l,i[l]=l,s[l]=c})}),t.forEach(a=>{let l=-1;a.forEach(c=>{let d=r(c);if(d.length){d=d.sort((f,h)=>s[f]-s[h]);let u=(d.length-1)/2;for(let f=Math.floor(u),h=Math.ceil(u);f<=h;++f){let p=d[f];i[c]===c&&l<s[p]&&!Gh(n,c,p)&&(i[p]=c,i[c]=o[c]=o[p],l=s[p])}}})}),{root:o,align:i}}function Zh(e,t,n,r,o){let i={},s=oE(e,t,n,o),a=o?"borderLeft":"borderRight";function l(u,f){let h=s.nodes(),p=h.pop(),g={};for(;p;)g[p]?u(p):(g[p]=!0,h.push(p),h=h.concat(f(p))),p=h.pop()}function c(u){i[u]=s.inEdges(u).reduce((f,h)=>Math.max(f,i[h.v]+s.edge(h)),0)}function d(u){let f=s.outEdges(u).reduce((p,g)=>Math.min(p,i[g.w]-s.edge(g)),Number.POSITIVE_INFINITY),h=e.node(u);f!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(i[u]=Math.max(i[u],f))}return l(c,s.predecessors.bind(s)),l(d,s.successors.bind(s)),Object.keys(r).forEach(u=>i[u]=i[n[u]]),i}function oE(e,t,n,r){let o=new nE,i=e.graph(),s=sE(i.nodesep,i.edgesep,r);return t.forEach(a=>{let l;a.forEach(c=>{let d=n[c];if(o.setNode(d),l){var u=n[l],f=o.edge(u,d);o.setEdge(u,d,Math.max(s(e,c,l),f||0))}l=c})}),o}function jh(e,t){return Object.values(t).reduce((n,r)=>{let o=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;Object.entries(r).forEach(([a,l])=>{let c=aE(e,a)/2;o=Math.max(l+c,o),i=Math.min(l-c,i)});let s=o-i;return s<n[0]&&(n=[s,r]),n},[Number.POSITIVE_INFINITY,null])[1]}function Qh(e,t){let n=Object.values(t),r=vt.applyWithChunking(Math.min,n),o=vt.applyWithChunking(Math.max,n);["u","d"].forEach(i=>{["l","r"].forEach(s=>{let a=i+s,l=e[a];if(l===t)return;let c=Object.values(l),d=r-vt.applyWithChunking(Math.min,c);s!=="l"&&(d=o-vt.applyWithChunking(Math.max,c)),d&&(e[a]=vt.mapValues(l,u=>u+d))})})}function Jh(e,t){return vt.mapValues(e.ul,(n,r)=>{if(t)return e[t.toLowerCase()][r];{let o=Object.values(e).map(i=>i[r]).sort((i,s)=>i-s);return(o[1]+o[2])/2}})}function iE(e){let t=vt.buildLayerMatrix(e),n=Object.assign(Uh(e,t),Yh(e,t)),r={},o;["u","d"].forEach(s=>{o=s==="u"?t:Object.values(t).reverse(),["l","r"].forEach(a=>{a==="r"&&(o=o.map(u=>Object.values(u).reverse()));let l=(s==="u"?e.predecessors:e.successors).bind(e),c=Xh(e,o,n,l),d=Zh(e,o,c.root,c.align,a==="r");a==="r"&&(d=vt.mapValues(d,u=>-u)),r[s+a]=d})});let i=jh(e,r);return Qh(r,i),Jh(r,e.graph().align)}function sE(e,t,n){return(r,o,i)=>{let s=r.node(o),a=r.node(i),l=0,c;if(l+=s.width/2,Object.hasOwn(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":c=-s.width/2;break;case"r":c=s.width/2;break}if(c&&(l+=n?c:-c),c=0,l+=(s.dummy?t:e)/2,l+=(a.dummy?t:e)/2,l+=a.width/2,Object.hasOwn(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":c=a.width/2;break;case"r":c=-a.width/2;break}return c&&(l+=n?c:-c),c=0,l}}function aE(e,t){return e.node(t).width}});var op=Z((MI,rp)=>{"use strict";var np=we(),lE=tp().positionX;rp.exports=cE;function cE(e){e=np.asNonCompoundGraph(e),dE(e),Object.entries(lE(e)).forEach(([t,n])=>e.node(t).x=n)}function dE(e){let t=np.buildLayerMatrix(e),n=e.graph().ranksep,r=0;t.forEach(o=>{let i=o.reduce((s,a)=>{let l=e.node(a).height;return s>l?s:l},0);o.forEach(s=>e.node(s).y=r+i/2),r+=i+n})}});var up=Z((OI,dp)=>{"use strict";var ip=Uf(),sp=Gf(),uE=ch(),fE=we().normalizeRanks,hE=uh(),pE=we().removeEmptyRanks,ap=ph(),mE=yh(),lp=vh(),gE=qh(),yE=op(),Qe=we(),bE=je().Graph;dp.exports=xE;function xE(e,t){let n=t&&t.debugTiming?Qe.time:Qe.notime;n("layout",()=>{let r=n("  buildLayoutGraph",()=>DE(e));n("  runLayout",()=>wE(r,n,t)),n("  updateInputGraph",()=>vE(e,r))})}function wE(e,t,n){t("    makeSpaceForEdgeLabels",()=>IE(e)),t("    removeSelfEdges",()=>BE(e)),t("    acyclic",()=>ip.run(e)),t("    nestingGraph.run",()=>ap.run(e)),t("    rank",()=>uE(Qe.asNonCompoundGraph(e))),t("    injectEdgeLabelProxies",()=>ME(e)),t("    removeEmptyRanks",()=>pE(e)),t("    nestingGraph.cleanup",()=>ap.cleanup(e)),t("    normalizeRanks",()=>fE(e)),t("    assignRankMinMax",()=>OE(e)),t("    removeEdgeLabelProxies",()=>RE(e)),t("    normalize.run",()=>sp.run(e)),t("    parentDummyChains",()=>hE(e)),t("    addBorderSegments",()=>mE(e)),t("    order",()=>gE(e,n)),t("    insertSelfEdges",()=>$E(e)),t("    adjustCoordinateSystem",()=>lp.adjust(e)),t("    position",()=>yE(e)),t("    positionSelfEdges",()=>HE(e)),t("    removeBorderNodes",()=>zE(e)),t("    normalize.undo",()=>sp.undo(e)),t("    fixupEdgeLabelCoords",()=>FE(e)),t("    undoCoordinateSystem",()=>lp.undo(e)),t("    translateGraph",()=>PE(e)),t("    assignNodeIntersects",()=>AE(e)),t("    reversePoints",()=>LE(e)),t("    acyclic.undo",()=>ip.undo(e))}function vE(e,t){e.nodes().forEach(n=>{let r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,r.rank=o.rank,t.children(n).length&&(r.width=o.width,r.height=o.height))}),e.edges().forEach(n=>{let r=e.edge(n),o=t.edge(n);r.points=o.points,Object.hasOwn(o,"x")&&(r.x=o.x,r.y=o.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var SE=["nodesep","edgesep","ranksep","marginx","marginy"],EE={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},_E=["acyclicer","ranker","rankdir","align"],CE=["width","height"],cp={width:0,height:0},NE=["minlen","weight","width","height","labeloffset"],TE={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},kE=["labelpos"];function DE(e){let t=new bE({multigraph:!0,compound:!0}),n=Ts(e.graph());return t.setGraph(Object.assign({},EE,Ns(n,SE),Qe.pick(n,_E))),e.nodes().forEach(r=>{let o=Ts(e.node(r)),i=Ns(o,CE);Object.keys(cp).forEach(s=>{i[s]===void 0&&(i[s]=cp[s])}),t.setNode(r,i),t.setParent(r,e.parent(r))}),e.edges().forEach(r=>{let o=Ts(e.edge(r));t.setEdge(r,Object.assign({},TE,Ns(o,NE),Qe.pick(o,kE)))}),t}function IE(e){let t=e.graph();t.ranksep/=2,e.edges().forEach(n=>{let r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function ME(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.width&&n.height){let r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};Qe.addDummyNode(e,"edge-proxy",i,"_ep")}})}function OE(e){let t=0;e.nodes().forEach(n=>{let r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))}),e.graph().maxRank=t}function RE(e){e.nodes().forEach(t=>{let n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function PE(e){let t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,o=0,i=e.graph(),s=i.marginx||0,a=i.marginy||0;function l(c){let d=c.x,u=c.y,f=c.width,h=c.height;t=Math.min(t,d-f/2),n=Math.max(n,d+f/2),r=Math.min(r,u-h/2),o=Math.max(o,u+h/2)}e.nodes().forEach(c=>l(e.node(c))),e.edges().forEach(c=>{let d=e.edge(c);Object.hasOwn(d,"x")&&l(d)}),t-=s,r-=a,e.nodes().forEach(c=>{let d=e.node(c);d.x-=t,d.y-=r}),e.edges().forEach(c=>{let d=e.edge(c);d.points.forEach(u=>{u.x-=t,u.y-=r}),Object.hasOwn(d,"x")&&(d.x-=t),Object.hasOwn(d,"y")&&(d.y-=r)}),i.width=n-t+s,i.height=o-r+a}function AE(e){e.edges().forEach(t=>{let n=e.edge(t),r=e.node(t.v),o=e.node(t.w),i,s;n.points?(i=n.points[0],s=n.points[n.points.length-1]):(n.points=[],i=o,s=r),n.points.unshift(Qe.intersectRect(r,i)),n.points.push(Qe.intersectRect(o,s))})}function FE(e){e.edges().forEach(t=>{let n=e.edge(t);if(Object.hasOwn(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function LE(e){e.edges().forEach(t=>{let n=e.edge(t);n.reversed&&n.points.reverse()})}function zE(e){e.nodes().forEach(t=>{if(e.children(t).length){let n=e.node(t),r=e.node(n.borderTop),o=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),s=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(s.x-i.x),n.height=Math.abs(o.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}}),e.nodes().forEach(t=>{e.node(t).dummy==="border"&&e.removeNode(t)})}function BE(e){e.edges().forEach(t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function $E(e){var t=Qe.buildLayerMatrix(e);t.forEach(n=>{var r=0;n.forEach((o,i)=>{var s=e.node(o);s.order=i+r,(s.selfEdges||[]).forEach(a=>{Qe.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:i+ ++r,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function HE(e){e.nodes().forEach(t=>{var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,s=n.x-o,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*s/3,y:i-a},{x:o+5*s/6,y:i-a},{x:o+s,y:i},{x:o+5*s/6,y:i+a},{x:o+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}function Ns(e,t){return Qe.mapValues(Qe.pick(e,t),Number)}function Ts(e){var t={};return e&&Object.entries(e).forEach(([n,r])=>{typeof n=="string"&&(n=n.toLowerCase()),t[n]=r}),t}});var hp=Z((RI,fp)=>{"use strict";var VE=we(),WE=je().Graph;fp.exports={debugOrdering:KE};function KE(e){let t=VE.buildLayerMatrix(e),n=new WE({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach(r=>{n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),e.edges().forEach(r=>n.setEdge(r.v,r.w,{},r.name)),t.forEach((r,o)=>{let i="layer"+o;n.setNode(i,{rank:"same"}),r.reduce((s,a)=>(n.setEdge(s,a,{style:"invis"}),a))}),n}});var mp=Z((PI,pp)=>{"use strict";pp.exports="1.1.4"});var yp=Z((AI,gp)=>{"use strict";gp.exports={graphlib:je(),layout:up(),debug:hp(),util:{time:we().time,notime:we().notime},version:mp()}});var ym=V(wg());var Mt=V(de());var D=V(te()),R=V(de());function ye(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ye(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var vg={value:()=>{}};function tl(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new $r(n)}function $r(e){this._=e}function Sg(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}$r.prototype=tl.prototype={constructor:$r,on:function(e,t){var n=this._,r=Sg(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=Eg(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=el(n[o],e.name,t);else if(t==null)for(o in n)n[o]=el(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $r(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function Eg(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function el(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=vg,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ft=tl;var Hr="http://www.w3.org/1999/xhtml",hi={svg:"http://www.w3.org/2000/svg",xhtml:Hr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function yt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),hi.hasOwnProperty(t)?{space:hi[t],local:e}:e}function _g(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Hr&&t.documentElement.namespaceURI===Hr?t.createElement(e):t.createElementNS(n,e)}}function Cg(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Vr(e){var t=yt(e);return(t.local?Cg:_g)(t)}function Ng(){}function Lt(e){return e==null?Ng:function(){return this.querySelector(e)}}function nl(e){typeof e!="function"&&(e=Lt(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),l,c,d=0;d<s;++d)(l=i[d])&&(c=e.call(l,l.__data__,d,i))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new be(r,this._parents)}function pi(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Tg(){return[]}function Pn(e){return e==null?Tg:function(){return this.querySelectorAll(e)}}function kg(e){return function(){return pi(e.apply(this,arguments))}}function rl(e){typeof e=="function"?e=kg(e):e=Pn(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(r.push(e.call(l,l.__data__,c,s)),o.push(l));return new be(r,o)}function An(e){return function(){return this.matches(e)}}function Wr(e){return function(t){return t.matches(e)}}var Dg=Array.prototype.find;function Ig(e){return function(){return Dg.call(this.children,e)}}function Mg(){return this.firstElementChild}function ol(e){return this.select(e==null?Mg:Ig(typeof e=="function"?e:Wr(e)))}var Og=Array.prototype.filter;function Rg(){return Array.from(this.children)}function Pg(e){return function(){return Og.call(this.children,e)}}function il(e){return this.selectAll(e==null?Rg:Pg(typeof e=="function"?e:Wr(e)))}function sl(e){typeof e!="function"&&(e=An(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new be(r,this._parents)}function Kr(e){return new Array(e.length)}function al(){return new be(this._enter||this._groups.map(Kr),this._parents)}function Fn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Fn.prototype={constructor:Fn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ll(e){return function(){return e}}function Ag(e,t,n,r,o,i){for(var s=0,a,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new Fn(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function Fg(e,t,n,r,o,i,s){var a,l,c=new Map,d=t.length,u=i.length,f=new Array(d),h;for(a=0;a<d;++a)(l=t[a])&&(f[a]=h=s.call(l,l.__data__,a,t)+"",c.has(h)?o[a]=l:c.set(h,l));for(a=0;a<u;++a)h=s.call(e,i[a],a,i)+"",(l=c.get(h))?(r[a]=l,l.__data__=i[a],c.delete(h)):n[a]=new Fn(e,i[a]);for(a=0;a<d;++a)(l=t[a])&&c.get(f[a])===l&&(o[a]=l)}function Lg(e){return e.__data__}function cl(e,t){if(!arguments.length)return Array.from(this,Lg);var n=t?Fg:Ag,r=this._parents,o=this._groups;typeof e!="function"&&(e=ll(e));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var d=r[c],u=o[c],f=u.length,h=zg(e.call(d,d&&d.__data__,c,r)),p=h.length,g=a[c]=new Array(p),v=s[c]=new Array(p),y=l[c]=new Array(f);n(d,u,g,v,y,h,t);for(var w=0,b=0,x,C;w<p;++w)if(x=g[w]){for(w>=b&&(b=w+1);!(C=v[b])&&++b<p;);x._next=C||null}}return s=new be(s,r),s._enter=a,s._exit=l,s}function zg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dl(){return new be(this._exit||this._groups.map(Kr),this._parents)}function ul(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function fl(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var c=n[l],d=r[l],u=c.length,f=a[l]=new Array(u),h,p=0;p<u;++p)(h=c[p]||d[p])&&(f[p]=h);for(;l<o;++l)a[l]=n[l];return new be(a,this._parents)}function hl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function pl(e){e||(e=Bg);function t(u,f){return u&&f?e(u.__data__,f.__data__):!u-!f}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,l=o[i]=new Array(a),c,d=0;d<a;++d)(c=s[d])&&(l[d]=c);l.sort(t)}return new be(o,this._parents).order()}function Bg(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ml(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function gl(){return Array.from(this)}function yl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function bl(){let e=0;for(let t of this)++e;return e}function xl(){return!this.node()}function wl(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function $g(e){return function(){this.removeAttribute(e)}}function Hg(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Vg(e,t){return function(){this.setAttribute(e,t)}}function Wg(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Kg(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function qg(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function vl(e,t){var n=yt(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Hg:$g:typeof t=="function"?n.local?qg:Kg:n.local?Wg:Vg)(n,t))}function qr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ug(e){return function(){this.style.removeProperty(e)}}function Yg(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Gg(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Sl(e,t,n){return arguments.length>1?this.each((t==null?Ug:typeof t=="function"?Gg:Yg)(e,t,n??"")):Ct(this.node(),e)}function Ct(e,t){return e.style.getPropertyValue(t)||qr(e).getComputedStyle(e,null).getPropertyValue(t)}function Xg(e){return function(){delete this[e]}}function Zg(e,t){return function(){this[e]=t}}function jg(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function El(e,t){return arguments.length>1?this.each((t==null?Xg:typeof t=="function"?jg:Zg)(e,t)):this.node()[e]}function _l(e){return e.trim().split(/^|\s+/)}function mi(e){return e.classList||new Cl(e)}function Cl(e){this._node=e,this._names=_l(e.getAttribute("class")||"")}Cl.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Nl(e,t){for(var n=mi(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Tl(e,t){for(var n=mi(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Qg(e){return function(){Nl(this,e)}}function Jg(e){return function(){Tl(this,e)}}function ey(e,t){return function(){(t.apply(this,arguments)?Nl:Tl)(this,e)}}function kl(e,t){var n=_l(e+"");if(arguments.length<2){for(var r=mi(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?ey:t?Qg:Jg)(n,t))}function ty(){this.textContent=""}function ny(e){return function(){this.textContent=e}}function ry(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Dl(e){return arguments.length?this.each(e==null?ty:(typeof e=="function"?ry:ny)(e)):this.node().textContent}function oy(){this.innerHTML=""}function iy(e){return function(){this.innerHTML=e}}function sy(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Il(e){return arguments.length?this.each(e==null?oy:(typeof e=="function"?sy:iy)(e)):this.node().innerHTML}function ay(){this.nextSibling&&this.parentNode.appendChild(this)}function Ml(){return this.each(ay)}function ly(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ol(){return this.each(ly)}function Rl(e){var t=typeof e=="function"?e:Vr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function cy(){return null}function Pl(e,t){var n=typeof e=="function"?e:Vr(e),r=t==null?cy:typeof t=="function"?t:Lt(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function dy(){var e=this.parentNode;e&&e.removeChild(this)}function Al(){return this.each(dy)}function uy(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fy(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Fl(e){return this.select(e?fy:uy)}function Ll(e){return arguments.length?this.property("__data__",e):this.node().__data__}function hy(e){return function(t){e.call(this,t,this.__data__)}}function py(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function my(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function gy(e,t,n){return function(){var r=this.__on,o,i=hy(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function zl(e,t,n){var r=py(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(o=0,d=a[l];o<i;++o)if((s=r[o]).type===d.type&&s.name===d.name)return d.value}return}for(a=t?gy:my,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function Bl(e,t,n){var r=qr(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function yy(e,t){return function(){return Bl(this,e,t)}}function by(e,t){return function(){return Bl(this,e,t.apply(this,arguments))}}function $l(e,t){return this.each((typeof t=="function"?by:yy)(e,t))}function*Hl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var gi=[null];function be(e,t){this._groups=e,this._parents=t}function Vl(){return new be([[document.documentElement]],gi)}function xy(){return this}be.prototype=Vl.prototype={constructor:be,select:nl,selectAll:rl,selectChild:ol,selectChildren:il,filter:sl,data:cl,enter:al,exit:dl,join:ul,merge:fl,selection:xy,order:hl,sort:pl,call:ml,nodes:gl,node:yl,size:bl,empty:xl,each:wl,attr:vl,style:Sl,property:El,classed:kl,text:Dl,html:Il,raise:Ml,lower:Ol,append:Rl,insert:Pl,remove:Al,clone:Fl,datum:Ll,on:zl,dispatch:$l,[Symbol.iterator]:Hl};var bt=Vl;function Ne(e){return typeof e=="string"?new be([[document.querySelector(e)]],[document.documentElement]):new be([[e]],gi)}function Wl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Pe(e,t){if(e=Wl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}var Kl={passive:!1},zt={capture:!0,passive:!1};function Ur(e){e.stopImmediatePropagation()}function Nt(e){e.preventDefault(),e.stopImmediatePropagation()}function Ln(e){var t=e.document.documentElement,n=Ne(e).on("dragstart.drag",Nt,zt);"onselectstart"in t?n.on("selectstart.drag",Nt,zt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function zn(e,t){var n=e.document.documentElement,r=Ne(e).on("dragstart.drag",null);t&&(r.on("click.drag",Nt,zt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Bn=e=>()=>e;function $n(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}$n.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function wy(e){return!e.ctrlKey&&!e.button}function vy(){return this.parentNode}function Sy(e,t){return t??{x:e.x,y:e.y}}function Ey(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yr(){var e=wy,t=vy,n=Sy,r=Ey,o={},i=Ft("start","drag","end"),s=0,a,l,c,d,u=0;function f(x){x.on("mousedown.drag",h).filter(r).on("touchstart.drag",v).on("touchmove.drag",y,Kl).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(x,C){if(!(d||!e.call(this,x,C))){var k=b(this,t.call(this,x,C),x,C,"mouse");k&&(Ne(x.view).on("mousemove.drag",p,zt).on("mouseup.drag",g,zt),Ln(x.view),Ur(x),c=!1,a=x.clientX,l=x.clientY,k("start",x))}}function p(x){if(Nt(x),!c){var C=x.clientX-a,k=x.clientY-l;c=C*C+k*k>u}o.mouse("drag",x)}function g(x){Ne(x.view).on("mousemove.drag mouseup.drag",null),zn(x.view,c),Nt(x),o.mouse("end",x)}function v(x,C){if(e.call(this,x,C)){var k=x.changedTouches,N=t.call(this,x,C),P=k.length,A,F;for(A=0;A<P;++A)(F=b(this,N,x,C,k[A].identifier,k[A]))&&(Ur(x),F("start",x,k[A]))}}function y(x){var C=x.changedTouches,k=C.length,N,P;for(N=0;N<k;++N)(P=o[C[N].identifier])&&(Nt(x),P("drag",x,C[N]))}function w(x){var C=x.changedTouches,k=C.length,N,P;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),N=0;N<k;++N)(P=o[C[N].identifier])&&(Ur(x),P("end",x,C[N]))}function b(x,C,k,N,P,A){var F=i.copy(),B=Pe(A||k,C),L,z,m;if((m=n.call(x,new $n("beforestart",{sourceEvent:k,target:f,identifier:P,active:s,x:B[0],y:B[1],dx:0,dy:0,dispatch:F}),N))!=null)return L=m.x-B[0]||0,z=m.y-B[1]||0,function E(S,T,M){var _=B,I;switch(S){case"start":o[P]=E,I=s++;break;case"end":delete o[P],--s;case"drag":B=Pe(M||T,C),I=s;break}F.call(S,x,new $n(S,{sourceEvent:T,subject:m,target:f,identifier:P,active:I,x:B[0]+L,y:B[1]+z,dx:B[0]-_[0],dy:B[1]-_[1],dispatch:F}),N)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Bn(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:Bn(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Bn(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Bn(!!x),f):r},f.on=function(){var x=i.on.apply(i,arguments);return x===i?f:x},f.clickDistance=function(x){return arguments.length?(u=(x=+x)*x,f):Math.sqrt(u)},f}function Gr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function yi(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Wn(){}var Hn=.7,jr=1/Hn,dn="\\s*([+-]?\\d+)\\s*",Vn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_y=/^#([0-9a-f]{3,8})$/,Cy=new RegExp(`^rgb\\(${dn},${dn},${dn}\\)$`),Ny=new RegExp(`^rgb\\(${lt},${lt},${lt}\\)$`),Ty=new RegExp(`^rgba\\(${dn},${dn},${dn},${Vn}\\)$`),ky=new RegExp(`^rgba\\(${lt},${lt},${lt},${Vn}\\)$`),Dy=new RegExp(`^hsl\\(${Vn},${lt},${lt}\\)$`),Iy=new RegExp(`^hsla\\(${Vn},${lt},${lt},${Vn}\\)$`),ql={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gr(Wn,Tt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ul,formatHex:Ul,formatHex8:My,formatHsl:Oy,formatRgb:Yl,toString:Yl});function Ul(){return this.rgb().formatHex()}function My(){return this.rgb().formatHex8()}function Oy(){return Jl(this).formatHsl()}function Yl(){return this.rgb().formatRgb()}function Tt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=_y.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Gl(t):n===3?new Be(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Xr(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Xr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Cy.exec(e))?new Be(t[1],t[2],t[3],1):(t=Ny.exec(e))?new Be(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ty.exec(e))?Xr(t[1],t[2],t[3],t[4]):(t=ky.exec(e))?Xr(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Dy.exec(e))?jl(t[1],t[2]/100,t[3]/100,1):(t=Iy.exec(e))?jl(t[1],t[2]/100,t[3]/100,t[4]):ql.hasOwnProperty(e)?Gl(ql[e]):e==="transparent"?new Be(NaN,NaN,NaN,0):null}function Gl(e){return new Be(e>>16&255,e>>8&255,e&255,1)}function Xr(e,t,n,r){return r<=0&&(e=t=n=NaN),new Be(e,t,n,r)}function Ry(e){return e instanceof Wn||(e=Tt(e)),e?(e=e.rgb(),new Be(e.r,e.g,e.b,e.opacity)):new Be}function un(e,t,n,r){return arguments.length===1?Ry(e):new Be(e,t,n,r??1)}function Be(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Gr(Be,un,yi(Wn,{brighter(e){return e=e==null?jr:Math.pow(jr,e),new Be(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Hn:Math.pow(Hn,e),new Be(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Be($t(this.r),$t(this.g),$t(this.b),Qr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xl,formatHex:Xl,formatHex8:Py,formatRgb:Zl,toString:Zl}));function Xl(){return`#${Bt(this.r)}${Bt(this.g)}${Bt(this.b)}`}function Py(){return`#${Bt(this.r)}${Bt(this.g)}${Bt(this.b)}${Bt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Zl(){let e=Qr(this.opacity);return`${e===1?"rgb(":"rgba("}${$t(this.r)}, ${$t(this.g)}, ${$t(this.b)}${e===1?")":`, ${e})`}`}function Qr(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $t(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Bt(e){return e=$t(e),(e<16?"0":"")+e.toString(16)}function jl(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new rt(e,t,n,r)}function Jl(e){if(e instanceof rt)return new rt(e.h,e.s,e.l,e.opacity);if(e instanceof Wn||(e=Tt(e)),!e)return new rt;if(e instanceof rt)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new rt(s,a,l,e.opacity)}function ec(e,t,n,r){return arguments.length===1?Jl(e):new rt(e,t,n,r??1)}function rt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Gr(rt,ec,yi(Wn,{brighter(e){return e=e==null?jr:Math.pow(jr,e),new rt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Hn:Math.pow(Hn,e),new rt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Be(bi(e>=240?e-240:e+120,o,r),bi(e,o,r),bi(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new rt(Ql(this.h),Zr(this.s),Zr(this.l),Qr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Qr(this.opacity);return`${e===1?"hsl(":"hsla("}${Ql(this.h)}, ${Zr(this.s)*100}%, ${Zr(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ql(e){return e=(e||0)%360,e<0?e+360:e}function Zr(e){return Math.max(0,Math.min(1,e||0))}function bi(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function xi(e,t,n,r,o){var i=e*e,s=i*e;return((1-3*e+3*i-s)*t+(4-6*i+3*s)*n+(1+3*e+3*i-3*s)*r+s*o)/6}function tc(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],i=e[r+1],s=r>0?e[r-1]:2*o-i,a=r<t-1?e[r+2]:2*i-o;return xi((n-r/t)*t,s,o,i,a)}}function nc(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],i=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return xi((n-r/t)*t,o,i,s,a)}}var wi=e=>()=>e;function Ay(e,t){return function(n){return e+n*t}}function Fy(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function rc(e){return(e=+e)==1?Jr:function(t,n){return n-t?Fy(t,n,e):wi(isNaN(t)?n:t)}}function Jr(e,t){var n=t-e;return n?Ay(e,n):wi(isNaN(e)?t:e)}var eo=function e(t){var n=rc(t);function r(o,i){var s=n((o=un(o)).r,(i=un(i)).r),a=n(o.g,i.g),l=n(o.b,i.b),c=Jr(o.opacity,i.opacity);return function(d){return o.r=s(d),o.g=a(d),o.b=l(d),o.opacity=c(d),o+""}}return r.gamma=e,r}(1);function oc(e){return function(t){var n=t.length,r=new Array(n),o=new Array(n),i=new Array(n),s,a;for(s=0;s<n;++s)a=un(t[s]),r[s]=a.r||0,o[s]=a.g||0,i[s]=a.b||0;return r=e(r),o=e(o),i=e(i),a.opacity=1,function(l){return a.r=r(l),a.g=o(l),a.b=i(l),a+""}}}var Ly=oc(tc),zy=oc(nc);function Xe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Si=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vi=new RegExp(Si.source,"g");function By(e){return function(){return e}}function $y(e){return function(t){return e(t)+""}}function Ei(e,t){var n=Si.lastIndex=vi.lastIndex=0,r,o,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Si.exec(e))&&(o=vi.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:Xe(r,o)})),n=vi.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?$y(l[0].x):By(t):(t=l.length,function(c){for(var d=0,u;d<t;++d)a[(u=l[d]).i]=u.x(c);return a.join("")})}var ic=180/Math.PI,to={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _i(e,t,n,r,o,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*ic,skewX:Math.atan(l)*ic,scaleX:s,scaleY:a}}var no;function sc(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?to:_i(t.a,t.b,t.c,t.d,t.e,t.f)}function ac(e){return e==null?to:(no||(no=document.createElementNS("http://www.w3.org/2000/svg","g")),no.setAttribute("transform",e),(e=no.transform.baseVal.consolidate())?(e=e.matrix,_i(e.a,e.b,e.c,e.d,e.e,e.f)):to)}function lc(e,t,n,r){function o(c){return c.length?c.pop()+" ":""}function i(c,d,u,f,h,p){if(c!==u||d!==f){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:Xe(c,u)},{i:g-2,x:Xe(d,f)})}else(u||f)&&h.push("translate("+u+t+f+n)}function s(c,d,u,f){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),f.push({i:u.push(o(u)+"rotate(",null,r)-2,x:Xe(c,d)})):d&&u.push(o(u)+"rotate("+d+r)}function a(c,d,u,f){c!==d?f.push({i:u.push(o(u)+"skewX(",null,r)-2,x:Xe(c,d)}):d&&u.push(o(u)+"skewX("+d+r)}function l(c,d,u,f,h,p){if(c!==u||d!==f){var g=h.push(o(h)+"scale(",null,",",null,")");p.push({i:g-4,x:Xe(c,u)},{i:g-2,x:Xe(d,f)})}else(u!==1||f!==1)&&h.push(o(h)+"scale("+u+","+f+")")}return function(c,d){var u=[],f=[];return c=e(c),d=e(d),i(c.translateX,c.translateY,d.translateX,d.translateY,u,f),s(c.rotate,d.rotate,u,f),a(c.skewX,d.skewX,u,f),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,u,f),c=d=null,function(h){for(var p=-1,g=f.length,v;++p<g;)u[(v=f[p]).i]=v.x(h);return u.join("")}}}var Ci=lc(sc,"px, ","px)","deg)"),Ni=lc(ac,", ",")",")");var Hy=1e-12;function cc(e){return((e=Math.exp(e))+1/e)/2}function Vy(e){return((e=Math.exp(e))-1/e)/2}function Wy(e){return((e=Math.exp(2*e))-1)/(e+1)}var Ti=function e(t,n,r){function o(i,s){var a=i[0],l=i[1],c=i[2],d=s[0],u=s[1],f=s[2],h=d-a,p=u-l,g=h*h+p*p,v,y;if(g<Hy)y=Math.log(f/c)/t,v=function(N){return[a+N*h,l+N*p,c*Math.exp(t*N*y)]};else{var w=Math.sqrt(g),b=(f*f-c*c+r*g)/(2*c*n*w),x=(f*f-c*c-r*g)/(2*f*n*w),C=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(x*x+1)-x);y=(k-C)/t,v=function(N){var P=N*y,A=cc(C),F=c/(n*w)*(A*Wy(t*P+C)-Vy(C));return[a+F*h,l+F*p,c*A/cc(t*P+C)]}}return v.duration=y*1e3*t/Math.SQRT2,v}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},o}(Math.SQRT2,2,4);var fn=0,qn=0,Kn=0,uc=1e3,ro,Un,oo=0,Ht=0,io=0,Yn=typeof performance=="object"&&performance.now?performance:Date,fc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Xn(){return Ht||(fc(Ky),Ht=Yn.now()+io)}function Ky(){Ht=0}function Gn(){this._call=this._time=this._next=null}Gn.prototype=so.prototype={constructor:Gn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Xn():+n)+(t==null?0:+t),!this._next&&Un!==this&&(Un?Un._next=this:ro=this,Un=this),this._call=e,this._time=n,ki()},stop:function(){this._call&&(this._call=null,this._time=1/0,ki())}};function so(e,t,n){var r=new Gn;return r.restart(e,t,n),r}function hc(){Xn(),++fn;for(var e=ro,t;e;)(t=Ht-e._time)>=0&&e._call.call(void 0,t),e=e._next;--fn}function dc(){Ht=(oo=Yn.now())+io,fn=qn=0;try{hc()}finally{fn=0,Uy(),Ht=0}}function qy(){var e=Yn.now(),t=e-oo;t>uc&&(io-=t,oo=e)}function Uy(){for(var e,t=ro,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ro=n);Un=e,ki(r)}function ki(e){if(!fn){qn&&(qn=clearTimeout(qn));var t=e-Ht;t>24?(e<1/0&&(qn=setTimeout(dc,e-Yn.now()-io)),Kn&&(Kn=clearInterval(Kn))):(Kn||(oo=Yn.now(),Kn=setInterval(qy,uc)),fn=1,fc(dc))}}function ao(e,t,n){var r=new Gn;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Yy=Ft("start","end","cancel","interrupt"),Gy=[],gc=0,pc=1,co=2,lo=3,mc=4,uo=5,Zn=6;function kt(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Xy(e,n,{name:t,index:r,group:o,on:Yy,tween:Gy,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:gc})}function jn(e,t){var n=Ce(e,t);if(n.state>gc)throw new Error("too late; already scheduled");return n}function De(e,t){var n=Ce(e,t);if(n.state>lo)throw new Error("too late; already running");return n}function Ce(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Xy(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=so(i,0,n.time);function i(c){n.state=pc,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var d,u,f,h;if(n.state!==pc)return l();for(d in r)if(h=r[d],h.name===n.name){if(h.state===lo)return ao(s);h.state===mc?(h.state=Zn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[d]):+d<t&&(h.state=Zn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[d])}if(ao(function(){n.state===lo&&(n.state=mc,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=co,n.on.call("start",e,e.__data__,n.index,n.group),n.state===co){for(n.state=lo,o=new Array(f=n.tween.length),d=0,u=-1;d<f;++d)(h=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(o[++u]=h);o.length=u+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=uo,1),u=-1,f=o.length;++u<f;)o[u].call(e,d);n.state===uo&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Zn,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function Vt(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>co&&r.state<uo,r.state=Zn,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function yc(e){return this.each(function(){Vt(this,e)})}function Zy(e,t){var n,r;return function(){var o=De(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function jy(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=De(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=a;break}l===c&&o.push(a)}i.tween=o}}function bc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ce(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Zy:jy)(n,e,t))}function hn(e,t,n){var r=e._id;return e.each(function(){var o=De(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ce(o,r).value[t]}}function fo(e,t){var n;return(typeof t=="number"?Xe:t instanceof Tt?eo:(n=Tt(t))?(t=n,eo):Ei)(e,t)}function Qy(e){return function(){this.removeAttribute(e)}}function Jy(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eb(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function tb(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function nb(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function rb(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function xc(e,t){var n=yt(e),r=n==="transform"?Ni:fo;return this.attrTween(e,typeof t=="function"?(n.local?rb:nb)(n,r,hn(this,"attr."+e,t)):t==null?(n.local?Jy:Qy)(n):(n.local?tb:eb)(n,r,t))}function ob(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ib(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function sb(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&ib(e,i)),n}return o._value=t,o}function ab(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&ob(e,i)),n}return o._value=t,o}function wc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=yt(e);return this.tween(n,(r.local?sb:ab)(r,t))}function lb(e,t){return function(){jn(this,e).delay=+t.apply(this,arguments)}}function cb(e,t){return t=+t,function(){jn(this,e).delay=t}}function vc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?lb:cb)(t,e)):Ce(this.node(),t).delay}function db(e,t){return function(){De(this,e).duration=+t.apply(this,arguments)}}function ub(e,t){return t=+t,function(){De(this,e).duration=t}}function Sc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?db:ub)(t,e)):Ce(this.node(),t).duration}function fb(e,t){if(typeof t!="function")throw new Error;return function(){De(this,e).ease=t}}function Ec(e){var t=this._id;return arguments.length?this.each(fb(t,e)):Ce(this.node(),t).ease}function hb(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;De(this,e).ease=n}}function _c(e){if(typeof e!="function")throw new Error;return this.each(hb(this._id,e))}function Cc(e){typeof e!="function"&&(e=An(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new Ae(r,this._parents,this._name,this._id)}function Nc(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l=t[a],c=n[a],d=l.length,u=s[a]=new Array(d),f,h=0;h<d;++h)(f=l[h]||c[h])&&(u[h]=f);for(;a<r;++a)s[a]=t[a];return new Ae(s,this._parents,this._name,this._id)}function pb(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function mb(e,t,n){var r,o,i=pb(t)?jn:De;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function Tc(e,t){var n=this._id;return arguments.length<2?Ce(this.node(),n).on.on(e):this.each(mb(n,e,t))}function gb(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function kc(){return this.on("end.remove",gb(this._id))}function Dc(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Lt(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],l=a.length,c=i[s]=new Array(l),d,u,f=0;f<l;++f)(d=a[f])&&(u=e.call(d,d.__data__,f,a))&&("__data__"in d&&(u.__data__=d.__data__),c[f]=u,kt(c[f],t,n,f,c,Ce(d,n)));return new Ae(i,this._parents,t,n)}function Ic(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Pn(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l=r[a],c=l.length,d,u=0;u<c;++u)if(d=l[u]){for(var f=e.call(d,d.__data__,u,l),h,p=Ce(d,n),g=0,v=f.length;g<v;++g)(h=f[g])&&kt(h,t,n,g,f,p);i.push(f),s.push(d)}return new Ae(i,s,t,n)}var yb=bt.prototype.constructor;function Mc(){return new yb(this._groups,this._parents)}function bb(e,t){var n,r,o;return function(){var i=Ct(this,e),s=(this.style.removeProperty(e),Ct(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function Oc(e){return function(){this.style.removeProperty(e)}}function xb(e,t,n){var r,o=n+"",i;return function(){var s=Ct(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function wb(e,t,n){var r,o,i;return function(){var s=Ct(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Ct(this,e))),s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a))}}function vb(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var l=De(this,e),c=l.on,d=l.value[i]==null?a||(a=Oc(t)):void 0;(c!==n||o!==d)&&(r=(n=c).copy()).on(s,o=d),l.on=r}}function Rc(e,t,n){var r=(e+="")=="transform"?Ci:fo;return t==null?this.styleTween(e,bb(e,r)).on("end.style."+e,Oc(e)):typeof t=="function"?this.styleTween(e,wb(e,r,hn(this,"style."+e,t))).each(vb(this._id,e)):this.styleTween(e,xb(e,r,t),n).on("end.style."+e,null)}function Sb(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Eb(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&Sb(e,s,n)),r}return i._value=t,i}function Pc(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Eb(e,t,n??""))}function _b(e){return function(){this.textContent=e}}function Cb(e){return function(){var t=e(this);this.textContent=t??""}}function Ac(e){return this.tween("text",typeof e=="function"?Cb(hn(this,"text",e)):_b(e==null?"":e+""))}function Nb(e){return function(t){this.textContent=e.call(this,t)}}function Tb(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Nb(o)),t}return r._value=e,r}function Fc(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Tb(e))}function Lc(){for(var e=this._name,t=this._id,n=ho(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var d=Ce(l,t);kt(l,e,n,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ae(r,this._parents,e,n)}function zc(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--o===0&&i()}};n.each(function(){var c=De(this,r),d=c.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),o===0&&i()})}var kb=0;function Ae(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Bc(e){return bt().transition(e)}function ho(){return++kb}var xt=bt.prototype;Ae.prototype=Bc.prototype={constructor:Ae,select:Dc,selectAll:Ic,selectChild:xt.selectChild,selectChildren:xt.selectChildren,filter:Cc,merge:Nc,selection:Mc,transition:Lc,call:xt.call,nodes:xt.nodes,node:xt.node,size:xt.size,empty:xt.empty,each:xt.each,on:Tc,attr:xc,attrTween:wc,style:Rc,styleTween:Pc,text:Ac,textTween:Fc,remove:kc,tween:bc,delay:vc,duration:Sc,ease:Ec,easeVarying:_c,end:zc,[Symbol.iterator]:xt[Symbol.iterator]};function po(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Db={time:null,delay:0,duration:250,ease:po};function Ib(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function $c(e){var t,n;e instanceof Ae?(t=e._id,e=e._name):(t=ho(),(n=Db).time=Xn(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&kt(l,e,t,c,s,n||Ib(l,t));return new Ae(r,this._parents,e,t)}bt.prototype.interrupt=yc;bt.prototype.transition=$c;var Qn=e=>()=>e;function Di(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function ot(e,t,n){this.k=e,this.x=t,this.y=n}ot.prototype={constructor:ot,scale:function(e){return e===1?this:new ot(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ot(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Wt=new ot(1,0,0);Jn.prototype=ot.prototype;function Jn(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Wt;return e.__zoom}function mo(e){e.stopImmediatePropagation()}function pn(e){e.preventDefault(),e.stopImmediatePropagation()}function Mb(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ob(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Hc(){return this.__zoom||Wt}function Rb(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Pb(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ab(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function go(){var e=Mb,t=Ob,n=Ab,r=Rb,o=Pb,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Ti,c=Ft("start","zoom","end"),d,u,f,h=500,p=150,g=0,v=10;function y(m){m.property("__zoom",Hc).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",F).filter(o).on("touchstart.zoom",B).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(m,E,S,T){var M=m.selection?m.selection():m;M.property("__zoom",Hc),m!==M?C(m,E,S,T):M.interrupt().each(function(){k(this,arguments).event(T).start().zoom(null,typeof E=="function"?E.apply(this,arguments):E).end()})},y.scaleBy=function(m,E,S,T){y.scaleTo(m,function(){var M=this.__zoom.k,_=typeof E=="function"?E.apply(this,arguments):E;return M*_},S,T)},y.scaleTo=function(m,E,S,T){y.transform(m,function(){var M=t.apply(this,arguments),_=this.__zoom,I=S==null?x(M):typeof S=="function"?S.apply(this,arguments):S,$=_.invert(I),H=typeof E=="function"?E.apply(this,arguments):E;return n(b(w(_,H),I,$),M,s)},S,T)},y.translateBy=function(m,E,S,T){y.transform(m,function(){return n(this.__zoom.translate(typeof E=="function"?E.apply(this,arguments):E,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),s)},null,T)},y.translateTo=function(m,E,S,T,M){y.transform(m,function(){var _=t.apply(this,arguments),I=this.__zoom,$=T==null?x(_):typeof T=="function"?T.apply(this,arguments):T;return n(Wt.translate($[0],$[1]).scale(I.k).translate(typeof E=="function"?-E.apply(this,arguments):-E,typeof S=="function"?-S.apply(this,arguments):-S),_,s)},T,M)};function w(m,E){return E=Math.max(i[0],Math.min(i[1],E)),E===m.k?m:new ot(E,m.x,m.y)}function b(m,E,S){var T=E[0]-S[0]*m.k,M=E[1]-S[1]*m.k;return T===m.x&&M===m.y?m:new ot(m.k,T,M)}function x(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function C(m,E,S,T){m.on("start.zoom",function(){k(this,arguments).event(T).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(T).end()}).tween("zoom",function(){var M=this,_=arguments,I=k(M,_).event(T),$=t.apply(M,_),H=S==null?x($):typeof S=="function"?S.apply(M,_):S,K=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),G=M.__zoom,Y=typeof E=="function"?E.apply(M,_):E,X=l(G.invert(H).concat(K/G.k),Y.invert(H).concat(K/Y.k));return function(W){if(W===1)W=Y;else{var j=X(W),re=K/j[2];W=new ot(re,H[0]-j[0]*re,H[1]-j[1]*re)}I.zoom(null,W)}})}function k(m,E,S){return!S&&m.__zooming||new N(m,E)}function N(m,E){this.that=m,this.args=E,this.active=0,this.sourceEvent=null,this.extent=t.apply(m,E),this.taps=0}N.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,E){return this.mouse&&m!=="mouse"&&(this.mouse[1]=E.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=E.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=E.invert(this.touch1[0])),this.that.__zoom=E,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var E=Ne(this.that).datum();c.call(m,this.that,new Di(m,{sourceEvent:this.sourceEvent,target:y,type:m,transform:this.that.__zoom,dispatch:c}),E)}};function P(m,...E){if(!e.apply(this,arguments))return;var S=k(this,E).event(m),T=this.__zoom,M=Math.max(i[0],Math.min(i[1],T.k*Math.pow(2,r.apply(this,arguments)))),_=Pe(m);if(S.wheel)(S.mouse[0][0]!==_[0]||S.mouse[0][1]!==_[1])&&(S.mouse[1]=T.invert(S.mouse[0]=_)),clearTimeout(S.wheel);else{if(T.k===M)return;S.mouse=[_,T.invert(_)],Vt(this),S.start()}pn(m),S.wheel=setTimeout(I,p),S.zoom("mouse",n(b(w(T,M),S.mouse[0],S.mouse[1]),S.extent,s));function I(){S.wheel=null,S.end()}}function A(m,...E){if(f||!e.apply(this,arguments))return;var S=m.currentTarget,T=k(this,E,!0).event(m),M=Ne(m.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",K,!0),_=Pe(m,S),I=m.clientX,$=m.clientY;Ln(m.view),mo(m),T.mouse=[_,this.__zoom.invert(_)],Vt(this),T.start();function H(G){if(pn(G),!T.moved){var Y=G.clientX-I,X=G.clientY-$;T.moved=Y*Y+X*X>g}T.event(G).zoom("mouse",n(b(T.that.__zoom,T.mouse[0]=Pe(G,S),T.mouse[1]),T.extent,s))}function K(G){M.on("mousemove.zoom mouseup.zoom",null),zn(G.view,T.moved),pn(G),T.event(G).end()}}function F(m,...E){if(e.apply(this,arguments)){var S=this.__zoom,T=Pe(m.changedTouches?m.changedTouches[0]:m,this),M=S.invert(T),_=S.k*(m.shiftKey?.5:2),I=n(b(w(S,_),T,M),t.apply(this,E),s);pn(m),a>0?Ne(this).transition().duration(a).call(C,I,T,m):Ne(this).call(y.transform,I,T,m)}}function B(m,...E){if(e.apply(this,arguments)){var S=m.touches,T=S.length,M=k(this,E,m.changedTouches.length===T).event(m),_,I,$,H;for(mo(m),I=0;I<T;++I)$=S[I],H=Pe($,this),H=[H,this.__zoom.invert(H),$.identifier],M.touch0?!M.touch1&&M.touch0[2]!==H[2]&&(M.touch1=H,M.taps=0):(M.touch0=H,_=!0,M.taps=1+!!d);d&&(d=clearTimeout(d)),_&&(M.taps<2&&(u=H[0],d=setTimeout(function(){d=null},h)),Vt(this),M.start())}}function L(m,...E){if(this.__zooming){var S=k(this,E).event(m),T=m.changedTouches,M=T.length,_,I,$,H;for(pn(m),_=0;_<M;++_)I=T[_],$=Pe(I,this),S.touch0&&S.touch0[2]===I.identifier?S.touch0[0]=$:S.touch1&&S.touch1[2]===I.identifier&&(S.touch1[0]=$);if(I=S.that.__zoom,S.touch1){var K=S.touch0[0],G=S.touch0[1],Y=S.touch1[0],X=S.touch1[1],W=(W=Y[0]-K[0])*W+(W=Y[1]-K[1])*W,j=(j=X[0]-G[0])*j+(j=X[1]-G[1])*j;I=w(I,Math.sqrt(W/j)),$=[(K[0]+Y[0])/2,(K[1]+Y[1])/2],H=[(G[0]+X[0])/2,(G[1]+X[1])/2]}else if(S.touch0)$=S.touch0[0],H=S.touch0[1];else return;S.zoom("touch",n(b(I,$,H),S.extent,s))}}function z(m,...E){if(this.__zooming){var S=k(this,E).event(m),T=m.changedTouches,M=T.length,_,I;for(mo(m),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),_=0;_<M;++_)I=T[_],S.touch0&&S.touch0[2]===I.identifier?delete S.touch0:S.touch1&&S.touch1[2]===I.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(I=Pe(I,this),Math.hypot(u[0]-I[0],u[1]-I[1])<v)){var $=Ne(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return y.wheelDelta=function(m){return arguments.length?(r=typeof m=="function"?m:Qn(+m),y):r},y.filter=function(m){return arguments.length?(e=typeof m=="function"?m:Qn(!!m),y):e},y.touchable=function(m){return arguments.length?(o=typeof m=="function"?m:Qn(!!m),y):o},y.extent=function(m){return arguments.length?(t=typeof m=="function"?m:Qn([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),y):t},y.scaleExtent=function(m){return arguments.length?(i[0]=+m[0],i[1]=+m[1],y):[i[0],i[1]]},y.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],y):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},y.constrain=function(m){return arguments.length?(n=m,y):n},y.duration=function(m){return arguments.length?(a=+m,y):a},y.interpolate=function(m){return arguments.length?(l=m,y):l},y.on=function(){var m=c.on.apply(c,arguments);return m===c?y:m},y.clickDistance=function(m){return arguments.length?(g=(m=+m)*m,y):Math.sqrt(g)},y.tapDistance=function(m){return arguments.length?(v=+m,y):v},y}var Ve={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},bn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Pi=["Enter"," ","Escape"],dt;(function(e){e.Strict="strict",e.Loose="loose"})(dt||(dt={}));var wt;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(wt||(wt={}));var Kt;(function(e){e.Partial="partial",e.Full="full"})(Kt||(Kt={}));var Ai={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null},ut;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ut||(ut={}));var ft;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ft||(ft={}));var U;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(U||(U={}));var Vc={[U.Left]:U.Right,[U.Right]:U.Left,[U.Top]:U.Bottom,[U.Bottom]:U.Top};function Fi(e){return e===null?null:e?"valid":"invalid"}var Li=e=>"id"in e&&"source"in e&&"target"in e,ed=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),zi=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e);var nr=(e,t=[0,0])=>{let{width:n,height:r}=ht(e),o=e.origin??t,i=n*o[0],s=r*o[1];return{x:e.position.x-i,y:e.position.y-s}},rr=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};let n=e.reduce((r,o)=>{let i=typeof o=="string",s=!t.nodeLookup&&!i?o:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(o):zi(o)?o:t.nodeLookup.get(o.id));let a=s?xo(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return So(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Eo(n)},xn=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){let o=xo(r);n=So(n,o)}}),Eo(n)},Bi=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1)=>{let a={...vn(t,[n,r,o]),width:t.width/o,height:t.height/o},l=[];for(let c of e.values()){let{measured:d,selectable:u=!0,hidden:f=!1}=c;if(s&&!u||f)continue;let h=d.width??c.width??c.initialWidth??null,p=d.height??c.height??c.initialHeight??null,g=wn(a,Yt(c)),v=(h??0)*(p??0),y=i&&g>0;(!c.internals.handleBounds||y||g>=v||c.dragging)&&l.push(c)}return l},td=(e,t)=>{let n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function wo(e,t){let n=new Map,r=t?.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&(t?.includeHiddenNodes||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function vo({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i},s){if(e.size===0)return Promise.resolve(!1);let a=xn(e),l=Gt(a,t,n,s?.minZoom??o,s?.maxZoom??i,s?.padding??.1);return await r.setViewport(l,{duration:s?.duration}),Promise.resolve(!0)}function $i({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){let s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},d=s.origin??r,u=o;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",Ve.error005());else{let h=a.measured.width,p=a.measured.height;h&&p&&(u=[[l,c],[l+h,c+p]])}else a&&yn(s.extent)&&(u=[[s.extent[0][0]+l,s.extent[0][1]+c],[s.extent[1][0]+l,s.extent[1][1]+c]]);let f=yn(u)?qt(t,u,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",Ve.error015()),{position:{x:f.x-l+(s.measured.width??0)*d[0],y:f.y-c+(s.measured.height??0)*d[1]},positionAbsolute:f}}async function nd({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){let i=new Set(e.map(f=>f.id)),s=[];for(let f of n){if(f.deletable===!1)continue;let h=i.has(f.id),p=!h&&f.parentId&&s.find(g=>g.id===f.parentId);(h||p)&&s.push(f)}let a=new Set(t.map(f=>f.id)),l=r.filter(f=>f.deletable!==!1),d=td(s,l);for(let f of l)a.has(f.id)&&!d.find(p=>p.id===f.id)&&d.push(f);if(!o)return{edges:d,nodes:s};let u=await o({nodes:s,edges:d});return typeof u=="boolean"?u?{edges:d,nodes:s}:{edges:[],nodes:[]}:u}var gn=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),qt=(e={x:0,y:0},t,n)=>({x:gn(e.x,t[0][0],t[1][0]-(n?.width??0)),y:gn(e.y,t[0][1],t[1][1]-(n?.height??0))});function rd(e,t,n){let{width:r,height:o}=ht(n),{x:i,y:s}=n.internals.positionAbsolute;return qt(e,[[i,s],[i+r,s+o]],t)}var Wc=(e,t,n)=>e<t?gn(Math.abs(e-t),1,t)/t:e>n?-gn(Math.abs(e-n),1,t)/t:0,od=(e,t,n=15,r=40)=>{let o=Wc(e.x,r,t.width-r)*n,i=Wc(e.y,r,t.height-r)*n;return[o,i]},So=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Ri=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Eo=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Yt=(e,t=[0,0])=>{let{x:n,y:r}=zi(e)?e.internals.positionAbsolute:nr(e,t);return{x:n,y:r,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},xo=(e,t=[0,0])=>{let{x:n,y:r}=zi(e)?e.internals.positionAbsolute:nr(e,t);return{x:n,y:r,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:r+(e.measured?.height??e.height??e.initialHeight??0)}},Hi=(e,t)=>Eo(So(Ri(e),Ri(t))),wn=(e,t)=>{let n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Vi=e=>Ze(e.width)&&Ze(e.height)&&Ze(e.x)&&Ze(e.y),Ze=e=>!isNaN(e)&&isFinite(e),Wi=(e,t)=>{},or=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),vn=({x:e,y:t},[n,r,o],i=!1,s=[1,1])=>{let a={x:(e-n)/o,y:(t-r)/o};return i?or(a,s):a},Ki=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),Gt=(e,t,n,r,o,i)=>{let s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(s,a),c=gn(l,r,o),d=e.x+e.width/2,u=e.y+e.height/2,f=t/2-d*c,h=n/2-u*c;return{x:f,y:h,zoom:c}},ir=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function yn(e){return e!==void 0&&e!=="parent"}function ht(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function qi(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Ui(e,t={width:0,height:0},n,r,o){let i={...e},s=r.get(n);if(s){let a=s.origin||o;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function Yi(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function er(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){let{x:i,y:s}=ct(e),a=vn({x:i-(o?.left??0),y:s-(o?.top??0)},r),{x:l,y:c}=n?or(a,t):a;return{xSnapped:l,ySnapped:c,...a}}var sr=e=>({width:e.offsetWidth,height:e.offsetHeight}),Gi=e=>e?.getRootNode?.()||window?.document,Fb=["INPUT","SELECT","TEXTAREA"];function _o(e){let t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Fb.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}var Xi=e=>"clientX"in e,ct=(e,t)=>{let n=Xi(e),r=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:o-(t?.top??0)}},Kc=(e,t,n,r,o)=>{let i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{let a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:o,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...sr(s)}})};function Co({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){let l=e*.125+o*.375+s*.375+n*.125,c=t*.125+i*.375+a*.375+r*.125,d=Math.abs(l-e),u=Math.abs(c-t);return[l,c,d,u]}function yo(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function qc({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case U.Left:return[t-yo(t-r,i),n];case U.Right:return[t+yo(r-t,i),n];case U.Top:return[t,n-yo(n-o,i)];case U.Bottom:return[t,n+yo(o-n,i)]}}function No({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:o,targetPosition:i=U.Top,curvature:s=.25}){let[a,l]=qc({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[c,d]=qc({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[u,f,h,p]=Co({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${r},${o}`,u,f,h,p]}function Zi({sourceX:e,sourceY:t,targetX:n,targetY:r}){let o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function id({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;let i=n||t.selected||e.selected,s=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(i?s:0)}function sd({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){let i=So(xo(e),xo(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);let s={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return wn(s,Eo(i))>0}var Lb=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,zb=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),ar=(e,t)=>{if(!e.source||!e.target)return Wi("006",Ve.error006()),t;let n;return Li(e)?n={...e}:n={...e,id:Lb(e)},zb(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function To({sourceX:e,sourceY:t,targetX:n,targetY:r}){let[o,i,s,a]=Zi({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}var Uc={[U.Left]:{x:-1,y:0},[U.Right]:{x:1,y:0},[U.Top]:{x:0,y:-1},[U.Bottom]:{x:0,y:1}},Bb=({source:e,sourcePosition:t=U.Bottom,target:n})=>t===U.Left||t===U.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Yc=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function $b({source:e,sourcePosition:t=U.Bottom,target:n,targetPosition:r=U.Top,center:o,offset:i}){let s=Uc[t],a=Uc[r],l={x:e.x+s.x*i,y:e.y+s.y*i},c={x:n.x+a.x*i,y:n.y+a.y*i},d=Bb({source:l,sourcePosition:t,target:c}),u=d.x!==0?"x":"y",f=d[u],h=[],p,g,v={x:0,y:0},y={x:0,y:0},[w,b,x,C]=Zi({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[u]*a[u]===-1){p=o.x??w,g=o.y??b;let N=[{x:p,y:l.y},{x:p,y:c.y}],P=[{x:l.x,y:g},{x:c.x,y:g}];s[u]===f?h=u==="x"?N:P:h=u==="x"?P:N}else{let N=[{x:l.x,y:c.y}],P=[{x:c.x,y:l.y}];if(u==="x"?h=s.x===f?P:N:h=s.y===f?N:P,t===r){let z=Math.abs(e[u]-n[u]);if(z<=i){let m=Math.min(i-1,i-z);s[u]===f?v[u]=(l[u]>e[u]?-1:1)*m:y[u]=(c[u]>n[u]?-1:1)*m}}if(t!==r){let z=u==="x"?"y":"x",m=s[u]===a[z],E=l[z]>c[z],S=l[z]<c[z];(s[u]===1&&(!m&&E||m&&S)||s[u]!==1&&(!m&&S||m&&E))&&(h=u==="x"?N:P)}let A={x:l.x+v.x,y:l.y+v.y},F={x:c.x+y.x,y:c.y+y.y},B=Math.max(Math.abs(A.x-h[0].x),Math.abs(F.x-h[0].x)),L=Math.max(Math.abs(A.y-h[0].y),Math.abs(F.y-h[0].y));B>=L?(p=(A.x+F.x)/2,g=h[0].y):(p=h[0].x,g=(A.y+F.y)/2)}return[[e,{x:l.x+v.x,y:l.y+v.y},...h,{x:c.x+y.x,y:c.y+y.y},n],p,g,x,C]}function Hb(e,t,n,r){let o=Math.min(Yc(e,t)/2,Yc(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){let c=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${i+o*c},${s}Q ${i},${s} ${i},${s+o*d}`}let a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+o*l}Q ${i},${s} ${i+o*a},${s}`}function lr({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:o,targetPosition:i=U.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20}){let[d,u,f,h,p]=$b({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:l},offset:c});return[d.reduce((v,y,w)=>{let b="";return w>0&&w<d.length-1?b=Hb(d[w-1],y,d[w+1],s):b=`${w===0?"M":"L"}${y.x} ${y.y}`,v+=b,v},""),u,f,h,p]}function Gc(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function ad(e){let{sourceNode:t,targetNode:n}=e;if(!Gc(t)||!Gc(n))return null;let r=t.internals.handleBounds||Xc(t.handles),o=n.internals.handleBounds||Xc(n.handles),i=Zc(r?.source??[],e.sourceHandle),s=Zc(e.connectionMode===dt.Strict?o?.target??[]:(o?.target??[]).concat(o?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",Ve.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;let a=i?.position||U.Bottom,l=s?.position||U.Top,c=tr(t,i,a),d=tr(n,s,l);return{sourceX:c.x,sourceY:c.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function Xc(e){if(!e)return null;let t=[],n=[];for(let r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function tr(e,t,n=U.Left,r=!1){let o=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??ht(e);if(r)return{x:o+s/2,y:i+a/2};switch(t?.position??n){case U.Top:return{x:o+s/2,y:i};case U.Right:return{x:o+s,y:i+a/2};case U.Bottom:return{x:o+s/2,y:i+a};case U.Left:return{x:o,y:i+a/2}}}function Zc(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function ko(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function ld(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){let i=new Set;return e.reduce((s,a)=>([a.markerStart||r,a.markerEnd||o].forEach(l=>{if(l&&typeof l=="object"){let c=ko(l,t);i.has(c)||(s.push({id:c,color:l.color||n,...l}),i.add(c))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}var ji={nodeOrigin:[0,0],nodeExtent:bn,elevateNodesOnSelect:!0,defaults:{}},Vb={...ji,checkEquality:!0};function Qi(e,t){let n={...e};for(let r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function cd(e,t,n){let r=Qi(ji,n);for(let o of e.values())if(o.parentId)Ji(o,e,t,r);else{let i=nr(o,r.nodeOrigin),s=yn(o.extent)?o.extent:r.nodeExtent,a=qt(i,s,ht(o));o.internals.positionAbsolute=a}}function Do(e,t,n,r){let o=Qi(Vb,r),i=new Map(t),s=o?.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(let a of e){let l=i.get(a.id);if(o.checkEquality&&a===l?.internals.userNode)t.set(a.id,l);else{let c=nr(a,o.nodeOrigin),d=yn(a.extent)?a.extent:o.nodeExtent,u=qt(c,d,ht(a));l={...o.defaults,...a,measured:{width:a.measured?.width,height:a.measured?.height},internals:{positionAbsolute:u,handleBounds:a.measured?l?.internals.handleBounds:void 0,z:dd(a,s),userNode:a}},t.set(a.id,l)}a.parentId&&Ji(l,t,n,r)}}function Wb(e,t){if(!e.parentId)return;let n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Ji(e,t,n,r){let{elevateNodesOnSelect:o,nodeOrigin:i,nodeExtent:s}=Qi(ji,r),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Wb(e,n);let c=o?1e3:0,{x:d,y:u,z:f}=Kb(e,l,i,s,c),{positionAbsolute:h}=e.internals,p=d!==h.x||u!==h.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:d,y:u}:h,z:f}})}function dd(e,t){return(Ze(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Kb(e,t,n,r,o){let{x:i,y:s}=t.internals.positionAbsolute,a=ht(e),l=nr(e,n),c=yn(e.extent)?qt(l,e.extent,a):l,d=qt({x:i+c.x,y:s+c.y},r,a);e.extent==="parent"&&(d=rd(d,a,t));let u=dd(e,o),f=t.internals.z??0;return{x:d.x,y:d.y,z:f>u?f:u}}function Io(e,t,n,r=[0,0]){let o=[],i=new Map;for(let s of e){let a=t.get(s.parentId);if(!a)continue;let l=i.get(s.parentId)?.expandedRect??Yt(a),c=Hi(l,s.rect);i.set(s.parentId,{expandedRect:c,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},l)=>{let c=a.internals.positionAbsolute,d=ht(a),u=a.origin??r,f=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,h=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,p=Math.max(d.width,Math.round(s.width)),g=Math.max(d.height,Math.round(s.height)),v=(p-d.width)*u[0],y=(g-d.height)*u[1];(f>0||h>0||v||y)&&(o.push({id:l,type:"position",position:{x:a.position.x-f+v,y:a.position.y-h+y}}),n.get(l)?.forEach(w=>{e.some(b=>b.id===w.id)||o.push({id:w.id,type:"position",position:{x:w.position.x+f,y:w.position.y+h}})})),(d.width<s.width||d.height<s.height||f||h)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(f?u[0]*f-v:0),height:g+(h?u[1]*h-y:0)}})}),o}function ud(e,t,n,r,o,i){let s=r?.querySelector(".xyflow__viewport"),a=!1;if(!s)return{changes:[],updatedInternals:a};let l=[],c=window.getComputedStyle(s),{m22:d}=new window.DOMMatrixReadOnly(c.transform),u=[];for(let f of e.values()){let h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}let p=sr(f.nodeElement),g=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(g||!h.internals.handleBounds||f.force))){let y=f.nodeElement.getBoundingClientRect(),w=yn(h.extent)?h.extent:i,{positionAbsolute:b}=h.internals;h.parentId&&h.extent==="parent"?b=rd(b,p,t.get(h.parentId)):w&&(b=qt(b,w,p));let x={...h,measured:p,internals:{...h.internals,positionAbsolute:b,handleBounds:{source:Kc("source",f.nodeElement,y,d,h.id),target:Kc("target",f.nodeElement,y,d,h.id)}}};t.set(h.id,x),h.parentId&&Ji(x,t,n,{nodeOrigin:o}),a=!0,g&&(l.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&u.push({id:h.id,parentId:h.parentId,rect:Yt(x,o)}))}}if(u.length>0){let f=Io(u,t,n,o);l.push(...f)}return{changes:l,updatedInternals:a}}async function fd({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);let s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function jc(e,t,n,r,o,i){let s=o,a=r.get(s)||new Map;r.set(s,a.set(n,t)),s=`${o}-${e}`;let l=r.get(s)||new Map;if(r.set(s,l.set(n,t)),i){s=`${o}-${e}-${i}`;let c=r.get(s)||new Map;r.set(s,c.set(n,t))}}function es(e,t,n){e.clear(),t.clear();for(let r of n){let{source:o,target:i,sourceHandle:s=null,targetHandle:a=null}=r,l={edgeId:r.id,source:o,target:i,sourceHandle:s,targetHandle:a},c=`${o}-${s}--${i}-${a}`,d=`${i}-${a}--${o}-${s}`;jc("source",l,d,e,o,s),jc("target",l,c,e,i,a),t.set(r.id,r)}}function hd(e,t){if(!e.parentId)return!1;let n=t.get(e.parentId);return n?n.selected?!0:hd(n,t):!1}function Qc(e,t,n){let r=e;do{if(r?.matches?.(t))return!0;if(r===n)return!1;r=r?.parentElement}while(r);return!1}function qb(e,t,n,r){let o=new Map;for(let[i,s]of e)if((s.selected||s.id===r)&&(!s.parentId||!hd(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){let a=e.get(i);a&&o.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function Ii({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){let o=[];for(let[s,a]of t){let l=n.get(s)?.internals.userNode;l&&o.push({...l,position:a.position,dragging:r})}if(!e)return[o[0],o];let i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:r}:o[0],o]}function pd({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},s=0,a=new Map,l=!1,c={x:0,y:0},d=null,u=!1,f=null,h=!1;function p({noDragClassName:v,handleSelector:y,domNode:w,isSelectable:b,nodeId:x,nodeClickDistance:C=0}){f=Ne(w);function k({x:F,y:B},L){let{nodeLookup:z,nodeExtent:m,snapGrid:E,snapToGrid:S,nodeOrigin:T,onNodeDrag:M,onSelectionDrag:_,onError:I,updateNodePositions:$}=t();i={x:F,y:B};let H=!1,K={x:0,y:0,x2:0,y2:0};if(a.size>1&&m){let G=xn(a);K=Ri(G)}for(let[G,Y]of a){if(!z.has(G))continue;let X={x:F-Y.distance.x,y:B-Y.distance.y};S&&(X=or(X,E));let W=[[m[0][0],m[0][1]],[m[1][0],m[1][1]]];if(a.size>1&&m&&!Y.extent){let{positionAbsolute:fe}=Y.internals,ce=fe.x-K.x+m[0][0],Q=fe.x+Y.measured.width-K.x2+m[1][0],ae=fe.y-K.y+m[0][1],ge=fe.y+Y.measured.height-K.y2+m[1][1];W=[[ce,ae],[Q,ge]]}let{position:j,positionAbsolute:re}=$i({nodeId:G,nextPosition:X,nodeLookup:z,nodeExtent:W,nodeOrigin:T,onError:I});H=H||Y.position.x!==j.x||Y.position.y!==j.y,Y.position=j,Y.internals.positionAbsolute=re}if(H&&($(a,!0),L&&(r||M||!x&&_))){let[G,Y]=Ii({nodeId:x,dragItems:a,nodeLookup:z});r?.(L,a,G,Y),M?.(L,G,Y),x||_?.(L,Y)}}async function N(){if(!d)return;let{transform:F,panBy:B,autoPanSpeed:L,autoPanOnNodeDrag:z}=t();if(!z){l=!1,cancelAnimationFrame(s);return}let[m,E]=od(c,d,L);(m!==0||E!==0)&&(i.x=(i.x??0)-m/F[2],i.y=(i.y??0)-E/F[2],await B({x:m,y:E})&&k(i,null)),s=requestAnimationFrame(N)}function P(F){let{nodeLookup:B,multiSelectionActive:L,nodesDraggable:z,transform:m,snapGrid:E,snapToGrid:S,selectNodesOnDrag:T,onNodeDragStart:M,onSelectionDragStart:_,unselectNodesAndEdges:I}=t();u=!0,(!T||!b)&&!L&&x&&(B.get(x)?.selected||I()),b&&T&&x&&e?.(x);let $=er(F.sourceEvent,{transform:m,snapGrid:E,snapToGrid:S,containerBounds:d});if(i=$,a=qb(B,z,$,x),a.size>0&&(n||M||!x&&_)){let[H,K]=Ii({nodeId:x,dragItems:a,nodeLookup:B});n?.(F.sourceEvent,a,H,K),M?.(F.sourceEvent,H,K),x||_?.(F.sourceEvent,K)}}let A=Yr().clickDistance(C).on("start",F=>{let{domNode:B,nodeDragThreshold:L,transform:z,snapGrid:m,snapToGrid:E}=t();d=B?.getBoundingClientRect()||null,h=!1,L===0&&P(F),i=er(F.sourceEvent,{transform:z,snapGrid:m,snapToGrid:E,containerBounds:d}),c=ct(F.sourceEvent,d)}).on("drag",F=>{let{autoPanOnNodeDrag:B,transform:L,snapGrid:z,snapToGrid:m,nodeDragThreshold:E,nodeLookup:S}=t(),T=er(F.sourceEvent,{transform:L,snapGrid:z,snapToGrid:m,containerBounds:d});if((F.sourceEvent.type==="touchmove"&&F.sourceEvent.touches.length>1||x&&!S.has(x))&&(h=!0),!h){if(!l&&B&&u&&(l=!0,N()),!u){let M=T.xSnapped-(i.x??0),_=T.ySnapped-(i.y??0);Math.sqrt(M*M+_*_)>E&&P(F)}(i.x!==T.xSnapped||i.y!==T.ySnapped)&&a&&u&&(c=ct(F.sourceEvent,d),k(T,F.sourceEvent))}}).on("end",F=>{if(!(!u||h)&&(l=!1,u=!1,cancelAnimationFrame(s),a.size>0)){let{nodeLookup:B,updateNodePositions:L,onNodeDragStop:z,onSelectionDragStop:m}=t();if(L(a,!1),o||z||!x&&m){let[E,S]=Ii({nodeId:x,dragItems:a,nodeLookup:B,dragging:!1});o?.(F.sourceEvent,a,E,S),z?.(F.sourceEvent,E,S),x||m?.(F.sourceEvent,S)}}}).filter(F=>{let B=F.target;return!F.button&&(!v||!Qc(B,`.${v}`,w))&&(!y||Qc(B,y,w))});f.call(A)}function g(){f?.on(".drag",null)}return{update:p,destroy:g}}function Ub(e,t,n){let r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(let i of t.values())wn(o,Yt(i))>0&&r.push(i);return r}var Yb=250;function Gb(e,t,n,r){let o=[],i=1/0,s=Ub(e,n,t+Yb);for(let a of s){let l=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(let c of l){if(r.nodeId===c.nodeId&&r.type===c.type&&r.id===c.id)continue;let{x:d,y:u}=tr(a,c,c.position,!0),f=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(u-e.y,2));f>t||(f<i?(o=[{...c,x:d,y:u}],i=f):f===i&&o.push({...c,x:d,y:u}))}}if(!o.length)return null;if(o.length>1){let a=r.type==="source"?"target":"source";return o.find(l=>l.type===a)??o[0]}return o[0]}function md(e,t,n,r,o,i=!1){let s=r.get(e);if(!s)return null;let a=o==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],l=(n?a?.find(c=>c.id===n):a?.[0])??null;return l&&i?{...l,...tr(s,l,l.position,!0)}:l}function gd(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Xb(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}var yd=()=>!0;function Zb(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:d,flowId:u,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:g,onConnectEnd:v,isValidConnection:y=yd,onReconnectEnd:w,updateConnection:b,getTransform:x,getFromHandle:C,autoPanSpeed:k}){let N=Gi(e.target),P=0,A,{x:F,y:B}=ct(e),L=N?.elementFromPoint(F,B),z=gd(i,L),m=a?.getBoundingClientRect();if(!m||!z)return;let E=md(o,z,r,l,t);if(!E)return;let S=ct(e,m),T=!1,M=null,_=!1,I=null;function $(){if(!d||!m)return;let[re,fe]=od(S,m,k);f({x:re,y:fe}),P=requestAnimationFrame($)}let H={...E,nodeId:o,type:z,position:E.position},K=l.get(o),Y={inProgress:!0,isValid:null,from:tr(K,H,U.Left,!0),fromHandle:H,fromPosition:H.position,fromNode:K,to:S,toHandle:null,toPosition:Vc[H.position],toNode:null};b(Y);let X=Y;p?.(e,{nodeId:o,handleId:r,handleType:z});function W(re){if(!C()||!H){j(re);return}let fe=x();S=ct(re,m),A=Gb(vn(S,fe,!1,[1,1]),n,l,H),T||($(),T=!0);let ce=bd(re,{handle:A,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:s?"target":"source",isValidConnection:y,doc:N,lib:c,flowId:u,nodeLookup:l});I=ce.handleDomNode,M=ce.connection,_=Xb(!!A,ce.isValid);let Q={...X,isValid:_,to:A&&_?Ki({x:A.x,y:A.y},fe):S,toHandle:ce.toHandle,toPosition:_&&ce.toHandle?ce.toHandle.position:Vc[H.position],toNode:ce.toHandle?l.get(ce.toHandle.nodeId):null};_&&A&&X.toHandle&&Q.toHandle&&X.toHandle.type===Q.toHandle.type&&X.toHandle.nodeId===Q.toHandle.nodeId&&X.toHandle.id===Q.toHandle.id&&X.to.x===Q.to.x&&X.to.y===Q.to.y||(b(Q),X=Q)}function j(re){(A||I)&&M&&_&&g?.(M);let{inProgress:fe,...ce}=X,Q={...ce,toPosition:X.toHandle?X.toPosition:null};v?.(re,Q),i&&w?.(re,Q),h(),cancelAnimationFrame(P),T=!1,_=!1,M=null,I=null,N.removeEventListener("mousemove",W),N.removeEventListener("mouseup",j),N.removeEventListener("touchmove",W),N.removeEventListener("touchend",j)}N.addEventListener("mousemove",W),N.addEventListener("mouseup",j),N.addEventListener("touchmove",W),N.addEventListener("touchend",j)}function bd(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:c=yd,nodeLookup:d}){let u=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:h,y:p}=ct(e),g=s.elementFromPoint(h,p),v=g?.classList.contains(`${a}-flow__handle`)?g:f,y={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){let w=gd(void 0,v),b=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),C=v.classList.contains("connectable"),k=v.classList.contains("connectableend");if(!b||!w)return y;let N={source:u?b:r,sourceHandle:u?x:o,target:u?r:b,targetHandle:u?o:x};y.connection=N;let A=C&&k&&(n===dt.Strict?u&&w==="source"||!u&&w==="target":b!==r||x!==o);y.isValid=A&&c(N),y.toHandle=md(b,w,x,d,n,!1)}return y}var Mo={onPointerDown:Zb,isValid:bd};function xd({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){let o=Ne(e);function i({translateExtent:a,width:l,height:c,zoomStep:d=10,pannable:u=!0,zoomable:f=!0,inversePan:h=!1}){let p=b=>{let x=n();if(b.sourceEvent.type!=="wheel"||!t)return;let C=-b.sourceEvent.deltaY*(b.sourceEvent.deltaMode===1?.05:b.sourceEvent.deltaMode?1:.002)*d,k=x[2]*Math.pow(2,C);t.scaleTo(k)},g=[0,0],v=b=>{(b.sourceEvent.type==="mousedown"||b.sourceEvent.type==="touchstart")&&(g=[b.sourceEvent.clientX??b.sourceEvent.touches[0].clientX,b.sourceEvent.clientY??b.sourceEvent.touches[0].clientY])},y=b=>{let x=n();if(b.sourceEvent.type!=="mousemove"&&b.sourceEvent.type!=="touchmove"||!t)return;let C=[b.sourceEvent.clientX??b.sourceEvent.touches[0].clientX,b.sourceEvent.clientY??b.sourceEvent.touches[0].clientY],k=[C[0]-g[0],C[1]-g[1]];g=C;let N=r()*Math.max(x[2],Math.log(x[2]))*(h?-1:1),P={x:x[0]-k[0]*N,y:x[1]-k[1]*N},A=[[0,0],[l,c]];t.setViewportConstrained({x:P.x,y:P.y,zoom:x[2]},A,a)},w=go().on("start",v).on("zoom",u?y:null).on("zoom.wheel",f?p:null);o.call(w,{})}function s(){o.on("zoom",null)}return{update:i,destroy:s,pointer:Pe}}var jb=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Oo=e=>({x:e.x,y:e.y,zoom:e.k}),Mi=({x:e,y:t,zoom:n})=>Wt.translate(e,t).scale(n),mn=(e,t)=>e.target.closest(`.${t}`),wd=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Oi=(e,t=0,n=()=>{})=>{let r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},vd=e=>{let t=e.ctrlKey&&ir()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Qb({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return d=>{if(mn(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();let u=n.property("__zoom").k||1;if(d.ctrlKey&&s){let v=Pe(d),y=vd(d),w=u*Math.pow(2,y);r.scaleTo(n,w,v,d);return}let f=d.deltaMode===1?20:1,h=o===wt.Vertical?0:d.deltaX*f,p=o===wt.Horizontal?0:d.deltaY*f;!ir()&&d.shiftKey&&o!==wt.Vertical&&(h=d.deltaY*f,p=0),r.translateBy(n,-(h/u)*i,-(p/u)*i,{internal:!0});let g=Oo(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a?.(d,g)),e.isPanScrolling&&(l?.(d,g),e.panScrollTimeout=setTimeout(()=>{c?.(d,g),e.isPanScrolling=!1},150))}}function Jb({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){if(!t&&r.type==="wheel"&&!r.ctrlKey||mn(r,e))return null;r.preventDefault(),n.call(this,r,o)}}function ex({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{if(r.sourceEvent?.internal)return;let o=Oo(r.transform);e.mouseButton=r.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=o,r.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(r.sourceEvent,o)}}function tx({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{e.usedRightMouseButton=!!(n&&wd(t,e.mouseButton??0)),i.sourceEvent?.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!i.sourceEvent?.internal&&o?.(i.sourceEvent,Oo(i.transform))}}function nx({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&wd(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&jb(e.prevViewport,s.transform))){let a=Oo(s.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o?.(s.sourceEvent,a)},n?150:0)}}}function rx({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:c}){return d=>{let u=e||t,f=n&&d.ctrlKey;if(d.button===1&&d.type==="mousedown"&&(mn(d,`${c}-flow__node`)||mn(d,`${c}-flow__edge`)))return!0;if(!r&&!u&&!o&&!i&&!n||s||mn(d,a)&&d.type==="wheel"||mn(d,l)&&(d.type!=="wheel"||o&&d.type==="wheel"&&!e)||!n&&d.ctrlKey&&d.type==="wheel")return!1;if(!n&&d.type==="touchstart"&&d.touches?.length>1)return d.preventDefault(),!1;if(!u&&!o&&!f&&d.type==="wheel"||!r&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(r)&&!r.includes(d.button)&&d.type==="mousedown")return!1;let h=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||d.type==="wheel")&&h}}function Sd({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:i,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:c}){let d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),f=go().clickDistance(!Ze(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=Ne(e).call(f);b({x:i.x,y:i.y,zoom:gn(i.zoom,t,n)},[[0,0],[u.width,u.height]],o);let p=h.on("wheel.zoom"),g=h.on("dblclick.zoom");f.wheelDelta(vd);function v(L,z){return h?new Promise(m=>{f?.transform(Oi(h,z?.duration,()=>m(!0)),L)}):Promise.resolve(!1)}function y({noWheelClassName:L,noPanClassName:z,onPaneContextMenu:m,userSelectionActive:E,panOnScroll:S,panOnDrag:T,panOnScrollMode:M,panOnScrollSpeed:_,preventScrolling:I,zoomOnPinch:$,zoomOnScroll:H,zoomOnDoubleClick:K,zoomActivationKeyPressed:G,lib:Y,onTransformChange:X}){E&&!d.isZoomingOrPanning&&w();let j=S&&!G&&!E?Qb({zoomPanValues:d,noWheelClassName:L,d3Selection:h,d3Zoom:f,panOnScrollMode:M,panOnScrollSpeed:_,zoomOnPinch:$,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:l}):Jb({noWheelClassName:L,preventScrolling:I,d3ZoomHandler:p});if(h.on("wheel.zoom",j,{passive:!1}),!E){let fe=ex({zoomPanValues:d,onDraggingChange:c,onPanZoomStart:a});f.on("start",fe);let ce=tx({zoomPanValues:d,panOnDrag:T,onPaneContextMenu:!!m,onPanZoom:s,onTransformChange:X});f.on("zoom",ce);let Q=nx({zoomPanValues:d,panOnDrag:T,panOnScroll:S,onPaneContextMenu:m,onPanZoomEnd:l,onDraggingChange:c});f.on("end",Q)}let re=rx({zoomActivationKeyPressed:G,panOnDrag:T,zoomOnScroll:H,panOnScroll:S,zoomOnDoubleClick:K,zoomOnPinch:$,userSelectionActive:E,noPanClassName:z,noWheelClassName:L,lib:Y});f.filter(re),K?h.on("dblclick.zoom",g):h.on("dblclick.zoom",null)}function w(){f.on("zoom",null)}async function b(L,z,m){let E=Mi(L),S=f?.constrain()(E,z,m);return S&&await v(S),new Promise(T=>T(S))}async function x(L,z){let m=Mi(L);return await v(m,z),new Promise(E=>E(m))}function C(L){if(h){let z=Mi(L),m=h.property("__zoom");(m.k!==L.zoom||m.x!==L.x||m.y!==L.y)&&f?.transform(h,z,null,{sync:!0})}}function k(){let L=h?Jn(h.node()):{x:0,y:0,k:1};return{x:L.x,y:L.y,zoom:L.k}}function N(L,z){return h?new Promise(m=>{f?.scaleTo(Oi(h,z?.duration,()=>m(!0)),L)}):Promise.resolve(!1)}function P(L,z){return h?new Promise(m=>{f?.scaleBy(Oi(h,z?.duration,()=>m(!0)),L)}):Promise.resolve(!1)}function A(L){f?.scaleExtent(L)}function F(L){f?.translateExtent(L)}function B(L){let z=!Ze(L)||L<0?0:L;f?.clickDistance(z)}return{update:y,destroy:w,setViewport:x,setViewportConstrained:b,getViewport:k,scaleTo:N,scaleBy:P,setScaleExtent:A,setTranslateExtent:F,syncViewport:C,setClickDistance:B}}var Ut;(function(e){e.Line="line",e.Handle="handle"})(Ut||(Ut={}));function ox({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:i}){let s=e-t,a=n-r,l=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&o&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function ix(e){let t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function Dt(e,t){return Math.max(0,t-e)}function It(e,t){return Math.max(0,e-t)}function bo(e,t,n){return Math.max(0,t-e,e-n)}function Jc(e,t){return e?!t:t}function sx(e,t,n,r,o,i,s,a){let{affectsX:l,affectsY:c}=t,{isHorizontal:d,isVertical:u}=t,f=d&&u,{xSnapped:h,ySnapped:p}=n,{minWidth:g,maxWidth:v,minHeight:y,maxHeight:w}=r,{x:b,y:x,width:C,height:k,aspectRatio:N}=e,P=Math.floor(d?h-e.pointerX:0),A=Math.floor(u?p-e.pointerY:0),F=C+(l?-P:P),B=k+(c?-A:A),L=-i[0]*C,z=-i[1]*k,m=bo(F,g,v),E=bo(B,y,w);if(s){let M=0,_=0;l&&P<0?M=Dt(b+P+L,s[0][0]):!l&&P>0&&(M=It(b+F+L,s[1][0])),c&&A<0?_=Dt(x+A+z,s[0][1]):!c&&A>0&&(_=It(x+B+z,s[1][1])),m=Math.max(m,M),E=Math.max(E,_)}if(a){let M=0,_=0;l&&P>0?M=It(b+P,a[0][0]):!l&&P<0&&(M=Dt(b+F,a[1][0])),c&&A>0?_=It(x+A,a[0][1]):!c&&A<0&&(_=Dt(x+B,a[1][1])),m=Math.max(m,M),E=Math.max(E,_)}if(o){if(d){let M=bo(F/N,y,w)*N;if(m=Math.max(m,M),s){let _=0;!l&&!c||l&&!c&&f?_=It(x+z+F/N,s[1][1])*N:_=Dt(x+z+(l?P:-P)/N,s[0][1])*N,m=Math.max(m,_)}if(a){let _=0;!l&&!c||l&&!c&&f?_=Dt(x+F/N,a[1][1])*N:_=It(x+(l?P:-P)/N,a[0][1])*N,m=Math.max(m,_)}}if(u){let M=bo(B*N,g,v)/N;if(E=Math.max(E,M),s){let _=0;!l&&!c||c&&!l&&f?_=It(b+B*N+L,s[1][0])/N:_=Dt(b+(c?A:-A)*N+L,s[0][0])/N,E=Math.max(E,_)}if(a){let _=0;!l&&!c||c&&!l&&f?_=Dt(b+B*N,a[1][0])/N:_=It(b+(c?A:-A)*N,a[0][0])/N,E=Math.max(E,_)}}}A=A+(A<0?E:-E),P=P+(P<0?m:-m),o&&(f?F>B*N?A=(Jc(l,c)?-P:P)/N:P=(Jc(l,c)?-A:A)*N:d?(A=P/N,c=l):(P=A*N,l=c));let S=l?b+P:b,T=c?x+A:x;return{width:C+(l?-P:P),height:k+(c?-A:A),x:i[0]*P*(l?-1:1)+S,y:i[1]*A*(c?-1:1)+T}}var Ed={width:0,height:0,x:0,y:0},ax={...Ed,pointerX:0,pointerY:0,aspectRatio:1};function lx(e){return[[0,0],[e.measured.width,e.measured.height]]}function cx(e,t,n){let r=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,l=n[1]*s;return[[r-a,o-l],[r+i-a,o+s-l]]}function _d({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){let i=Ne(e);function s({controlPosition:l,boundaries:c,keepAspectRatio:d,onResizeStart:u,onResize:f,onResizeEnd:h,shouldResize:p}){let g={...Ed},v={...ax},y=ix(l),w,b=null,x=[],C,k,N,P=Yr().on("start",A=>{let{nodeLookup:F,transform:B,snapGrid:L,snapToGrid:z,nodeOrigin:m,paneDomNode:E}=n();if(w=F.get(t),!w)return;b=E?.getBoundingClientRect()??null;let{xSnapped:S,ySnapped:T}=er(A.sourceEvent,{transform:B,snapGrid:L,snapToGrid:z,containerBounds:b});g={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...g,pointerX:S,pointerY:T,aspectRatio:g.width/g.height},C=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(C=F.get(w.parentId),k=C&&w.extent==="parent"?lx(C):void 0),x=[],N=void 0;for(let[M,_]of F)if(_.parentId===t&&(x.push({id:M,position:{..._.position},extent:_.extent}),_.extent==="parent"||_.expandParent)){let I=cx(_,w,_.origin??m);N?N=[[Math.min(I[0][0],N[0][0]),Math.min(I[0][1],N[0][1])],[Math.max(I[1][0],N[1][0]),Math.max(I[1][1],N[1][1])]]:N=I}u?.(A,{...g})}).on("drag",A=>{let{transform:F,snapGrid:B,snapToGrid:L,nodeOrigin:z}=n(),m=er(A.sourceEvent,{transform:F,snapGrid:B,snapToGrid:L,containerBounds:b}),E=[];if(!w)return;let{x:S,y:T,width:M,height:_}=g,I={},$=w.origin??z,{width:H,height:K,x:G,y:Y}=sx(v,y,m,c,d,$,k,N),X=H!==M,W=K!==_,j=G!==S&&X,re=Y!==T&&W;if(!j&&!re&&!X&&!W)return;if((j||re||$[0]===1||$[1]===1)&&(I.x=j?G:g.x,I.y=re?Y:g.y,g.x=I.x,g.y=I.y,x.length>0)){let ae=G-S,ge=Y-T;for(let Oe of x)Oe.position={x:Oe.position.x-ae+$[0]*(H-M),y:Oe.position.y-ge+$[1]*(K-_)},E.push(Oe)}if((X||W)&&(I.width=X?H:g.width,I.height=W?K:g.height,g.width=I.width,g.height=I.height),C&&w.expandParent){let ae=$[0]*(I.width??0);I.x&&I.x<ae&&(g.x=ae,v.x=v.x-(I.x-ae));let ge=$[1]*(I.height??0);I.y&&I.y<ge&&(g.y=ge,v.y=v.y-(I.y-ge))}let fe=ox({width:g.width,prevWidth:M,height:g.height,prevHeight:_,affectsX:y.affectsX,affectsY:y.affectsY}),ce={...g,direction:fe};p?.(A,ce)!==!1&&(f?.(A,ce),r(I,E))}).on("end",A=>{h?.(A,{...g}),o?.()});i.call(P)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}var Fd=V(de(),1),Ld=V(Od(),1);var Rd=e=>{let t,n=new Set,r=(d,u)=>{let f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){let h=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,o,l);return l},Pd=e=>e?Rd(e):Rd;var{useDebugValue:Tx}=Fd.default,{useSyncExternalStoreWithSelector:kx}=Ld.default,Dx=e=>e;function ns(e,t=Dx,n){let r=kx(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Tx(r),r}var Ad=(e,t)=>{let n=Pd(e),r=(o,i=t)=>ns(n,o,i);return Object.assign(r,n),r},zd=(e,t)=>e?Ad(e,t):Ad;function me(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Ix=V(xg()),Lo=(0,R.createContext)(null),Mx=Lo.Provider,lu=Ve.error001();function ie(e,t){let n=(0,R.useContext)(Lo);if(n===null)throw new Error(lu);return ns(n,e,t)}function he(){let e=(0,R.useContext)(Lo);if(e===null)throw new Error(lu);return(0,R.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}var Bd={display:"none"},Ox={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},cu="react-flow__node-desc",du="react-flow__edge-desc",Rx="react-flow__aria-live",Px=e=>e.ariaLiveMessage;function Ax({rfId:e}){let t=ie(Px);return(0,D.jsx)("div",{id:`${Rx}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Ox,children:t})}function Fx({rfId:e,disableKeyboardA11y:t}){return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{id:`${cu}-${e}`,style:Bd,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),(0,D.jsx)("div",{id:`${du}-${e}`,style:Bd,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&(0,D.jsx)(Ax,{rfId:e})]})}var Lx=e=>e.userSelectionActive?"none":"all",zo=(0,R.forwardRef)(({position:e="top-left",children:t,className:n,style:r,...o},i)=>{let s=ie(Lx),a=`${e}`.split("-");return(0,D.jsx)("div",{className:ye(["react-flow__panel",n,...a]),style:{...r,pointerEvents:s},ref:i,...o,children:t})});zo.displayName="Panel";function zx({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:(0,D.jsx)(zo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,D.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}var Bx=e=>{let t=[],n=[];for(let[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(let[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Po=e=>e.id;function $x(e,t){return me(e.selectedNodes.map(Po),t.selectedNodes.map(Po))&&me(e.selectedEdges.map(Po),t.selectedEdges.map(Po))}function Hx({onSelectionChange:e}){let t=he(),{selectedNodes:n,selectedEdges:r}=ie(Bx,$x);return(0,R.useEffect)(()=>{let o={nodes:n,edges:r};e?.(o),t.getState().onSelectionChangeHandlers.forEach(i=>i(o))},[n,r,e]),null}var Vx=e=>!!e.onSelectionChangeHandlers;function Wx({onSelectionChange:e}){let t=ie(Vx);return e||t?(0,D.jsx)(Hx,{onSelectionChange:e}):null}var uu=[0,0],Kx={x:0,y:0,zoom:1},qx=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],$d=[...qx,"rfId"],Ux=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Hd={translateExtent:bn,nodeOrigin:uu,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Yx(e){let{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:c}=ie(Ux,me),d=he();(0,R.useEffect)(()=>(l(e.defaultNodes,e.defaultEdges),()=>{u.current=Hd,a()}),[]);let u=(0,R.useRef)(Hd);return(0,R.useEffect)(()=>{for(let f of $d){let h=e[f],p=u.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?o(h):f==="translateExtent"?i(h):f==="nodeExtent"?s(h):f==="paneClickDistance"?c(h):f==="fitView"?d.setState({fitViewOnInit:h}):f==="fitViewOptions"?d.setState({fitViewOnInitOptions:h}):d.setState({[f]:h})))}u.current=e},$d.map(f=>e[f])),null}function Vd(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Gx(e){let[t,n]=(0,R.useState)(e==="system"?null:e);return(0,R.useEffect)(()=>{if(e!=="system"){n(e);return}let r=Vd(),o=()=>n(r?.matches?"dark":"light");return o(),r?.addEventListener("change",o),()=>{r?.removeEventListener("change",o)}},[e]),t!==null?t:Vd()?.matches?"dark":"light"}var Wd=typeof document<"u"?document:null;function cr(e=null,t={target:Wd,actInsideInputWithModifier:!0}){let[n,r]=(0,R.useState)(!1),o=(0,R.useRef)(!1),i=(0,R.useRef)(new Set([])),[s,a]=(0,R.useMemo)(()=>{if(e!==null){let c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=c.reduce((u,f)=>u.concat(...f),[]);return[c,d]}return[[],[]]},[e]);return(0,R.useEffect)(()=>{let l=t?.target||Wd;if(e!==null){let c=f=>{if(o.current=f.ctrlKey||f.metaKey||f.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&_o(f))return!1;let p=qd(f.code,a);i.current.add(f[p]),Kd(s,i.current,!1)&&(f.preventDefault(),r(!0))},d=f=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&_o(f))return!1;let p=qd(f.code,a);Kd(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(f[p]),f.key==="Meta"&&i.current.clear(),o.current=!1},u=()=>{i.current.clear(),r(!1)};return l?.addEventListener("keydown",c),l?.addEventListener("keyup",d),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{l?.removeEventListener("keydown",c),l?.removeEventListener("keyup",d),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,r]),n}function Kd(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function qd(e,t){return t.includes(e)?"code":"key"}var Xx=()=>{let e=he();return(0,R.useMemo)(()=>({zoomIn:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{let{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{let{transform:[r,o,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??i},{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{let{nodeLookup:n,minZoom:r,maxZoom:o,panZoom:i,domNode:s}=e.getState();if(!i||!s)return Promise.resolve(!1);let a=wo(n,t),{width:l,height:c}=sr(s);return vo({nodes:a,width:l,height:c,minZoom:r,maxZoom:o,panZoom:i},t)},setCenter:async(t,n,r)=>{let{width:o,height:i,maxZoom:s,panZoom:a}=e.getState(),l=typeof r?.zoom<"u"?r.zoom:s,c=o/2-t*l,d=i/2-n*l;return a?(await a.setViewport({x:c,y:d,zoom:l},{duration:r?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{let{width:r,height:o,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),l=Gt(t,r,o,i,s,n?.padding??.1);return a?(await a.setViewport(l,{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{let{transform:r,snapGrid:o,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;let{x:a,y:l}=s.getBoundingClientRect(),c={x:t.x-a,y:t.y-l},d=n.snapGrid??o,u=n.snapToGrid??i;return vn(c,r,u,d)},flowToScreenPosition:t=>{let{transform:n,domNode:r}=e.getState();if(!r)return t;let{x:o,y:i}=r.getBoundingClientRect(),s=Ki(t,n);return{x:s.x+o,y:s.y+i}}}),[])};function fu(e,t){let n=[],r=new Map,o=[];for(let i of e)if(i.type==="add"){o.push(i);continue}else if(i.type==="remove"||i.type==="replace")r.set(i.id,[i]);else{let s=r.get(i.id);s?s.push(i):r.set(i.id,[i])}for(let i of t){let s=r.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}let a={...i};for(let l of s)Zx(l,a);n.push(a)}return o.length&&o.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function Zx(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??={},t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function hu(e,t){return fu(e,t)}function pu(e,t){return fu(e,t)}function Xt(e,t){return{id:e,type:"select",selected:t}}function En(e,t=new Set,n=!1){let r=[];for(let[o,i]of e){let s=t.has(o);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),r.push(Xt(i.id,s)))}return r}function Ud({items:e=[],lookup:t}){let n=[],r=new Map(e.map(o=>[o.id,o]));for(let[o,i]of e.entries()){let s=t.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:o})}for(let[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function Yd(e){return{id:e.id,type:"remove"}}var Gd=e=>ed(e),jx=e=>Li(e);function mu(e){return(0,R.forwardRef)(e)}var Qx=typeof window<"u"?R.useLayoutEffect:R.useEffect;function Xd(e){let[t,n]=(0,R.useState)(BigInt(0)),[r]=(0,R.useState)(()=>Jx(()=>n(o=>o+BigInt(1))));return Qx(()=>{let o=r.get();o.length&&(e(o),r.reset())},[t]),r}function Jx(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}var gu=(0,R.createContext)(null);function e0({children:e}){let t=he(),n=(0,R.useCallback)(a=>{let{nodes:l=[],setNodes:c,hasDefaultNodes:d,onNodesChange:u,nodeLookup:f}=t.getState(),h=l;for(let p of a)h=typeof p=="function"?p(h):p;d?c(h):u&&u(Ud({items:h,lookup:f}))},[]),r=Xd(n),o=(0,R.useCallback)(a=>{let{edges:l=[],setEdges:c,hasDefaultEdges:d,onEdgesChange:u,edgeLookup:f}=t.getState(),h=l;for(let p of a)h=typeof p=="function"?p(h):p;d?c(h):u&&u(Ud({items:h,lookup:f}))},[]),i=Xd(o),s=(0,R.useMemo)(()=>({nodeQueue:r,edgeQueue:i}),[]);return(0,D.jsx)(gu.Provider,{value:s,children:e})}function t0(){let e=(0,R.useContext)(gu);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}var n0=e=>!!e.panZoom;function We(){let e=Xx(),t=he(),n=t0(),r=ie(n0),o=(0,R.useMemo)(()=>{let i=u=>t.getState().nodeLookup.get(u),s=u=>{n.nodeQueue.push(u)},a=u=>{n.edgeQueue.push(u)},l=u=>{let{nodeLookup:f,nodeOrigin:h}=t.getState(),p=Gd(u)?u:f.get(u.id),g=p.parentId?Ui(p.position,p.measured,p.parentId,f,h):p.position,v={...p,position:g,width:p.measured?.width??p.width,height:p.measured?.height??p.height};return Yt(v)},c=(u,f,h={replace:!1})=>{s(p=>p.map(g=>{if(g.id===u){let v=typeof f=="function"?f(g):f;return h.replace&&Gd(v)?v:{...g,...v}}return g}))},d=(u,f,h={replace:!1})=>{a(p=>p.map(g=>{if(g.id===u){let v=typeof f=="function"?f(g):f;return h.replace&&jx(v)?v:{...g,...v}}return g}))};return{getNodes:()=>t.getState().nodes.map(u=>({...u})),getNode:u=>i(u)?.internals.userNode,getInternalNode:i,getEdges:()=>{let{edges:u=[]}=t.getState();return u.map(f=>({...f}))},getEdge:u=>t.getState().edgeLookup.get(u),setNodes:s,setEdges:a,addNodes:u=>{let f=Array.isArray(u)?u:[u];n.nodeQueue.push(h=>[...h,...f])},addEdges:u=>{let f=Array.isArray(u)?u:[u];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{let{nodes:u=[],edges:f=[],transform:h}=t.getState(),[p,g,v]=h;return{nodes:u.map(y=>({...y})),edges:f.map(y=>({...y})),viewport:{x:p,y:g,zoom:v}}},deleteElements:async({nodes:u=[],edges:f=[]})=>{let{nodes:h,edges:p,onNodesDelete:g,onEdgesDelete:v,triggerNodeChanges:y,triggerEdgeChanges:w,onDelete:b,onBeforeDelete:x}=t.getState(),{nodes:C,edges:k}=await nd({nodesToRemove:u,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:x}),N=k.length>0,P=C.length>0;if(N){let A=k.map(Yd);v?.(k),w(A)}if(P){let A=C.map(Yd);g?.(C),y(A)}return(P||N)&&b?.({nodes:C,edges:k}),{deletedNodes:C,deletedEdges:k}},getIntersectingNodes:(u,f=!0,h)=>{let p=Vi(u),g=p?u:l(u),v=h!==void 0;return g?(h||t.getState().nodes).filter(y=>{let w=t.getState().nodeLookup.get(y.id);if(w&&!p&&(y.id===u.id||!w.internals.positionAbsolute))return!1;let b=Yt(v?y:w),x=wn(b,g);return f&&x>0||x>=g.width*g.height}):[]},isNodeIntersecting:(u,f,h=!0)=>{let g=Vi(u)?u:l(u);if(!g)return!1;let v=wn(g,f);return h&&v>0||v>=g.width*g.height},updateNode:c,updateNodeData:(u,f,h={replace:!1})=>{c(u,p=>{let g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},updateEdge:d,updateEdgeData:(u,f,h={replace:!1})=>{d(u,p=>{let g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},getNodesBounds:u=>{let{nodeLookup:f,nodeOrigin:h}=t.getState();return rr(u,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:u,id:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}-${u}${f?`-${f}`:""}`)?.values()??[]),getNodeConnections:({type:u,handleId:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}${u?f?`-${u}-${f}`:`-${u}`:""}`)?.values()??[])}},[]);return(0,R.useMemo)(()=>({...o,...e,viewportInitialized:r}),[r])}var Zd=e=>e.selected,r0={actInsideInputWithModifier:!1},o0=typeof window<"u"?window:void 0;function i0({deleteKeyCode:e,multiSelectionKeyCode:t}){let n=he(),{deleteElements:r}=We(),o=cr(e,r0),i=cr(t,{target:o0});(0,R.useEffect)(()=>{if(o){let{edges:s,nodes:a}=n.getState();r({nodes:a.filter(Zd),edges:s.filter(Zd)}),n.setState({nodesSelectionActive:!1})}},[o]),(0,R.useEffect)(()=>{n.setState({multiSelectionActive:i})},[i])}function s0(e){let t=he();(0,R.useEffect)(()=>{let n=()=>{if(!e.current)return!1;let r=sr(e.current);(r.height===0||r.width===0)&&t.getState().onError?.("004",Ve.error004()),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);let r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}var Bo={position:"absolute",width:"100%",height:"100%",top:0,left:0},a0=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function l0({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:i=wt.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:d,maxZoom:u,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:g,noPanClassName:v,onViewportChange:y,isControlledViewport:w,paneClickDistance:b}){let x=he(),C=(0,R.useRef)(null),{userSelectionActive:k,lib:N}=ie(a0,me),P=cr(f),A=(0,R.useRef)();s0(C);let F=(0,R.useCallback)(B=>{y?.({x:B[0],y:B[1],zoom:B[2]}),w||x.setState({transform:B})},[y,w]);return(0,R.useEffect)(()=>{if(C.current){A.current=Sd({domNode:C.current,minZoom:d,maxZoom:u,translateExtent:c,viewport:l,paneClickDistance:b,onDraggingChange:m=>x.setState({paneDragging:m}),onPanZoomStart:(m,E)=>{let{onViewportChangeStart:S,onMoveStart:T}=x.getState();T?.(m,E),S?.(E)},onPanZoom:(m,E)=>{let{onViewportChange:S,onMove:T}=x.getState();T?.(m,E),S?.(E)},onPanZoomEnd:(m,E)=>{let{onViewportChangeEnd:S,onMoveEnd:T}=x.getState();T?.(m,E),S?.(E)}});let{x:B,y:L,zoom:z}=A.current.getViewport();return x.setState({panZoom:A.current,transform:[B,L,z],domNode:C.current.closest(".react-flow")}),()=>{A.current?.destroy()}}},[]),(0,R.useEffect)(()=>{A.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:P,preventScrolling:h,noPanClassName:v,userSelectionActive:k,noWheelClassName:g,lib:N,onTransformChange:F})},[e,t,n,r,o,i,s,a,P,h,v,k,g,N,F]),(0,D.jsx)("div",{className:"react-flow__renderer",ref:C,style:Bo,children:p})}var c0=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function d0(){let{userSelectionActive:e,userSelectionRect:t}=ie(c0,me);return e&&t?(0,D.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}var rs=(e,t)=>n=>{n.target===t.current&&e?.(n)},u0=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function f0({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Kt.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:i,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:u,onPaneMouseLeave:f,children:h}){let p=he(),{userSelectionActive:g,elementsSelectable:v,dragging:y}=ie(u0,me),w=v&&(e||g),b=(0,R.useRef)(null),x=(0,R.useRef)(),C=(0,R.useRef)(new Set),k=(0,R.useRef)(new Set),N=(0,R.useRef)(!1),P=(0,R.useRef)(!1),A=S=>{if(N.current){N.current=!1;return}a?.(S),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},F=S=>{if(Array.isArray(r)&&r?.includes(2)){S.preventDefault();return}l?.(S)},B=c?S=>c(S):void 0,L=S=>{let{resetSelectedElements:T,domNode:M}=p.getState();if(x.current=M?.getBoundingClientRect(),!v||!e||S.button!==0||S.target!==b.current||!x.current)return;S.target?.setPointerCapture?.(S.pointerId),P.current=!0,N.current=!1;let{x:_,y:I}=ct(S.nativeEvent,x.current);T(),p.setState({userSelectionRect:{width:0,height:0,startX:_,startY:I,x:_,y:I}}),i?.(S)},z=S=>{let{userSelectionRect:T,transform:M,nodeLookup:_,edgeLookup:I,connectionLookup:$,triggerNodeChanges:H,triggerEdgeChanges:K,defaultEdgeOptions:G}=p.getState();if(!x.current||!T)return;N.current=!0;let{x:Y,y:X}=ct(S.nativeEvent,x.current),{startX:W,startY:j}=T,re={startX:W,startY:j,x:Y<W?Y:W,y:X<j?X:j,width:Math.abs(Y-W),height:Math.abs(X-j)},fe=C.current,ce=k.current;C.current=new Set(Bi(_,re,M,n===Kt.Partial,!0).map(ae=>ae.id)),k.current=new Set;let Q=G?.selectable??!0;for(let ae of C.current){let ge=$.get(ae);if(ge)for(let{edgeId:Oe}of ge.values()){let Ot=I.get(Oe);Ot&&(Ot.selectable??Q)&&k.current.add(Oe)}}if(!Yi(fe,C.current)){let ae=En(_,C.current,!0);H(ae)}if(!Yi(ce,k.current)){let ae=En(I,k.current);K(ae)}p.setState({userSelectionRect:re,userSelectionActive:!0,nodesSelectionActive:!1})},m=S=>{if(S.button!==0||!P.current)return;S.target?.releasePointerCapture?.(S.pointerId);let{userSelectionRect:T}=p.getState();!g&&T&&S.target===b.current&&A?.(S),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:C.current.size>0}),s?.(S),(t||o)&&(N.current=!1),P.current=!1},E=r===!0||Array.isArray(r)&&r.includes(0);return(0,D.jsxs)("div",{className:ye(["react-flow__pane",{draggable:E,dragging:y,selection:e}]),onClick:w?void 0:rs(A,b),onContextMenu:rs(F,b),onWheel:rs(B,b),onPointerEnter:w?void 0:d,onPointerDown:w?L:u,onPointerMove:w?z:u,onPointerUp:w?m:void 0,onPointerLeave:f,ref:b,style:Bo,children:[h,(0,D.jsx)(d0,{})]})}function is({id:e,store:t,unselect:n=!1,nodeRef:r}){let{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:l}=t.getState(),c=a.get(e);if(!c){l?.("012",Ve.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>r?.current?.blur())):o([e])}function yu({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,nodeClickDistance:s}){let a=he(),[l,c]=(0,R.useState)(!1),d=(0,R.useRef)();return(0,R.useEffect)(()=>{d.current=pd({getStoreItems:()=>a.getState(),onNodeMouseDown:u=>{is({id:u,store:a,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),(0,R.useEffect)(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:i,nodeId:o,nodeClickDistance:s}),()=>{d.current?.destroy()}},[n,r,t,i,e,o]),l}var h0=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function bu(){let e=he();return(0,R.useCallback)(n=>{let{nodeExtent:r,snapToGrid:o,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:d}=e.getState(),u=new Map,f=h0(s),h=o?i[0]:5,p=o?i[1]:5,g=n.direction.x*h*n.factor,v=n.direction.y*p*n.factor;for(let[,y]of c){if(!f(y))continue;let w={x:y.internals.positionAbsolute.x+g,y:y.internals.positionAbsolute.y+v};o&&(w=or(w,i));let{position:b,positionAbsolute:x}=$i({nodeId:y.id,nextPosition:w,nodeLookup:c,nodeExtent:r,nodeOrigin:d,onError:a});y.position=b,y.internals.positionAbsolute=x,u.set(y.id,y)}l(u)},[])}var ss=(0,R.createContext)(null),p0=ss.Provider;ss.Consumer;var xu=()=>(0,R.useContext)(ss),m0=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),g0=(e,t,n)=>r=>{let{connectionClickStartHandle:o,connectionMode:i,connection:s}=r,{fromHandle:a,toHandle:l,isValid:c}=s,d=l?.nodeId===e&&l?.id===t&&l?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:d,clickConnecting:o?.nodeId===e&&o?.id===t&&o?.type===n,isPossibleEndHandle:i===dt.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:d&&c}};function y0({type:e="source",position:t=U.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:u,...f},h){let p=s||null,g=e==="target",v=he(),y=xu(),{connectOnClick:w,noPanClassName:b,rfId:x}=ie(m0,me),{connectingFrom:C,connectingTo:k,clickConnecting:N,isPossibleEndHandle:P,connectionInProcess:A,clickConnectionInProcess:F,valid:B}=ie(g0(y,p,e),me);y||v.getState().onError?.("010",Ve.error010());let L=E=>{let{defaultEdgeOptions:S,onConnect:T,hasDefaultEdges:M}=v.getState(),_={...S,...E};if(M){let{edges:I,setEdges:$}=v.getState();$(ar(_,I))}T?.(_),a?.(_)},z=E=>{if(!y)return;let S=Xi(E.nativeEvent);if(o&&(S&&E.button===0||!S)){let T=v.getState();Mo.onPointerDown(E.nativeEvent,{autoPanOnConnect:T.autoPanOnConnect,connectionMode:T.connectionMode,connectionRadius:T.connectionRadius,domNode:T.domNode,nodeLookup:T.nodeLookup,lib:T.lib,isTarget:g,handleId:p,nodeId:y,flowId:T.rfId,panBy:T.panBy,cancelConnection:T.cancelConnection,onConnectStart:T.onConnectStart,onConnectEnd:T.onConnectEnd,updateConnection:T.updateConnection,onConnect:L,isValidConnection:n||T.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:T.autoPanSpeed})}S?d?.(E):u?.(E)},m=E=>{let{onClickConnectStart:S,onClickConnectEnd:T,connectionClickStartHandle:M,connectionMode:_,isValidConnection:I,lib:$,rfId:H,nodeLookup:K,connection:G}=v.getState();if(!y||!M&&!o)return;if(!M){S?.(E.nativeEvent,{nodeId:y,handleId:p,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:y,type:e,id:p}});return}let Y=Gi(E.target),X=n||I,{connection:W,isValid:j}=Mo.isValid(E.nativeEvent,{handle:{nodeId:y,id:p,type:e},connectionMode:_,fromNodeId:M.nodeId,fromHandleId:M.id||null,fromType:M.type,isValidConnection:X,flowId:H,doc:Y,lib:$,nodeLookup:K});j&&W&&L(W);let re=structuredClone(G);delete re.inProgress,re.toPosition=re.toHandle?re.toHandle.position:null,T?.(E,re),v.setState({connectionClickStartHandle:null})};return(0,D.jsx)("div",{"data-handleid":p,"data-nodeid":y,"data-handlepos":t,"data-id":`${x}-${y}-${p}-${e}`,className:ye(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,c,{source:!g,target:g,connectable:r,connectablestart:o,connectableend:i,clickconnecting:N,connectingfrom:C,connectingto:k,valid:B,connectionindicator:r&&(!A||P)&&(A||F?i:o)}]),onMouseDown:z,onTouchStart:z,onClick:w?m:void 0,ref:h,...f,children:l})}var Zt=(0,R.memo)(mu(y0));function b0({data:e,isConnectable:t,sourcePosition:n=U.Bottom}){return(0,D.jsxs)(D.Fragment,{children:[e?.label,(0,D.jsx)(Zt,{type:"source",position:n,isConnectable:t})]})}function x0({data:e,isConnectable:t,targetPosition:n=U.Top,sourcePosition:r=U.Bottom}){return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Zt,{type:"target",position:n,isConnectable:t}),e?.label,(0,D.jsx)(Zt,{type:"source",position:r,isConnectable:t})]})}function w0(){return null}function v0({data:e,isConnectable:t,targetPosition:n=U.Top}){return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Zt,{type:"target",position:n,isConnectable:t}),e?.label]})}var Fo={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},jd={input:b0,default:x0,output:v0,group:w0};function S0(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}var E0=e=>{let{width:t,height:n,x:r,y:o}=xn(e.nodeLookup,{filter:i=>!!i.selected});return{width:Ze(t)?t:null,height:Ze(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function _0({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let r=he(),{width:o,height:i,transformString:s,userSelectionActive:a}=ie(E0,me),l=bu(),c=(0,R.useRef)(null);if((0,R.useEffect)(()=>{n||c.current?.focus({preventScroll:!0})},[n]),yu({nodeRef:c}),a||!o||!i)return null;let d=e?f=>{let h=r.getState().nodes.filter(p=>p.selected);e(f,h)}:void 0,u=f=>{Object.prototype.hasOwnProperty.call(Fo,f.key)&&(f.preventDefault(),l({direction:Fo[f.key],factor:f.shiftKey?4:1}))};return(0,D.jsx)("div",{className:ye(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:(0,D.jsx)("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:u,style:{width:o,height:i}})})}var Qd=typeof window<"u"?window:void 0,C0=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function wu({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:d,selectionMode:u,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:g,zoomActivationKeyCode:v,elementsSelectable:y,zoomOnScroll:w,zoomOnPinch:b,panOnScroll:x,panOnScrollSpeed:C,panOnScrollMode:k,zoomOnDoubleClick:N,panOnDrag:P,defaultViewport:A,translateExtent:F,minZoom:B,maxZoom:L,preventScrolling:z,onSelectionContextMenu:m,noWheelClassName:E,noPanClassName:S,disableKeyboardA11y:T,onViewportChange:M,isControlledViewport:_}){let{nodesSelectionActive:I,userSelectionActive:$}=ie(C0),H=cr(c,{target:Qd}),K=cr(g,{target:Qd}),G=K||P,Y=K||x,X=d&&G!==!0,W=H||$||X;return i0({deleteKeyCode:l,multiSelectionKeyCode:p}),(0,D.jsx)(l0,{onPaneContextMenu:i,elementsSelectable:y,zoomOnScroll:w,zoomOnPinch:b,panOnScroll:Y,panOnScrollSpeed:C,panOnScrollMode:k,zoomOnDoubleClick:N,panOnDrag:!H&&G,defaultViewport:A,translateExtent:F,minZoom:B,maxZoom:L,zoomActivationKeyCode:v,preventScrolling:z,noWheelClassName:E,noPanClassName:S,onViewportChange:M,isControlledViewport:_,paneClickDistance:a,children:(0,D.jsxs)(f0,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:G,isSelecting:!!W,selectionMode:u,selectionKeyPressed:H,selectionOnDrag:X,children:[e,I&&(0,D.jsx)(_0,{onSelectionContextMenu:m,noPanClassName:S,disableKeyboardA11y:T})]})})}wu.displayName="FlowRenderer";var N0=(0,R.memo)(wu),T0=e=>t=>e?Bi(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function k0(e){return ie((0,R.useCallback)(T0(e),[e]),me)}var D0=e=>e.updateNodeInternals;function I0(){let e=ie(D0),[t]=(0,R.useState)(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{let r=new Map;n.forEach(o=>{let i=o.target.getAttribute("data-id");r.set(i,{id:i,nodeElement:o.target,force:!0})}),e(r)}));return(0,R.useEffect)(()=>()=>{t?.disconnect()},[t]),t}function M0({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){let o=he(),i=(0,R.useRef)(null),s=(0,R.useRef)(null),a=(0,R.useRef)(e.sourcePosition),l=(0,R.useRef)(e.targetPosition),c=(0,R.useRef)(t),d=n&&!!e.internals.handleBounds;return(0,R.useEffect)(()=>{i.current&&!e.hidden&&(!d||s.current!==i.current)&&(s.current&&r?.unobserve(s.current),r?.observe(i.current),s.current=i.current)},[d,e.hidden]),(0,R.useEffect)(()=>()=>{s.current&&(r?.unobserve(s.current),s.current=null)},[]),(0,R.useEffect)(()=>{if(i.current){let u=c.current!==t,f=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(u||f||h)&&(c.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function O0({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:d,resizeObserver:u,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:g,nodeTypes:v,nodeClickDistance:y,onError:w}){let{node:b,internals:x,isParent:C}=ie(W=>{let j=W.nodeLookup.get(e),re=W.parentLookup.has(e);return{node:j,internals:j.internals,isParent:re}},me),k=b.type||"default",N=v?.[k]||jd[k];N===void 0&&(w?.("003",Ve.error003(k)),k="default",N=jd.default);let P=!!(b.draggable||a&&typeof b.draggable>"u"),A=!!(b.selectable||l&&typeof b.selectable>"u"),F=!!(b.connectable||c&&typeof b.connectable>"u"),B=!!(b.focusable||d&&typeof b.focusable>"u"),L=he(),z=qi(b),m=M0({node:b,nodeType:k,hasDimensions:z,resizeObserver:u}),E=yu({nodeRef:m,disabled:b.hidden||!P,noDragClassName:f,handleSelector:b.dragHandle,nodeId:e,isSelectable:A,nodeClickDistance:y}),S=bu();if(b.hidden)return null;let T=ht(b),M=S0(b),_=A||P||t||n||r||o,I=n?W=>n(W,{...x.userNode}):void 0,$=r?W=>r(W,{...x.userNode}):void 0,H=o?W=>o(W,{...x.userNode}):void 0,K=i?W=>i(W,{...x.userNode}):void 0,G=s?W=>s(W,{...x.userNode}):void 0,Y=W=>{let{selectNodesOnDrag:j,nodeDragThreshold:re}=L.getState();A&&(!j||!P||re>0)&&is({id:e,store:L,nodeRef:m}),t&&t(W,{...x.userNode})},X=W=>{if(!(_o(W.nativeEvent)||p))if(Pi.includes(W.key)&&A){let j=W.key==="Escape";is({id:e,store:L,unselect:j,nodeRef:m})}else P&&b.selected&&Object.prototype.hasOwnProperty.call(Fo,W.key)&&(W.preventDefault(),L.setState({ariaLiveMessage:`Moved selected node ${W.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~x.positionAbsolute.x}, y: ${~~x.positionAbsolute.y}`}),S({direction:Fo[W.key],factor:W.shiftKey?4:1}))};return(0,D.jsx)("div",{className:ye(["react-flow__node",`react-flow__node-${k}`,{[h]:P},b.className,{selected:b.selected,selectable:A,parent:C,draggable:P,dragging:E}]),ref:m,style:{zIndex:x.z,transform:`translate(${x.positionAbsolute.x}px,${x.positionAbsolute.y}px)`,pointerEvents:_?"all":"none",visibility:z?"visible":"hidden",...b.style,...M},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:I,onMouseMove:$,onMouseLeave:H,onContextMenu:K,onClick:Y,onDoubleClick:G,onKeyDown:B?X:void 0,tabIndex:B?0:void 0,role:B?"button":void 0,"aria-describedby":p?void 0:`${cu}-${g}`,"aria-label":b.ariaLabel,children:(0,D.jsx)(p0,{value:e,children:(0,D.jsx)(N,{id:e,data:b.data,type:k,positionAbsoluteX:x.positionAbsolute.x,positionAbsoluteY:x.positionAbsolute.y,selected:b.selected??!1,selectable:A,draggable:P,deletable:b.deletable??!0,isConnectable:F,sourcePosition:b.sourcePosition,targetPosition:b.targetPosition,dragging:E,dragHandle:b.dragHandle,zIndex:x.z,parentId:b.parentId,...T})})})}var R0=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function vu(e){let{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:i}=ie(R0,me),s=k0(e.onlyRenderVisibleElements),a=I0();return(0,D.jsx)("div",{className:"react-flow__nodes",style:Bo,children:s.map(l=>(0,D.jsx)(O0,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:i},l))})}vu.displayName="NodeRenderer";var P0=(0,R.memo)(vu);function A0(e){return ie((0,R.useCallback)(n=>{if(!e)return n.edges.map(o=>o.id);let r=[];if(n.width&&n.height)for(let o of n.edges){let i=n.nodeLookup.get(o.source),s=n.nodeLookup.get(o.target);i&&s&&sd({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),me)}var F0=({color:e="none",strokeWidth:t=1})=>(0,D.jsx)("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),L0=({color:e="none",strokeWidth:t=1})=>(0,D.jsx)("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Jd={[ft.Arrow]:F0,[ft.ArrowClosed]:L0};function z0(e){let t=he();return(0,R.useMemo)(()=>Object.prototype.hasOwnProperty.call(Jd,e)?Jd[e]:(t.getState().onError?.("009",Ve.error009(e)),null),[e])}var B0=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{let l=z0(t);return l?(0,D.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:(0,D.jsx)(l,{color:n,strokeWidth:s})}):null},Su=({defaultColor:e,rfId:t})=>{let n=ie(i=>i.edges),r=ie(i=>i.defaultEdgeOptions),o=(0,R.useMemo)(()=>ld(n,{id:t,defaultColor:e,defaultMarkerStart:r?.markerStart,defaultMarkerEnd:r?.markerEnd}),[n,r,t,e]);return o.length?(0,D.jsx)("svg",{className:"react-flow__marker",children:(0,D.jsx)("defs",{children:o.map(i=>(0,D.jsx)(B0,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Su.displayName="MarkerDefinitions";var $0=(0,R.memo)(Su);function Eu({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d}){let[u,f]=(0,R.useState)({x:1,y:0,width:0,height:0}),h=ye(["react-flow__edge-textwrapper",c]),p=(0,R.useRef)(null);return(0,R.useEffect)(()=>{if(p.current){let g=p.current.getBBox();f({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:(0,D.jsxs)("g",{transform:`translate(${e-u.width/2} ${t-u.height/2})`,className:h,visibility:u.width?"visible":"hidden",...d,children:[o&&(0,D.jsx)("rect",{width:u.width+2*s[0],x:-s[0],y:-s[1],height:u.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),(0,D.jsx)("text",{className:"react-flow__edge-text",y:u.height/2,dy:"0.3em",ref:p,style:r,children:n}),l]})}Eu.displayName="EdgeText";var H0=(0,R.memo)(Eu);function $o({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...d}){return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("path",{...d,d:e,fill:"none",className:ye(["react-flow__edge-path",d.className])}),c&&(0,D.jsx)("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}),r&&Ze(t)&&Ze(n)?(0,D.jsx)(H0,{x:t,y:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function eu({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===U.Left||e===U.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function _u({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:o,targetPosition:i=U.Top}){let[s,a]=eu({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,c]=eu({pos:i,x1:r,y1:o,x2:e,y2:t}),[d,u,f,h]=Co({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${s},${a} ${l},${c} ${r},${o}`,d,u,f,h]}function Cu(e){return(0,R.memo)(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=U.Bottom,targetPosition:a=U.Top,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:y})=>{let[w,b,x]=_u({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a}),C=e.isInternal?void 0:t;return(0,D.jsx)($o,{id:C,path:w,labelX:b,labelY:x,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:y})})}var V0=Cu({isInternal:!1}),Nu=Cu({isInternal:!0});V0.displayName="SimpleBezierEdge";Nu.displayName="SimpleBezierEdgeInternal";function Tu(e){return(0,R.memo)(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,sourcePosition:h=U.Bottom,targetPosition:p=U.Top,markerEnd:g,markerStart:v,pathOptions:y,interactionWidth:w})=>{let[b,x,C]=lr({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:i,targetPosition:p,borderRadius:y?.borderRadius,offset:y?.offset}),k=e.isInternal?void 0:t;return(0,D.jsx)($o,{id:k,path:b,labelX:x,labelY:C,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,markerEnd:g,markerStart:v,interactionWidth:w})})}var ku=Tu({isInternal:!1}),Du=Tu({isInternal:!0});ku.displayName="SmoothStepEdge";Du.displayName="SmoothStepEdgeInternal";function Iu(e){return(0,R.memo)(({id:t,...n})=>{let r=e.isInternal?void 0:t;return(0,D.jsx)(ku,{...n,id:r,pathOptions:(0,R.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}var W0=Iu({isInternal:!1}),Mu=Iu({isInternal:!0});W0.displayName="StepEdge";Mu.displayName="StepEdgeInternal";function Ou(e){return(0,R.memo)(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,markerEnd:h,markerStart:p,interactionWidth:g})=>{let[v,y,w]=To({sourceX:n,sourceY:r,targetX:o,targetY:i}),b=e.isInternal?void 0:t;return(0,D.jsx)($o,{id:b,path:v,labelX:y,labelY:w,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,markerEnd:h,markerStart:p,interactionWidth:g})})}var K0=Ou({isInternal:!1}),Ru=Ou({isInternal:!0});K0.displayName="StraightEdge";Ru.displayName="StraightEdgeInternal";function Pu(e){return(0,R.memo)(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=U.Bottom,targetPosition:a=U.Top,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,pathOptions:y,interactionWidth:w})=>{let[b,x,C]=No({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a,curvature:y?.curvature}),k=e.isInternal?void 0:t;return(0,D.jsx)($o,{id:k,path:b,labelX:x,labelY:C,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:w})})}var q0=Pu({isInternal:!1}),Au=Pu({isInternal:!0});q0.displayName="BezierEdge";Au.displayName="BezierEdgeInternal";var tu={default:Au,straight:Ru,step:Mu,smoothstep:Du,simplebezier:Nu},nu={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},U0=(e,t,n)=>n===U.Left?e-t:n===U.Right?e+t:e,Y0=(e,t,n)=>n===U.Top?e-t:n===U.Bottom?e+t:e,ru="react-flow__edgeupdater";function ou({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a}){return(0,D.jsx)("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:ye([ru,`${ru}-${a}`]),cx:U0(t,r,e),cy:Y0(n,r,e),r,stroke:"transparent",fill:"transparent"})}function G0({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:i,targetY:s,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:d,onReconnectEnd:u,setReconnecting:f,setUpdateHover:h}){let p=he(),g=(x,C)=>{if(x.button!==0)return;let{autoPanOnConnect:k,domNode:N,isValidConnection:P,connectionMode:A,connectionRadius:F,lib:B,onConnectStart:L,onConnectEnd:z,cancelConnection:m,nodeLookup:E,rfId:S,panBy:T,updateConnection:M}=p.getState(),_=C.type==="target";f(!0),d?.(x,n,C.type);let I=(H,K)=>{f(!1),u?.(H,n,C.type,K)},$=H=>c?.(n,H);Mo.onPointerDown(x.nativeEvent,{autoPanOnConnect:k,connectionMode:A,connectionRadius:F,domNode:N,handleId:C.id,nodeId:C.nodeId,nodeLookup:E,isTarget:_,edgeUpdaterType:C.type,lib:B,flowId:S,cancelConnection:m,panBy:T,isValidConnection:P,onConnect:$,onConnectStart:L,onConnectEnd:z,onReconnectEnd:I,updateConnection:M,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},v=x=>g(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),y=x=>g(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>h(!0),b=()=>h(!1);return(0,D.jsxs)(D.Fragment,{children:[(e===!0||e==="source")&&(0,D.jsx)(ou,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:b,type:"source"}),(e===!0||e==="target")&&(0,D.jsx)(ou,{position:l,centerX:i,centerY:s,radius:t,onMouseDown:y,onMouseEnter:w,onMouseOut:b,type:"target"})]})}function X0({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:d,onReconnect:u,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:g,noPanClassName:v,onError:y,disableKeyboardA11y:w}){let b=ie(Q=>Q.edgeLookup.get(e)),x=ie(Q=>Q.defaultEdgeOptions);b=x?{...x,...b}:b;let C=b.type||"default",k=g?.[C]||tu[C];k===void 0&&(y?.("011",Ve.error011(C)),C="default",k=tu.default);let N=!!(b.focusable||t&&typeof b.focusable>"u"),P=typeof u<"u"&&(b.reconnectable||n&&typeof b.reconnectable>"u"),A=!!(b.selectable||r&&typeof b.selectable>"u"),F=(0,R.useRef)(null),[B,L]=(0,R.useState)(!1),[z,m]=(0,R.useState)(!1),E=he(),{zIndex:S,sourceX:T,sourceY:M,targetX:_,targetY:I,sourcePosition:$,targetPosition:H}=ie((0,R.useCallback)(Q=>{let ae=Q.nodeLookup.get(b.source),ge=Q.nodeLookup.get(b.target);if(!ae||!ge)return{zIndex:b.zIndex,...nu};let Oe=ad({id:e,sourceNode:ae,targetNode:ge,sourceHandle:b.sourceHandle||null,targetHandle:b.targetHandle||null,connectionMode:Q.connectionMode,onError:y});return{zIndex:id({selected:b.selected,zIndex:b.zIndex,sourceNode:ae,targetNode:ge,elevateOnSelect:Q.elevateEdgesOnSelect}),...Oe||nu}},[b.source,b.target,b.sourceHandle,b.targetHandle,b.selected,b.zIndex]),me),K=(0,R.useMemo)(()=>b.markerStart?`url('#${ko(b.markerStart,p)}')`:void 0,[b.markerStart,p]),G=(0,R.useMemo)(()=>b.markerEnd?`url('#${ko(b.markerEnd,p)}')`:void 0,[b.markerEnd,p]);if(b.hidden||T===null||M===null||_===null||I===null)return null;let Y=Q=>{let{addSelectedEdges:ae,unselectNodesAndEdges:ge,multiSelectionActive:Oe}=E.getState();A&&(E.setState({nodesSelectionActive:!1}),b.selected&&Oe?(ge({nodes:[],edges:[b]}),F.current?.blur()):ae([e])),o&&o(Q,b)},X=i?Q=>{i(Q,{...b})}:void 0,W=s?Q=>{s(Q,{...b})}:void 0,j=a?Q=>{a(Q,{...b})}:void 0,re=l?Q=>{l(Q,{...b})}:void 0,fe=c?Q=>{c(Q,{...b})}:void 0,ce=Q=>{if(!w&&Pi.includes(Q.key)&&A){let{unselectNodesAndEdges:ae,addSelectedEdges:ge}=E.getState();Q.key==="Escape"?(F.current?.blur(),ae({edges:[b]})):ge([e])}};return(0,D.jsx)("svg",{style:{zIndex:S},children:(0,D.jsxs)("g",{className:ye(["react-flow__edge",`react-flow__edge-${C}`,b.className,v,{selected:b.selected,animated:b.animated,inactive:!A&&!o,updating:B,selectable:A}]),onClick:Y,onDoubleClick:X,onContextMenu:W,onMouseEnter:j,onMouseMove:re,onMouseLeave:fe,onKeyDown:N?ce:void 0,tabIndex:N?0:void 0,role:N?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":b.ariaLabel===null?void 0:b.ariaLabel||`Edge from ${b.source} to ${b.target}`,"aria-describedby":N?`${du}-${p}`:void 0,ref:F,children:[!z&&(0,D.jsx)(k,{id:e,source:b.source,target:b.target,type:b.type,selected:b.selected,animated:b.animated,selectable:A,deletable:b.deletable??!0,label:b.label,labelStyle:b.labelStyle,labelShowBg:b.labelShowBg,labelBgStyle:b.labelBgStyle,labelBgPadding:b.labelBgPadding,labelBgBorderRadius:b.labelBgBorderRadius,sourceX:T,sourceY:M,targetX:_,targetY:I,sourcePosition:$,targetPosition:H,data:b.data,style:b.style,sourceHandleId:b.sourceHandle,targetHandleId:b.targetHandle,markerStart:K,markerEnd:G,pathOptions:"pathOptions"in b?b.pathOptions:void 0,interactionWidth:b.interactionWidth}),P&&(0,D.jsx)(G0,{edge:b,isReconnectable:P,reconnectRadius:d,onReconnect:u,onReconnectStart:f,onReconnectEnd:h,sourceX:T,sourceY:M,targetX:_,targetY:I,sourcePosition:$,targetPosition:H,setUpdateHover:L,setReconnecting:m})]})})}var Z0=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Fu({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,reconnectRadius:u,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:g}){let{edgesFocusable:v,edgesReconnectable:y,elementsSelectable:w,onError:b}=ie(Z0,me),x=A0(t);return(0,D.jsxs)("div",{className:"react-flow__edges",children:[(0,D.jsx)($0,{defaultColor:e,rfId:n}),x.map(C=>(0,D.jsx)(X0,{id:C,edgesFocusable:v,edgesReconnectable:y,elementsSelectable:w,noPanClassName:o,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,reconnectRadius:u,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:b,edgeTypes:r,disableKeyboardA11y:g},C))]})}Fu.displayName="EdgeRenderer";var j0=(0,R.memo)(Fu),Q0=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function J0({children:e}){let t=ie(Q0);return(0,D.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function ew(e){let t=We(),n=(0,R.useRef)(!1);(0,R.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}var tw=e=>e.panZoom?.syncViewport;function nw(e){let t=ie(tw),n=he();return(0,R.useEffect)(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function iu(e){return e.connection.inProgress?{...e.connection,to:vn(e.connection.to,e.transform)}:{...e.connection}}function rw(e){return e?n=>{let r=iu(n);return e(r)}:iu}function ow(e){let t=rw(e);return ie(t,me)}var iw=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function sw({containerStyle:e,style:t,type:n,component:r}){let{nodesConnectable:o,width:i,height:s,isValid:a,inProgress:l}=ie(iw,me);return!(i&&o&&l)?null:(0,D.jsx)("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:(0,D.jsx)("g",{className:ye(["react-flow__connection",Fi(a)]),children:(0,D.jsx)(Lu,{style:t,type:n,CustomComponent:r,isValid:a})})})}var Lu=({style:e,type:t=ut.Bezier,CustomComponent:n,isValid:r})=>{let{inProgress:o,from:i,fromNode:s,fromHandle:a,fromPosition:l,to:c,toNode:d,toHandle:u,toPosition:f}=ow();if(!o)return;if(n)return(0,D.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:f,connectionStatus:Fi(r),toNode:d,toHandle:u});let h="",p={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:f};switch(t){case ut.Bezier:[h]=No(p);break;case ut.SimpleBezier:[h]=_u(p);break;case ut.Step:[h]=lr({...p,borderRadius:0});break;case ut.SmoothStep:[h]=lr(p);break;default:[h]=To(p)}return(0,D.jsx)("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Lu.displayName="ConnectionLine";var aw={};function su(e=aw){let t=(0,R.useRef)(e),n=he();(0,R.useEffect)(()=>{},[e])}function lw(){let e=he(),t=(0,R.useRef)(!1);(0,R.useEffect)(()=>{},[])}function zu({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,onSelectionContextMenu:u,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:g,connectionLineComponent:v,connectionLineContainerStyle:y,selectionKeyCode:w,selectionOnDrag:b,selectionMode:x,multiSelectionKeyCode:C,panActivationKeyCode:k,zoomActivationKeyCode:N,deleteKeyCode:P,onlyRenderVisibleElements:A,elementsSelectable:F,defaultViewport:B,translateExtent:L,minZoom:z,maxZoom:m,preventScrolling:E,defaultMarkerColor:S,zoomOnScroll:T,zoomOnPinch:M,panOnScroll:_,panOnScrollSpeed:I,panOnScrollMode:$,zoomOnDoubleClick:H,panOnDrag:K,onPaneClick:G,onPaneMouseEnter:Y,onPaneMouseMove:X,onPaneMouseLeave:W,onPaneScroll:j,onPaneContextMenu:re,paneClickDistance:fe,nodeClickDistance:ce,onEdgeContextMenu:Q,onEdgeMouseEnter:ae,onEdgeMouseMove:ge,onEdgeMouseLeave:Oe,reconnectRadius:Ot,onReconnect:ti,onReconnectStart:ni,onReconnectEnd:ri,noDragClassName:kn,noWheelClassName:oi,noPanClassName:Dn,disableKeyboardA11y:In,nodeExtent:ii,rfId:Mn,viewport:On,onViewportChange:xr}){return su(e),su(t),lw(),ew(n),nw(On),(0,D.jsx)(N0,{onPaneClick:G,onPaneMouseEnter:Y,onPaneMouseMove:X,onPaneMouseLeave:W,onPaneContextMenu:re,onPaneScroll:j,paneClickDistance:fe,deleteKeyCode:P,selectionKeyCode:w,selectionOnDrag:b,selectionMode:x,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:C,panActivationKeyCode:k,zoomActivationKeyCode:N,elementsSelectable:F,zoomOnScroll:T,zoomOnPinch:M,zoomOnDoubleClick:H,panOnScroll:_,panOnScrollSpeed:I,panOnScrollMode:$,panOnDrag:K,defaultViewport:B,translateExtent:L,minZoom:z,maxZoom:m,onSelectionContextMenu:u,preventScrolling:E,noDragClassName:kn,noWheelClassName:oi,noPanClassName:Dn,disableKeyboardA11y:In,onViewportChange:xr,isControlledViewport:!!On,children:(0,D.jsxs)(J0,{children:[(0,D.jsx)(j0,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:s,onReconnect:ti,onReconnectStart:ni,onReconnectEnd:ri,onlyRenderVisibleElements:A,onEdgeContextMenu:Q,onEdgeMouseEnter:ae,onEdgeMouseMove:ge,onEdgeMouseLeave:Oe,reconnectRadius:Ot,defaultMarkerColor:S,noPanClassName:Dn,disableKeyboardA11y:In,rfId:Mn}),(0,D.jsx)(sw,{style:g,type:p,component:v,containerStyle:y}),(0,D.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,D.jsx)(P0,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,nodeClickDistance:ce,onlyRenderVisibleElements:A,noPanClassName:Dn,noDragClassName:kn,disableKeyboardA11y:In,nodeExtent:ii,rfId:Mn}),(0,D.jsx)("div",{className:"react-flow__viewport-portal"})]})})}zu.displayName="GraphView";var cw=(0,R.memo)(zu),au=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:l}={})=>{let c=new Map,d=new Map,u=new Map,f=new Map,h=r??t??[],p=n??e??[],g=a??[0,0],v=l??bn;es(u,f,h),Do(p,c,d,{nodeOrigin:g,nodeExtent:v,elevateNodesOnSelect:!1});let y=[0,0,1];if(s&&o&&i){let w=xn(c,{filter:k=>!!((k.width||k.initialWidth)&&(k.height||k.initialHeight))}),{x:b,y:x,zoom:C}=Gt(w,o,i,.5,2,.1);y=[b,x,C]}return{rfId:"1",width:0,height:0,transform:y,nodes:p,nodeLookup:c,parentLookup:d,edges:h,edgeLookup:f,connectionLookup:u,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:bn,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:dt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...Ai},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Wi,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},dw=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:l})=>zd((c,d)=>({...au({nodes:e,edges:t,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:l,defaultNodes:n,defaultEdges:r}),setNodes:u=>{let{nodeLookup:f,parentLookup:h,nodeOrigin:p,elevateNodesOnSelect:g}=d();Do(u,f,h,{nodeOrigin:p,nodeExtent:l,elevateNodesOnSelect:g,checkEquality:!0}),c({nodes:u})},setEdges:u=>{let{connectionLookup:f,edgeLookup:h}=d();es(f,h,u),c({edges:u})},setDefaultNodesAndEdges:(u,f)=>{if(u){let{setNodes:h}=d();h(u),c({hasDefaultNodes:!0})}if(f){let{setEdges:h}=d();h(f),c({hasDefaultEdges:!0})}},updateNodeInternals:(u,f={triggerFitView:!0})=>{let{triggerNodeChanges:h,nodeLookup:p,parentLookup:g,fitViewOnInit:v,fitViewDone:y,fitViewOnInitOptions:w,domNode:b,nodeOrigin:x,nodeExtent:C,debug:k,fitViewSync:N}=d(),{changes:P,updatedInternals:A}=ud(u,p,g,b,x,C);if(A){if(cd(p,g,{nodeOrigin:x,nodeExtent:C}),f.triggerFitView){let F=y;!y&&v&&(F=N({...w,nodes:w?.nodes})),c({fitViewDone:F})}else c({});P?.length>0&&(k&&console.log("React Flow: trigger node changes",P),h?.(P))}},updateNodePositions:(u,f=!1)=>{let h=[],p=[],{nodeLookup:g,triggerNodeChanges:v}=d();for(let[y,w]of u){let b=g.get(y),x=!!(b?.expandParent&&b?.parentId&&w?.position),C={id:y,type:"position",position:x?{x:Math.max(0,w.position.x),y:Math.max(0,w.position.y)}:w.position,dragging:f};x&&b.parentId&&h.push({id:y,parentId:b.parentId,rect:{...w.internals.positionAbsolute,width:w.measured.width??0,height:w.measured.height??0}}),p.push(C)}if(h.length>0){let{parentLookup:y,nodeOrigin:w}=d(),b=Io(h,g,y,w);p.push(...b)}v(p)},triggerNodeChanges:u=>{let{onNodesChange:f,setNodes:h,nodes:p,hasDefaultNodes:g,debug:v}=d();if(u?.length){if(g){let y=hu(u,p);h(y)}v&&console.log("React Flow: trigger node changes",u),f?.(u)}},triggerEdgeChanges:u=>{let{onEdgesChange:f,setEdges:h,edges:p,hasDefaultEdges:g,debug:v}=d();if(u?.length){if(g){let y=pu(u,p);h(y)}v&&console.log("React Flow: trigger edge changes",u),f?.(u)}},addSelectedNodes:u=>{let{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:v}=d();if(f){let y=u.map(w=>Xt(w,!0));g(y);return}g(En(p,new Set([...u]),!0)),v(En(h))},addSelectedEdges:u=>{let{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:v}=d();if(f){let y=u.map(w=>Xt(w,!0));v(y);return}v(En(h,new Set([...u]))),g(En(p,new Set,!0))},unselectNodesAndEdges:({nodes:u,edges:f}={})=>{let{edges:h,nodes:p,nodeLookup:g,triggerNodeChanges:v,triggerEdgeChanges:y}=d(),w=u||p,b=f||h,x=w.map(k=>{let N=g.get(k.id);return N&&(N.selected=!1),Xt(k.id,!1)}),C=b.map(k=>Xt(k.id,!1));v(x),y(C)},setMinZoom:u=>{let{panZoom:f,maxZoom:h}=d();f?.setScaleExtent([u,h]),c({minZoom:u})},setMaxZoom:u=>{let{panZoom:f,minZoom:h}=d();f?.setScaleExtent([h,u]),c({maxZoom:u})},setTranslateExtent:u=>{d().panZoom?.setTranslateExtent(u),c({translateExtent:u})},setPaneClickDistance:u=>{d().panZoom?.setClickDistance(u)},resetSelectedElements:()=>{let{edges:u,nodes:f,triggerNodeChanges:h,triggerEdgeChanges:p}=d(),g=f.reduce((y,w)=>w.selected?[...y,Xt(w.id,!1)]:y,[]),v=u.reduce((y,w)=>w.selected?[...y,Xt(w.id,!1)]:y,[]);h(g),p(v)},setNodeExtent:u=>{let{nodes:f,nodeLookup:h,parentLookup:p,nodeOrigin:g,elevateNodesOnSelect:v,nodeExtent:y}=d();u[0][0]===y[0][0]&&u[0][1]===y[0][1]&&u[1][0]===y[1][0]&&u[1][1]===y[1][1]||(Do(f,h,p,{nodeOrigin:g,nodeExtent:u,elevateNodesOnSelect:v,checkEquality:!1}),c({nodeExtent:u}))},panBy:u=>{let{transform:f,width:h,height:p,panZoom:g,translateExtent:v}=d();return fd({delta:u,panZoom:g,transform:f,translateExtent:v,width:h,height:p})},fitView:u=>{let{panZoom:f,width:h,height:p,minZoom:g,maxZoom:v,nodeLookup:y}=d();if(!f)return Promise.resolve(!1);let w=wo(y,u);return vo({nodes:w,width:h,height:p,panZoom:f,minZoom:g,maxZoom:v},u)},fitViewSync:u=>{let{panZoom:f,width:h,height:p,minZoom:g,maxZoom:v,nodeLookup:y}=d();if(!f)return!1;let w=wo(y,u);return vo({nodes:w,width:h,height:p,panZoom:f,minZoom:g,maxZoom:v},u),w.size>0},cancelConnection:()=>{c({connection:{...Ai}})},updateConnection:u=>{c({connection:u})},reset:()=>c({...au()})}),Object.is);function as({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:a,nodeExtent:l,children:c}){let[d]=(0,R.useState)(()=>dw({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:l}));return(0,D.jsx)(Mx,{value:d,children:(0,D.jsx)(e0,{children:c})})}function uw({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:i,height:s,fitView:a,nodeOrigin:l,nodeExtent:c}){return(0,R.useContext)(Lo)?(0,D.jsx)(D.Fragment,{children:e}):(0,D.jsx)(as,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:i,initialHeight:s,fitView:a,nodeOrigin:l,nodeExtent:c,children:e})}var fw={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function hw({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:u,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:y,onNodeMouseEnter:w,onNodeMouseMove:b,onNodeMouseLeave:x,onNodeContextMenu:C,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:P,onNodeDragStop:A,onNodesDelete:F,onEdgesDelete:B,onDelete:L,onSelectionChange:z,onSelectionDragStart:m,onSelectionDrag:E,onSelectionDragStop:S,onSelectionContextMenu:T,onSelectionStart:M,onSelectionEnd:_,onBeforeDelete:I,connectionMode:$,connectionLineType:H=ut.Bezier,connectionLineStyle:K,connectionLineComponent:G,connectionLineContainerStyle:Y,deleteKeyCode:X="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:j=!1,selectionMode:re=Kt.Full,panActivationKeyCode:fe="Space",multiSelectionKeyCode:ce=ir()?"Meta":"Control",zoomActivationKeyCode:Q=ir()?"Meta":"Control",snapToGrid:ae,snapGrid:ge,onlyRenderVisibleElements:Oe=!1,selectNodesOnDrag:Ot,nodesDraggable:ti,nodesConnectable:ni,nodesFocusable:ri,nodeOrigin:kn=uu,edgesFocusable:oi,edgesReconnectable:Dn,elementsSelectable:In=!0,defaultViewport:ii=Kx,minZoom:Mn=.5,maxZoom:On=2,translateExtent:xr=bn,preventScrolling:bm=!0,nodeExtent:si,defaultMarkerColor:xm="#b1b1b7",zoomOnScroll:wm=!0,zoomOnPinch:vm=!0,panOnScroll:Sm=!1,panOnScrollSpeed:Em=.5,panOnScrollMode:_m=wt.Free,zoomOnDoubleClick:Cm=!0,panOnDrag:Nm=!0,onPaneClick:Tm,onPaneMouseEnter:km,onPaneMouseMove:Dm,onPaneMouseLeave:Im,onPaneScroll:Mm,onPaneContextMenu:Om,paneClickDistance:Ys=0,nodeClickDistance:Rm=0,children:Pm,onReconnect:Am,onReconnectStart:Fm,onReconnectEnd:Lm,onEdgeContextMenu:zm,onEdgeDoubleClick:Bm,onEdgeMouseEnter:$m,onEdgeMouseMove:Hm,onEdgeMouseLeave:Vm,reconnectRadius:Wm=10,onNodesChange:Km,onEdgesChange:qm,noDragClassName:Um="nodrag",noWheelClassName:Ym="nowheel",noPanClassName:Gs="nopan",fitView:Xs,fitViewOptions:Gm,connectOnClick:Xm,attributionPosition:Zm,proOptions:jm,defaultEdgeOptions:Qm,elevateNodesOnSelect:Jm,elevateEdgesOnSelect:eg,disableKeyboardA11y:Zs=!1,autoPanOnConnect:tg,autoPanOnNodeDrag:ng,autoPanSpeed:rg,connectionRadius:og,isValidConnection:ig,onError:sg,style:ag,id:js,nodeDragThreshold:lg,viewport:cg,onViewportChange:dg,width:ug,height:fg,colorMode:hg="light",debug:pg,onScroll:Qs,...mg},gg){let ai=js||"1",yg=Gx(hg),bg=(0,R.useCallback)(Js=>{Js.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Qs?.(Js)},[Qs]);return(0,D.jsx)("div",{"data-testid":"rf__wrapper",...mg,onScroll:bg,style:{...ag,...fw},ref:gg,className:ye(["react-flow",o,yg]),id:js,children:(0,D.jsxs)(uw,{nodes:e,edges:t,width:ug,height:fg,fitView:Xs,nodeOrigin:kn,nodeExtent:si,children:[(0,D.jsx)(cw,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:b,onNodeMouseLeave:x,onNodeContextMenu:C,onNodeDoubleClick:k,nodeTypes:i,edgeTypes:s,connectionLineType:H,connectionLineStyle:K,connectionLineComponent:G,connectionLineContainerStyle:Y,selectionKeyCode:W,selectionOnDrag:j,selectionMode:re,deleteKeyCode:X,multiSelectionKeyCode:ce,panActivationKeyCode:fe,zoomActivationKeyCode:Q,onlyRenderVisibleElements:Oe,defaultViewport:ii,translateExtent:xr,minZoom:Mn,maxZoom:On,preventScrolling:bm,zoomOnScroll:wm,zoomOnPinch:vm,zoomOnDoubleClick:Cm,panOnScroll:Sm,panOnScrollSpeed:Em,panOnScrollMode:_m,panOnDrag:Nm,onPaneClick:Tm,onPaneMouseEnter:km,onPaneMouseMove:Dm,onPaneMouseLeave:Im,onPaneScroll:Mm,onPaneContextMenu:Om,paneClickDistance:Ys,nodeClickDistance:Rm,onSelectionContextMenu:T,onSelectionStart:M,onSelectionEnd:_,onReconnect:Am,onReconnectStart:Fm,onReconnectEnd:Lm,onEdgeContextMenu:zm,onEdgeDoubleClick:Bm,onEdgeMouseEnter:$m,onEdgeMouseMove:Hm,onEdgeMouseLeave:Vm,reconnectRadius:Wm,defaultMarkerColor:xm,noDragClassName:Um,noWheelClassName:Ym,noPanClassName:Gs,rfId:ai,disableKeyboardA11y:Zs,nodeExtent:si,viewport:cg,onViewportChange:dg}),(0,D.jsx)(Yx,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:y,nodesDraggable:ti,nodesConnectable:ni,nodesFocusable:ri,edgesFocusable:oi,edgesReconnectable:Dn,elementsSelectable:In,elevateNodesOnSelect:Jm,elevateEdgesOnSelect:eg,minZoom:Mn,maxZoom:On,nodeExtent:si,onNodesChange:Km,onEdgesChange:qm,snapToGrid:ae,snapGrid:ge,connectionMode:$,translateExtent:xr,connectOnClick:Xm,defaultEdgeOptions:Qm,fitView:Xs,fitViewOptions:Gm,onNodesDelete:F,onEdgesDelete:B,onDelete:L,onNodeDragStart:N,onNodeDrag:P,onNodeDragStop:A,onSelectionDrag:E,onSelectionDragStart:m,onSelectionDragStop:S,onMove:d,onMoveStart:u,onMoveEnd:f,noPanClassName:Gs,nodeOrigin:kn,rfId:ai,autoPanOnConnect:tg,autoPanOnNodeDrag:ng,autoPanSpeed:rg,onError:sg,connectionRadius:og,isValidConnection:ig,selectNodesOnDrag:Ot,nodeDragThreshold:lg,onBeforeDelete:I,paneClickDistance:Ys,debug:pg}),(0,D.jsx)(Wx,{onSelectionChange:z}),Pm,(0,D.jsx)(zx,{proOptions:jm,position:Zm}),(0,D.jsx)(Fx,{rfId:ai,disableKeyboardA11y:Zs})]})})}var Bu=mu(hw);function $u(e){let[t,n]=(0,R.useState)(e),r=(0,R.useCallback)(o=>n(i=>hu(o,i)),[]);return[t,n,r]}function Hu(e){let[t,n]=(0,R.useState)(e),r=(0,R.useCallback)(o=>n(i=>pu(o,i)),[]);return[t,n,r]}var zD=Ve.error014();function pw({dimensions:e,lineWidth:t,variant:n,className:r}){return(0,D.jsx)("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ye(["react-flow__background-pattern",n,r])})}function mw({radius:e,className:t}){return(0,D.jsx)("circle",{cx:e,cy:e,r:e,className:ye(["react-flow__background-pattern","dots",t])})}var pt;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(pt||(pt={}));var gw={[pt.Dots]:1,[pt.Lines]:1,[pt.Cross]:6},yw=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Vu({id:e,variant:t=pt.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=0,color:s,bgColor:a,style:l,className:c,patternClassName:d}){let u=(0,R.useRef)(null),{transform:f,patternId:h}=ie(yw,me),p=r||gw[t],g=t===pt.Dots,v=t===pt.Cross,y=Array.isArray(n)?n:[n,n],w=[y[0]*f[2]||1,y[1]*f[2]||1],b=p*f[2],x=Array.isArray(i)?i:[i,i],C=v?[b,b]:w,k=[x[0]*f[2]||1+C[0]/2,x[1]*f[2]||1+C[1]/2],N=`${h}${e||""}`;return(0,D.jsxs)("svg",{className:ye(["react-flow__background",c]),style:{...l,...Bo,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:u,"data-testid":"rf__background",children:[(0,D.jsx)("pattern",{id:N,x:f[0]%w[0],y:f[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${k[0]},-${k[1]})`,children:g?(0,D.jsx)(mw,{radius:b/2,className:d}):(0,D.jsx)(pw,{dimensions:C,lineWidth:o,variant:t,className:d})}),(0,D.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}Vu.displayName="Background";var Wu=(0,R.memo)(Vu);function bw(){return(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,D.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function xw(){return(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,D.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function ww(){return(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,D.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function vw(){return(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,D.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Sw(){return(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,D.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Ao({children:e,className:t,...n}){return(0,D.jsx)("button",{type:"button",className:ye(["react-flow__controls-button",t]),...n,children:e})}var Ew=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Ku({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:c,children:d,position:u="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){let p=he(),{isInteractive:g,minZoomReached:v,maxZoomReached:y}=ie(Ew,me),{zoomIn:w,zoomOut:b,fitView:x}=We(),C=()=>{w(),i?.()},k=()=>{b(),s?.()},N=()=>{x(o),a?.()},P=()=>{p.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),l?.(!g)};return(0,D.jsxs)(zo,{className:ye(["react-flow__controls",f==="horizontal"?"horizontal":"vertical",c]),position:u,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Ao,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y,children:(0,D.jsx)(bw,{})}),(0,D.jsx)(Ao,{onClick:k,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:(0,D.jsx)(xw,{})})]}),n&&(0,D.jsx)(Ao,{className:"react-flow__controls-fitview",onClick:N,title:"fit view","aria-label":"fit view",children:(0,D.jsx)(ww,{})}),r&&(0,D.jsx)(Ao,{className:"react-flow__controls-interactive",onClick:P,title:"toggle interactivity","aria-label":"toggle interactivity",children:g?(0,D.jsx)(Sw,{}):(0,D.jsx)(vw,{})}),d]})}Ku.displayName="Controls";var qu=(0,R.memo)(Ku);function _w({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:u,selected:f,onClick:h}){let{background:p,backgroundColor:g}=i||{},v=s||p||g;return(0,D.jsx)("rect",{className:ye(["react-flow__minimap-node",{selected:f},c]),x:t,y:n,rx:d,ry:d,width:r,height:o,style:{fill:v,stroke:a,strokeWidth:l},shapeRendering:u,onClick:h?y=>h(y,e):void 0})}var Cw=(0,R.memo)(_w),Nw=e=>e.nodes.map(t=>t.id),os=e=>e instanceof Function?e:()=>e;function Tw({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:i=Cw,onClick:s}){let a=ie(Nw,me),l=os(t),c=os(e),d=os(n),u=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return(0,D.jsx)(D.Fragment,{children:a.map(f=>(0,D.jsx)(Dw,{id:f,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:d,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:i,onClick:s,shapeRendering:u},f))})}function kw({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:l}){let{node:c,x:d,y:u,width:f,height:h}=ie(p=>{let g=p.nodeLookup.get(e),{x:v,y}=g.internals.positionAbsolute,{width:w,height:b}=ht(g);return{node:g,x:v,y,width:w,height:b}},me);return!c||c.hidden||!qi(c)?null:(0,D.jsx)(a,{x:d,y:u,width:f,height:h,style:c.style,selected:!!c.selected,className:r(c),color:t(c),borderRadius:o,strokeColor:n(c),strokeWidth:i,shapeRendering:s,onClick:l,id:c.id})}var Dw=(0,R.memo)(kw),Iw=(0,R.memo)(Tw),Mw=200,Ow=150,Rw=e=>{let t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Hi(xn(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Pw="react-flow__minimap-desc";function Uu({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:d,maskStrokeWidth:u,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:g=!1,zoomable:v=!1,ariaLabel:y="React Flow mini map",inversePan:w,zoomStep:b=10,offsetScale:x=5}){let C=he(),k=(0,R.useRef)(null),{boundingRect:N,viewBB:P,rfId:A,panZoom:F,translateExtent:B,flowWidth:L,flowHeight:z}=ie(Rw,me),m=e?.width??Mw,E=e?.height??Ow,S=N.width/m,T=N.height/E,M=Math.max(S,T),_=M*m,I=M*E,$=x*M,H=N.x-(_-N.width)/2-$,K=N.y-(I-N.height)/2-$,G=_+$*2,Y=I+$*2,X=`${Pw}-${A}`,W=(0,R.useRef)(0),j=(0,R.useRef)();W.current=M,(0,R.useEffect)(()=>{if(k.current&&F)return j.current=xd({domNode:k.current,panZoom:F,getTransform:()=>C.getState().transform,getViewScale:()=>W.current}),()=>{j.current?.destroy()}},[F]),(0,R.useEffect)(()=>{j.current?.update({translateExtent:B,width:L,height:z,inversePan:w,pannable:g,zoomStep:b,zoomable:v})},[g,v,w,b,B,L,z]);let re=h?ce=>{let[Q,ae]=j.current?.pointer(ce)||[0,0];h(ce,{x:Q,y:ae})}:void 0,fe=p?(0,R.useCallback)((ce,Q)=>{let ae=C.getState().nodeLookup.get(Q);p(ce,ae)},[]):void 0;return(0,D.jsx)(zo,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof u=="number"?u*M:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="string"?s:void 0},className:ye(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:(0,D.jsxs)("svg",{width:m,height:E,viewBox:`${H} ${K} ${G} ${Y}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":X,ref:k,onClick:re,children:[y&&(0,D.jsx)("title",{id:X,children:y}),(0,D.jsx)(Iw,{onClick:fe,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:s,nodeComponent:a}),(0,D.jsx)("path",{className:"react-flow__minimap-mask",d:`M${H-$},${K-$}h${G+$*2}v${Y+$*2}h${-G-$*2}z
        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Uu.displayName="MiniMap";var Yu=(0,R.memo)(Uu);function Aw({nodeId:e,position:t,variant:n=Ut.Handle,className:r,style:o={},children:i,color:s,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:u=!1,shouldResize:f,onResizeStart:h,onResize:p,onResizeEnd:g}){let v=xu(),y=typeof e=="string"?e:v,w=he(),b=(0,R.useRef)(null),x=n===Ut.Line?"right":"bottom-right",C=t??x,k=(0,R.useRef)(null);(0,R.useEffect)(()=>{if(!(!b.current||!y))return k.current||(k.current=_d({domNode:b.current,nodeId:y,getStoreItems:()=>{let{nodeLookup:F,transform:B,snapGrid:L,snapToGrid:z,nodeOrigin:m,domNode:E}=w.getState();return{nodeLookup:F,transform:B,snapGrid:L,snapToGrid:z,nodeOrigin:m,paneDomNode:E}},onChange:(F,B)=>{let{triggerNodeChanges:L,nodeLookup:z,parentLookup:m,nodeOrigin:E}=w.getState(),S=[],T={x:F.x,y:F.y},M=z.get(y);if(M&&M.expandParent&&M.parentId){let _=M.origin??E,I=F.width??M.measured.width??0,$=F.height??M.measured.height??0,H={id:M.id,parentId:M.parentId,rect:{width:I,height:$,...Ui({x:F.x??M.position.x,y:F.y??M.position.y},{width:I,height:$},M.parentId,z,_)}},K=Io([H],z,m,E);S.push(...K),T.x=F.x?Math.max(_[0]*I,F.x):void 0,T.y=F.y?Math.max(_[1]*$,F.y):void 0}if(T.x!==void 0&&T.y!==void 0){let _={id:y,type:"position",position:{...T}};S.push(_)}if(F.width!==void 0&&F.height!==void 0){let _={id:y,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:F.width,height:F.height}};S.push(_)}for(let _ of B){let I={..._,type:"position"};S.push(I)}L(S)},onEnd:()=>{let F={id:y,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([F])}})),k.current.update({controlPosition:C,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:d},keepAspectRatio:u,onResizeStart:h,onResize:p,onResizeEnd:g,shouldResize:f}),()=>{k.current?.destroy()}},[C,a,l,c,d,u,h,p,g,f]);let N=C.split("-"),P=n===Ut.Line?"borderColor":"backgroundColor",A=s?{...o,[P]:s}:o;return(0,D.jsx)("div",{className:ye(["react-flow__resize-control","nodrag",...N,n,r]),ref:b,style:A,children:i})}var BD=(0,R.memo)(Aw);var xe;(n=>{let e;(a=>(a[a.CASCADE=0]="CASCADE",a[a.NO_ACTION=1]="NO_ACTION",a[a.SET_NULL=2]="SET_NULL",a[a.SET_DEFAULT=3]="SET_DEFAULT"))(e=n.OnAction||={});let t;(s=>(s[s.Created=0]="Created",s[s.Updated=1]="Updated",s[s.Dropped=2]="Dropped"))(t=n.SchemaDesignerReportTableState||={})})(xe||={});var Ms=V(yp());var Ie=[];for(let e=0;e<256;++e)Ie.push((e+256).toString(16).slice(1));function bp(e,t=0){return(Ie[e[t+0]]+Ie[e[t+1]]+Ie[e[t+2]]+Ie[e[t+3]]+"-"+Ie[e[t+4]]+Ie[e[t+5]]+"-"+Ie[e[t+6]]+Ie[e[t+7]]+"-"+Ie[e[t+8]]+Ie[e[t+9]]+"-"+Ie[e[t+10]]+Ie[e[t+11]]+Ie[e[t+12]]+Ie[e[t+13]]+Ie[e[t+14]]+Ie[e[t+15]]).toLowerCase()}var ks,qE=new Uint8Array(16);function Ds(){if(!ks){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ks=crypto.getRandomValues.bind(crypto)}return ks(qE)}var UE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Is={randomUUID:UE};function YE(e,t,n){if(Is.randomUUID&&!t&&!e)return Is.randomUUID();e=e||{};let r=e.random??e.rng?.()??Ds();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let o=0;o<16;++o)t[n+o]=r[o];return t}return bp(r)}var it=YE;var en={getNextColumnName:e=>{let t=1;for(;e.some(n=>n.name===`column_${t}`);)t++;return`column_${t}`},getNextForeignKeyName:(e,t)=>{let n=new Set;for(let o of t)for(let i of o.foreignKeys)n.add(i.name);for(let o of e)n.add(o.name);let r=1;for(;n.has(`FK_${r}`);)r++;return`FK_${r}`},getNextTableName:e=>{let t=1;for(;e.some(n=>n.name===`table_${t}`);)t++;return`table_${t}`}},mt={getAllTables:(e,t)=>e.tables.filter(n=>n.schema!==t.schema||n.name!==t.name).sort(),getTableFromDisplayName:(e,t)=>e.tables.find(n=>`${n.schema}.${n.name}`===t),tableNameValidationError:(e,t)=>{if(e.tables.find(r=>r.name.toLowerCase()===t.name.toLowerCase()&&r.schema.toLowerCase()===t.schema.toLowerCase()&&r.id!==t.id))return O.schemaDesigner.tableNameRepeatedError(t.name);if(!t.name)return O.schemaDesigner.tableNameEmptyError},createNewTable:(e,t)=>({name:en.getNextTableName(e.tables),schema:t[0],columns:[{name:"Id",dataType:"int",maxLength:"",precision:0,scale:0,isNullable:!1,isPrimaryKey:!0,id:it(),isIdentity:!0,identitySeed:1,identityIncrement:1,defaultValue:"",isComputed:!1,computedFormula:"",computedPersisted:!1}],foreignKeys:[],id:it()})},ve={isColumnValid:(e,t)=>{if(t.find(r=>r.name.toLowerCase()===e.name.toLowerCase()&&r.id!==e.id&&r.dataType===e.dataType))return O.schemaDesigner.columnNameRepeatedError(e.name);if(!e.name)return O.schemaDesigner.columnNameEmptyError;if(e.isPrimaryKey&&e.isNullable)return O.schemaDesigner.columnPKCannotBeNull(e.name);if(ve.isLengthBasedType(e.dataType)){if(!e.maxLength)return O.schemaDesigner.columnMaxLengthEmptyError;if(e.maxLength&&e.maxLength!=="MAX"){let r=parseInt(e.maxLength);if(isNaN(r)||r<=0)return O.schemaDesigner.columnMaxLengthInvalid(e.maxLength)}}},isLengthBasedType:e=>["char","varchar","nchar","nvarchar","binary","varbinary","vector"].includes(e),isTimeBasedWithScale:e=>["datetime2","datetimeoffset","time"].includes(e),isPrecisionBasedType:e=>["decimal","numeric"].includes(e),isIdentityBasedType:(e,t)=>e==="decimal"||e==="numeric"?t===0:["int","bigint","smallint","tinyint"].includes(e),getDefaultLength:e=>{switch(e){case"char":case"nchar":case"binary":case"vector":return"1";case"varchar":case"nvarchar":case"varbinary":return"50";default:return"0"}},getDefaultPrecision:e=>{switch(e){case"decimal":case"numeric":return 18;default:return 0}},getDefaultScale:e=>{switch(e){case"decimal":case"numeric":return 0;default:return 0}},fillColumnDefaults:e=>(ve.isLengthBasedType(e.dataType)?e.maxLength=ve.getDefaultLength(e.dataType):e.maxLength="",ve.isPrecisionBasedType(e.dataType)?(e.precision=ve.getDefaultPrecision(e.dataType),e.scale=ve.getDefaultScale(e.dataType)):(e.precision=0,e.scale=0),ve.isTimeBasedWithScale(e.dataType)?e.scale=ve.getDefaultScale(e.dataType):e.scale=0,e),getAdvancedOptions:e=>{let t=[];return e.isPrimaryKey||t.push({label:O.schemaDesigner.allowNull,type:"checkbox",value:!1,columnProperty:"isNullable",columnModifier:(n,r)=>(n.isNullable=r,n)}),e.isComputed||(ve.isIdentityBasedType(e.dataType,e.scale)&&(!e.isNullable||e.isPrimaryKey)&&t.push({label:O.schemaDesigner.isIdentity,value:"isIdentity",type:"checkbox",columnProperty:"isIdentity",columnModifier:(n,r)=>(n.isIdentity=r,n.identitySeed=r?1:0,n.identityIncrement=r?1:0,n)}),ve.isLengthBasedType(e.dataType)&&t.push({label:O.schemaDesigner.maxLength,value:"",type:"input",columnProperty:"maxLength",columnModifier:(n,r)=>(n.maxLength=r,n.maxLength||(n.maxLength="0"),n)}),ve.isPrecisionBasedType(e.dataType)&&t.push({label:O.schemaDesigner.precision,value:"",type:"input-number",columnProperty:"precision",columnModifier:(n,r)=>(n.precision=r,n)}),(ve.isTimeBasedWithScale(e.dataType)||ve.isPrecisionBasedType(e.dataType))&&t.push({label:O.schemaDesigner.scale,value:"",type:"input-number",columnProperty:"scale",columnModifier:(n,r)=>(n.scale=r,n)}),t.push({label:O.schemaDesigner.defaultValue,value:"",type:"textarea",columnProperty:"defaultValue",columnModifier:(n,r)=>(n.defaultValue=r,n)})),t.push({label:O.schemaDesigner.isComputed,value:!1,type:"checkbox",columnProperty:"isComputed",columnModifier:(n,r)=>(n.isComputed=r,n.isPrimaryKey=!1,n.isIdentity=!1,n.identitySeed=0,n.identityIncrement=0,n.isNullable=!0,n.computedFormula=r?"1":"",n.computedPersisted=!1,n.dataType=r?"int":n.dataType,n)}),e.isComputed&&(t.push({label:O.schemaDesigner.computedFormula,value:"",type:"textarea",columnProperty:"computedFormula",columnModifier:(n,r)=>(n.computedFormula=r,n)}),t.push({label:O.schemaDesigner.isPersisted,value:!1,type:"checkbox",columnProperty:"computedPersisted",columnModifier:(n,r)=>(n.computedPersisted=r,n)})),t}},le={areDataTypesCompatible:(e,t)=>e.dataType!==t.dataType?{isValid:!1,errorMessage:O.schemaDesigner.incompatibleDataTypes(e.dataType,e.name,t.dataType,t.name)}:ve.isLengthBasedType(e.dataType)&&e.maxLength!==t.maxLength?{isValid:!1,errorMessage:O.schemaDesigner.incompatibleLength(e.name,t.name,e.maxLength,t.maxLength)}:ve.isPrecisionBasedType(e.dataType)&&(e.precision!==t.precision||e.scale!==t.scale)?{isValid:!1,errorMessage:O.schemaDesigner.incompatiblePrecisionOrScale(e.name,t.name)}:ve.isTimeBasedWithScale(e.dataType)&&e.scale!==t.scale?{isValid:!1,errorMessage:O.schemaDesigner.incompatibleScale(e.name,t.name)}:{isValid:!0},isCyclicForeignKey:(e,t,n,r=new Set)=>{if(!t||!n)return!1;if(r.has(t.id))return!0;r.add(t.id);for(let o of t.foreignKeys){let i=e.find(s=>s.name===o.referencedTableName&&s.schema===o.referencedSchemaName);if(i&&(i.id===n.id||le.isCyclicForeignKey(e,i,n,new Set(r))))return!0}return!1},isForeignKeyValid:(e,t,n)=>{let r=e.find(s=>s.name===n.referencedTableName&&s.schema===n.referencedSchemaName);if(!r)return{isValid:!1,errorMessage:O.schemaDesigner.referencedTableNotFound(n.referencedTableName)};let o=t.foreignKeys.filter(s=>s.id!==n.id),i=new Set;for(let s of o)for(let a of s.columns)i.add(a);for(let s of n.columns){if(i.has(s))return{isValid:!1,errorMessage:O.schemaDesigner.duplicateForeignKeyColumns(s)};i.add(s)}for(let s=0;s<n.columns.length;s++){let a=t.columns.find(d=>d.name===n.columns[s]),l=r.columns.find(d=>d.name===n.referencedColumns[s]);if(!a)return{isValid:!1,errorMessage:O.schemaDesigner.columnNotFound(n.columns[s])};if(!l)return{isValid:!1,errorMessage:O.schemaDesigner.referencedColumnNotFound(n.referencedColumns[s])};let c=le.areDataTypesCompatible(a,l);if(!c.isValid)return c;if(!l.isPrimaryKey)return{isValid:!1,errorMessage:O.schemaDesigner.referencedColumnNotPK(l.name)};if(a.isIdentity&&(n.onUpdateAction!==xe.OnAction.NO_ACTION||n.onDeleteAction!==xe.OnAction.NO_ACTION))return{isValid:!1,errorMessage:O.schemaDesigner.identityColumnFKConstraint(a.name)}}return{isValid:!0}},getForeignKeyWarnings:(e,t,n)=>{let r=!1,o=[],i=e.find(s=>s.name===n.referencedTableName&&s.schema===n.referencedSchemaName);return i?(n.name||(r=!0,o.push(O.schemaDesigner.foreignKeyNameEmptyWarning)),le.isCyclicForeignKey(e,i,t)&&(r=!0,o.push(O.schemaDesigner.cyclicForeignKeyDetected(t.name,i.name))),{isValid:!r,errorMessage:r?o.join(", "):void 0}):{isValid:!1,errorMessage:O.schemaDesigner.referencedTableNotFound(n.referencedTableName)}},extractForeignKeysFromEdges:(e,t,n)=>{let r=e.filter(i=>i.source===t),o=new Map;return r.forEach(i=>{let s=n.tables.find(c=>c.id===i.source),a=n.tables.find(c=>c.id===i.target);if(!s||!a||!i.data)return;let l={id:i.data.id,columns:[...i.data.columns],name:i.data.name,onDeleteAction:i.data.onDeleteAction,onUpdateAction:i.data.onUpdateAction,referencedColumns:[...i.data.referencedColumns],referencedSchemaName:i.data.referencedSchemaName,referencedTableName:i.data.referencedTableName};if(o.has(i.data.id)){let c=o.get(i.data.id);c&&(c.columns.push(...l.columns),c.referencedColumns.push(...l.referencedColumns))}else o.set(i.data.id,l)}),Array.from(o.values())},extractColumnNameFromHandle:e=>e.replace("left-","").replace("right-",""),createForeignKeyFromConnection:(e,t,n,r,o,i)=>({id:o||it(),name:i||`FK_${e.data.name}_${t.data.name}`,columns:[n],referencedSchemaName:t.data.schema,referencedTableName:t.data.name,referencedColumns:[r],onDeleteAction:xe.OnAction.NO_ACTION,onUpdateAction:xe.OnAction.NO_ACTION}),validateConnection:(e,t,n)=>{let r=t.find(l=>l.id===e.source),o=t.find(l=>l.id===e.target);if(!r||!o)return{isValid:!1,errorMessage:"Source or target table not found"};let i=e.sourceHandle?le.extractColumnNameFromHandle(e.sourceHandle):"",s=e.targetHandle?le.extractColumnNameFromHandle(e.targetHandle):"";if(!i||!s)return{isValid:!1,errorMessage:"Source or target column not found"};let a=le.createForeignKeyFromConnection(r,o,i,s);return le.isForeignKeyValid(pe.extractSchemaModel(t,n).tables,r.data,a)},getOnActionOptions:()=>[{label:O.schemaDesigner.cascade,value:xe.OnAction.CASCADE},{label:O.schemaDesigner.noAction,value:xe.OnAction.NO_ACTION},{label:O.schemaDesigner.setNull,value:xe.OnAction.SET_NULL},{label:O.schemaDesigner.setDefault,value:xe.OnAction.SET_DEFAULT}],convertStringToOnAction:e=>{switch(e){case O.schemaDesigner.cascade:return xe.OnAction.CASCADE;case O.schemaDesigner.noAction:return xe.OnAction.NO_ACTION;case O.schemaDesigner.setNull:return xe.OnAction.SET_NULL;case O.schemaDesigner.setDefault:return xe.OnAction.SET_DEFAULT;default:return xe.OnAction.NO_ACTION}},convertOnActionToString:e=>{switch(e){case xe.OnAction.CASCADE:return O.schemaDesigner.cascade;case xe.OnAction.NO_ACTION:return O.schemaDesigner.noAction;case xe.OnAction.SET_NULL:return O.schemaDesigner.setNull;case xe.OnAction.SET_DEFAULT:return O.schemaDesigner.setDefault;default:return O.schemaDesigner.noAction}}},Jt={NODE_WIDTH:300,NODE_MARGIN:50,BASE_NODE_HEIGHT:70,COLUMN_HEIGHT:30,LAYOUT_OPTIONS:{rankdir:"LR",marginx:50,marginy:50,nodesep:50,ranksep:50}},pe={getTableWidth:()=>Jt.NODE_WIDTH+Jt.NODE_MARGIN,getTableHeight:e=>Jt.BASE_NODE_HEIGHT+e.columns.length*Jt.COLUMN_HEIGHT,generateSchemaDesignerFlowComponents:e=>{if(!e)return{nodes:[],edges:[]};let t=new Ms.default.graphlib.Graph().setDefaultEdgeLabel(()=>({}));t.setGraph(Jt.LAYOUT_OPTIONS);let n=e.tables.map(i=>({id:i.id,type:"tableNode",data:{...i}}));n.forEach(i=>{t.setNode(i.id,{width:pe.getTableWidth(),height:pe.getTableHeight(i.data)}),i.data.foreignKeys.forEach(s=>{let a=e.tables.find(l=>l.name===s.referencedTableName&&l.schema===s.referencedSchemaName);a&&t.setEdge(i.id,a.id)})}),Ms.default.layout(t);let r=n.map(i=>{let s=t.node(i.id);return{...i,position:{x:s.x-pe.getTableWidth()/2,y:s.y-pe.getTableHeight(i.data)/2}}}),o=[];for(let i of e.tables)for(let s of i.foreignKeys){let a=e.tables.find(l=>l.name===s.referencedTableName&&l.schema===s.referencedSchemaName);a&&s.columns.forEach((l,c)=>{let d=s.referencedColumns[c];o.push({id:`${i.name}-${a.name}-${l}-${d}`,source:i.id,target:a.id,sourceHandle:`right-${l}`,targetHandle:`left-${d}`,markerEnd:{type:ft.ArrowClosed},data:{name:s.name,id:s.id,columns:[l],referencedSchemaName:s.referencedSchemaName,referencedTableName:s.referencedTableName,referencedColumns:[d],onDeleteAction:s.onDeleteAction,onUpdateAction:s.onUpdateAction}})})}return{nodes:r,edges:o}},extractSchemaModel:(e,t)=>{let n=e.map(r=>({...r.data,foreignKeys:[]}));return t.forEach(r=>{let o=e.find(c=>c.id===r.source),i=e.find(c=>c.id===r.target);if(!o||!i||!r.data){console.warn(`Edge ${r.id} references non-existent nodes or has no data`);return}let s={id:r.data.id,name:r.data.name,columns:[...r.data.columns],referencedSchemaName:r.data.referencedSchemaName,referencedTableName:r.data.referencedTableName,referencedColumns:[...r.data.referencedColumns],onDeleteAction:r.data.onDeleteAction,onUpdateAction:r.data.onUpdateAction},a=n.find(c=>c.id===r.source);if(!a){console.warn(`Source table ${r.source} not found`);return}let l=a.foreignKeys.find(c=>c.id===s.id);l?(l.columns.push(s.columns[0]),l.referencedColumns.push(s.referencedColumns[0])):a.foreignKeys.push(s)}),{tables:n}}};var Uo=class{listeners={};on(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)}off(t,n){this.listeners[t]=this.listeners[t]?.filter(r=>r!==n)}emit(t,...n){this.listeners[t]?.forEach(r=>r(...n))}once(t,n){let r=(...o)=>{this.off(t,r),n(...o)};this.on(t,r)}};var GE=new Uo,J=GE;var Yo=class{undoStack=[];redoStack=[];maxSize;currentState=null;constructor(t=100){this.maxSize=t}getCurrentState(){return this.currentState}setInitialState(t){this.currentState=t,this.clearHistory()}pushState(t,n){let r=this.currentState;JSON.stringify(r)!==JSON.stringify(t)&&(this.undoStack.push({undo:n||(()=>r),redo:()=>t}),this.currentState=t,this.redoStack=[],this.undoStack.length>this.maxSize&&this.undoStack.shift())}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){if(!this.canUndo())return null;let t=this.undoStack.pop(),n=t.undo(),r=this.currentState;return this.redoStack.push({undo:()=>r,redo:t.redo}),this.currentState=n,n}redo(){if(!this.canRedo())return null;let n=this.redoStack.pop().redo(),r=this.currentState;return this.undoStack.push({undo:()=>r,redo:()=>n}),this.currentState=n,n}clearHistory(){this.undoStack=[],this.redoStack=[]}getStackSizes(){return{undoSize:this.undoStack.length,redoSize:this.redoStack.length}}};var wp=V(te()),ue=(0,Mt.createContext)(void 0),Fe=new Yo,xp=({children:e})=>{let t=Ya(),{state:n,extensionRpc:r,themeKind:o}=t,[i,s]=(0,Mt.useState)([]),[a,l]=(0,Mt.useState)([]),c=We(),[d,u]=(0,Mt.useState)(!1);(0,Mt.useEffect)(()=>{let m=()=>{setTimeout(()=>{let T=c.toObject();Fe.pushState(T),J.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo())},100)};J.on("pushState",m);let E=()=>{if(!Fe.canUndo())return;let T=Fe.undo();T&&(c.setNodes(T.nodes),c.setEdges(T.edges),J.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo()))};J.on("undo",E);let S=()=>{if(!Fe.canRedo())return;let T=Fe.redo();T&&(c.setNodes(T.nodes),c.setEdges(T.edges),J.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo()))};return J.on("redo",S),()=>{J.off("pushState",m),J.off("undo",E),J.off("redo",S)}},[]);let f=async()=>{let m=await r.call("initializeSchemaDesigner"),{nodes:E,edges:S}=pe.generateSchemaDesignerFlowComponents(m.schema);return s(m.dataTypes),l(m.schemaNames),u(!0),setTimeout(()=>{Fe.setInitialState(c.toObject())}),{nodes:E,edges:S}},h=async()=>{let m=pe.extractSchemaModel(c.getNodes(),c.getEdges());return(await r.call("getScript",{updatedSchema:m})).combinedScript},p=m=>{r.call("exportToFile",{...m})},g=async()=>{let m=pe.extractSchemaModel(c.getNodes(),c.getEdges());return m?await r.call("getReport",{updatedSchema:m}):void 0},v=m=>{r.call("copyToClipboard",{text:m})},y=m=>{r.call("openInEditor",{text:m})},w=m=>{r.call("openInEditorWithConnection",{text:m})},b=()=>pe.extractSchemaModel(c.getNodes(),c.getEdges()),x=async m=>{let E={id:m.id,type:"tableNode",data:{...m},position:{x:0,y:0}},S=pe.extractSchemaModel(c.getNodes(),c.getEdges());S.tables.push(E.data);let T=pe.generateSchemaDesignerFlowComponents(S),M=T.nodes.find(I=>I.id===E.id),_=T.edges.filter(I=>I.source===E.id||I.target===E.id);return M?(M.selected=!0,c.addNodes(M),c.addEdges(_),requestAnimationFrame(async()=>{F(M.id,!0)}),J.emit("getScript"),!0):!1},C=async m=>{let E=pe.extractSchemaModel(c.getNodes(),c.getEdges()),S=E.tables.find(H=>H.id===m.id);if(!S)return console.warn(`Table with id ${m.id} not found`),!1;for(let H of E.tables)H.id!==m.id&&H.foreignKeys.forEach(K=>{K.referencedSchemaName===S.schema&&K.referencedTableName===S.name&&(K.referencedSchemaName=m.schema,K.referencedTableName=m.name)});let T={...S,...m},M={...E,tables:E.tables.map(H=>H.id===m.id?T:H)},_=c.getEdges().filter(H=>H.source===m.id||H.target===m.id);await c.deleteElements({nodes:[],edges:_});let I=pe.generateSchemaDesignerFlowComponents(M),$=I.nodes.find(H=>H.id===m.id);if($){let H=I.edges.filter(K=>K.source===m.id||K.target===m.id);return c.updateNodeData($.id,$.data),c.addEdges(H),!0}return!1},k=async m=>{let E=c.getNode(m.id);if(!E)return!1;c.deleteElements({nodes:[E]}),J.emit("pushState")},N=m=>{let E=b(),S=E.tables.find(T=>T.id===m);if(S)return S.foreignKeys=le.extractForeignKeysFromEdges(c.getEdges(),m,E),S},P=()=>{let m=c.getNodes().filter(E=>E.selected);if(m.length>0)c.deleteElements({nodes:m});else{let E=c.getEdges().filter(S=>S.selected);c.deleteElements({nodes:[],edges:E})}},A=m=>{c.getNodes().forEach(E=>{c.updateNode(E.id,{selected:m.includes(E.id)})})},F=(m,E=!1)=>{let S=c.getNode(m);S&&c.setCenter(S.position.x+pe.getTableWidth()/2,S.position.y+pe.getTableHeight(S.data)/2,{zoom:E?1:c.getZoom(),duration:500})},B=async()=>await r.call("publishSession"),L=()=>{r.call("closeDesigner",{})},z=()=>{Fe.clearHistory(),J.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo())};return(0,wp.jsx)(ue.Provider,{value:{...Xa(t),extensionRpc:r,state:n,themeKind:o,schemaNames:a,datatypes:i,getScript:h,initializeSchemaDesigner:f,saveAsFile:p,getReport:g,openInEditor:y,openInEditorWithConnection:w,copyToClipboard:v,extractSchema:b,getTableWithForeignKeys:N,updateTable:C,addTable:x,deleteTable:k,deleteSelectedNodes:P,updateSelectedNodes:A,setCenter:F,publishSession:B,isInitialized:d,closeDesigner:L,resetUndoRedoState:z},children:e})};var ei=V(de());var Os=V(te());function vp(){return(0,Os.jsx)(ke,{icon:(0,Os.jsx)(xa,{}),title:O.schemaDesigner.viewCode,appearance:"subtle",onClick:()=>{J.emit("openCodeDrawer")},children:O.schemaDesigner.viewCode})}function Sp(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;let n=document.implementation.createHTMLDocument(),r=n.createElement("base"),o=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(o),t&&(r.href=t),o.href=e,o.href}var Ep=(()=>{let e=0,t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Ue(e){let t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}function Go(e,t){let r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function XE(e){let t=Go(e,"border-left-width"),n=Go(e,"border-right-width");return e.clientWidth+t+n}function ZE(e){let t=Go(e,"border-top-width"),n=Go(e,"border-bottom-width");return e.clientHeight+t+n}function Rs(e,t={}){let n=t.width||XE(e),r=t.height||ZE(e);return{width:n,height:r}}function _p(){let e,t;try{t=process}catch{}let n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}var qe=16384;function Cp(e){(e.width>qe||e.height>qe)&&(e.width>qe&&e.height>qe?e.width>e.height?(e.height*=qe/e.width,e.width=qe):(e.width*=qe/e.height,e.height=qe):e.width>qe?(e.height*=qe/e.width,e.width=qe):(e.width*=qe/e.height,e.height=qe))}function _n(e){return new Promise((t,n)=>{let r=new Image;r.decode=()=>t(r),r.onload=()=>t(r),r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function jE(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function Np(e,t,n){let r="http://www.w3.org/2000/svg",o=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return o.setAttribute("width",`${t}`),o.setAttribute("height",`${n}`),o.setAttribute("viewBox",`0 0 ${t} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),o.appendChild(i),i.appendChild(e),jE(o)}var Re=(e,t)=>{if(e instanceof t)return!0;let n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||Re(n,t)};function QE(e){let t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function JE(e){return Ue(e).map(t=>{let n=e.getPropertyValue(t),r=e.getPropertyPriority(t);return`${t}: ${n}${r?" !important":""};`}).join(" ")}function e_(e,t,n){let r=`.${e}:${t}`,o=n.cssText?QE(n):JE(n);return document.createTextNode(`${r}{${o}}`)}function Tp(e,t,n){let r=window.getComputedStyle(e,n),o=r.getPropertyValue("content");if(o===""||o==="none")return;let i=Ep();try{t.className=`${t.className} ${i}`}catch{return}let s=document.createElement("style");s.appendChild(e_(i,n,r)),t.appendChild(s)}function kp(e,t){Tp(e,t,":before"),Tp(e,t,":after")}var Dp="application/font-woff",Ip="image/jpeg",t_={woff:Dp,woff2:Dp,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Ip,jpeg:Ip,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function n_(e){let t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Cn(e){let t=n_(e).toLowerCase();return t_[t]||""}function r_(e){return e.split(/,/)[1]}function hr(e){return e.search(/^(data:)/)!==-1}function As(e,t){return`data:${t};base64,${e}`}async function Fs(e,t,n){let r=await fetch(e,t);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);let o=await r.blob();return new Promise((i,s)=>{let a=new FileReader;a.onerror=s,a.onloadend=()=>{try{i(n({res:r,result:a.result}))}catch(l){s(l)}},a.readAsDataURL(o)})}var Ps={};function o_(e,t,n){let r=e.replace(/\?.*/,"");return n&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}async function Nn(e,t,n){let r=o_(e,t,n.includeQueryParams);if(Ps[r]!=null)return Ps[r];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let o;try{let i=await Fs(e,n.fetchRequestInit,({res:s,result:a})=>(t||(t=s.headers.get("Content-Type")||""),r_(a)));o=As(i,t)}catch(i){o=n.imagePlaceholder||"";let s=`Failed to fetch resource: ${e}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return Ps[r]=o,o}async function i_(e){let t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):_n(t)}async function s_(e,t){if(e.currentSrc){let i=document.createElement("canvas"),s=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,s?.drawImage(e,0,0,i.width,i.height);let a=i.toDataURL();return _n(a)}let n=e.poster,r=Cn(n),o=await Nn(n,r,t);return _n(o)}async function a_(e){var t;try{if(!((t=e?.contentDocument)===null||t===void 0)&&t.body)return await pr(e.contentDocument.body,{},!0)}catch{}return e.cloneNode(!1)}async function l_(e,t){return Re(e,HTMLCanvasElement)?i_(e):Re(e,HTMLVideoElement)?s_(e,t):Re(e,HTMLIFrameElement)?a_(e):e.cloneNode(!1)}var c_=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";async function d_(e,t,n){var r,o;let i=[];return c_(e)&&e.assignedNodes?i=Ue(e.assignedNodes()):Re(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?i=Ue(e.contentDocument.body.childNodes):i=Ue(((o=e.shadowRoot)!==null&&o!==void 0?o:e).childNodes),i.length===0||Re(e,HTMLVideoElement)||await i.reduce((s,a)=>s.then(()=>pr(a,n)).then(l=>{l&&t.appendChild(l)}),Promise.resolve()),t}function u_(e,t){let n=t.style;if(!n)return;let r=window.getComputedStyle(e);r.cssText?(n.cssText=r.cssText,n.transformOrigin=r.transformOrigin):Ue(r).forEach(o=>{let i=r.getPropertyValue(o);o==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),Re(e,HTMLIFrameElement)&&o==="display"&&i==="inline"&&(i="block"),o==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(o,i,r.getPropertyPriority(o))})}function f_(e,t){Re(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Re(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function h_(e,t){if(Re(e,HTMLSelectElement)){let n=t,r=Array.from(n.children).find(o=>e.value===o.getAttribute("value"));r&&r.setAttribute("selected","")}}function p_(e,t){return Re(t,Element)&&(u_(e,t),kp(e,t),f_(e,t),h_(e,t)),t}async function m_(e,t){let n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;let r={};for(let i=0;i<n.length;i++){let a=n[i].getAttribute("xlink:href");if(a){let l=e.querySelector(a),c=document.querySelector(a);!l&&c&&!r[a]&&(r[a]=await pr(c,t,!0))}}let o=Object.values(r);if(o.length){let i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";let a=document.createElementNS(i,"defs");s.appendChild(a);for(let l=0;l<o.length;l++)a.appendChild(o[l]);e.appendChild(s)}return e}async function pr(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(r=>l_(r,t)).then(r=>d_(e,r,t)).then(r=>p_(e,r)).then(r=>m_(r,t))}var Mp=/url\((['"]?)([^'"]+?)\1\)/g,g_=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,y_=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function b_(e){let t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function x_(e){let t=[];return e.replace(Mp,(n,r,o)=>(t.push(o),n)),t.filter(n=>!hr(n))}async function w_(e,t,n,r,o){try{let i=n?Sp(t,n):t,s=Cn(t),a;if(o){let l=await o(i);a=As(l,s)}else a=await Nn(i,s,r);return e.replace(b_(t),`$1${a}$3`)}catch{}return e}function v_(e,{preferredFontFormat:t}){return t?e.replace(y_,n=>{for(;;){let[r,,o]=g_.exec(n)||[];if(!o)return"";if(o===t)return`src: ${r};`}}):e}function Ls(e){return e.search(Mp)!==-1}async function Xo(e,t,n){if(!Ls(e))return e;let r=v_(e,n);return x_(r).reduce((i,s)=>i.then(a=>w_(a,s,t,n)),Promise.resolve(r))}async function Zo(e,t,n){var r;let o=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(o){let i=await Xo(o,null,n);return t.style.setProperty(e,i,t.style.getPropertyPriority(e)),!0}return!1}async function S_(e,t){await Zo("background",e,t)||await Zo("background-image",e,t),await Zo("mask",e,t)||await Zo("mask-image",e,t)}async function E_(e,t){let n=Re(e,HTMLImageElement);if(!(n&&!hr(e.src))&&!(Re(e,SVGImageElement)&&!hr(e.href.baseVal)))return;let r=n?e.src:e.href.baseVal,o=await Nn(r,Cn(r),t);await new Promise((i,s)=>{e.onload=i,e.onerror=s;let a=e;a.decode&&(a.decode=i),a.loading==="lazy"&&(a.loading="eager"),n?(e.srcset="",e.src=o):e.href.baseVal=o})}async function __(e,t){let r=Ue(e.childNodes).map(o=>zs(o,t));await Promise.all(r).then(()=>e)}async function zs(e,t){Re(e,Element)&&(await S_(e,t),await E_(e,t),await __(e,t))}function Op(e,t){let{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);let r=t.style;return r!=null&&Object.keys(r).forEach(o=>{n[o]=r[o]}),e}var Rp={};async function Pp(e){let t=Rp[e];if(t!=null)return t;let r=await(await fetch(e)).text();return t={url:e,cssText:r},Rp[e]=t,t}async function Ap(e,t){let n=e.cssText,r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async s=>{let a=s.replace(r,"$1");return a.startsWith("https://")||(a=new URL(a,e.url).href),Fs(a,t.fetchRequestInit,({result:l})=>(n=n.replace(s,`url(${l})`),[s,l]))});return Promise.all(i).then(()=>n)}function Fp(e){if(e==null)return[];let t=[],n=/(\/\*[\s\S]*?\*\/)/gi,r=e.replace(n,""),o=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){let l=o.exec(r);if(l===null)break;t.push(l[0])}r=r.replace(o,"");let i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(s,"gi");for(;;){let l=i.exec(r);if(l===null){if(l=a.exec(r),l===null)break;i.lastIndex=a.lastIndex}else a.lastIndex=i.lastIndex;t.push(l[0])}return t}async function C_(e,t){let n=[],r=[];return e.forEach(o=>{if("cssRules"in o)try{Ue(o.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let a=s+1,l=i.href,c=Pp(l).then(d=>Ap(d,t)).then(d=>Fp(d).forEach(u=>{try{o.insertRule(u,u.startsWith("@import")?a+=1:o.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:u,error:f})}})).catch(d=>{console.error("Error loading remote css",d.toString())});r.push(c)}})}catch(i){let s=e.find(a=>a.href==null)||document.styleSheets[0];o.href!=null&&r.push(Pp(o.href).then(a=>Ap(a,t)).then(a=>Fp(a).forEach(l=>{s.insertRule(l,o.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(e.forEach(o=>{if("cssRules"in o)try{Ue(o.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${o.href}`,i)}}),n))}function N_(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Ls(t.style.getPropertyValue("src")))}async function T_(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");let n=Ue(e.ownerDocument.styleSheets),r=await C_(n,t);return N_(r)}async function Lp(e,t){let n=await T_(e,t);return(await Promise.all(n.map(o=>{let i=o.parentStyleSheet?o.parentStyleSheet.href:null;return Xo(o.cssText,i,t)}))).join(`
`)}async function zp(e,t){let n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Lp(e,t);if(n){let r=document.createElement("style"),o=document.createTextNode(n);r.appendChild(o),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function Bs(e,t={}){let{width:n,height:r}=Rs(e,t),o=await pr(e,t,!0);return await zp(o,t),await zs(o,t),Op(o,t),await Np(o,n,r)}async function Bp(e,t={}){let{width:n,height:r}=Rs(e,t),o=await Bs(e,t),i=await _n(o),s=document.createElement("canvas"),a=s.getContext("2d"),l=t.pixelRatio||_p(),c=t.canvasWidth||n,d=t.canvasHeight||r;return s.width=c*l,s.height=d*l,t.skipAutoScale||Cp(s),s.style.width=`${c}`,s.style.height=`${d}`,t.backgroundColor&&(a.fillStyle=t.backgroundColor,a.fillRect(0,0,s.width,s.height)),a.drawImage(i,0,0,s.width,s.height),s}async function $p(e,t={}){return(await Bp(e,t)).toDataURL()}async function Hp(e,t={}){return(await Bp(e,t)).toDataURL("image/jpeg",t.quality||1)}var Vp=V(de()),st=V(te());function Wp(){let{getNodes:e}=We(),t=(0,Vp.useContext)(ue);async function n(r){let o=document.querySelector(".react-flow__viewport"),s=getComputedStyle(o).getPropertyValue("--vscode-editor-background"),a=rr(e()),l=Gt(a,a.width,a.height,.5,2,50),c=a.width+100,d=a.height+100;switch(r){case"png":$p(o,{width:c,height:d,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${d}px`}}).then(u=>{t.saveAsFile({format:r,fileContents:u,width:c,height:d})});break;case"jpeg":Hp(o,{width:c,height:d,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${d}px`}}).then(u=>{t.saveAsFile({format:r,fileContents:u,width:c,height:d})});break;case"svg":Bs(o,{width:c,height:d,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${d}px`}}).then(u=>{t.saveAsFile({format:r,fileContents:u,width:c,height:d})});break}}return(0,st.jsxs)(rn,{children:[(0,st.jsx)(sn,{disableButtonEnhancement:!0,children:(0,st.jsx)(ke,{icon:(0,st.jsx)(ma,{}),title:O.schemaDesigner.export,appearance:"subtle",children:O.schemaDesigner.export})}),(0,st.jsx)(on,{children:(0,st.jsxs)(_r,{children:[(0,st.jsx)(At,{onClick:()=>n("svg"),children:O.schemaDesigner.svg}),(0,st.jsx)(At,{onClick:()=>n("png"),children:O.schemaDesigner.png}),(0,st.jsx)(At,{onClick:()=>n("jpeg"),children:O.schemaDesigner.jpeg})]})})]})}var St=V(de());var $e=V(te());function Kp(){let e=(0,St.useContext)(ue),t=We();if(!e)return;let[n,r]=(0,St.useState)([]),[o,i]=(0,St.useState)([]),[s,a]=(0,St.useState)([]),[l,c]=(0,St.useState)(!1);function d(){let u=pe.extractSchemaModel(t.getNodes(),t.getEdges());if(!u)return;let f=u.tables.map(h=>`${h.schema}.${h.name}`);f.sort((h,p)=>{let g=o.includes(h),v=o.includes(p);return g&&!v?-1:!g&&v?1:h.localeCompare(p)}),r(f),a(f)}return(0,St.useEffect)(()=>{let u=t.getNodes();if(o.length===0){u.forEach(f=>{t.updateNode(f.id,{...f,hidden:!1})});return}u.forEach(f=>{let h=`${f.data.schema}.${f.data.name}`;o.includes(h)?t.updateNode(f.id,{...f,hidden:!1}):t.updateNode(f.id,{...f,hidden:!0})})},[o]),(0,$e.jsxs)(rn,{open:l,onOpenChange:(u,f)=>c(f.open),children:[(0,$e.jsx)(sn,{disableButtonEnhancement:!0,children:(0,$e.jsx)(ke,{icon:(0,$e.jsx)(Ea,{}),style:{minWidth:"85px"},onClick:()=>{d(),c(!l)},appearance:"subtle",children:O.schemaDesigner.filter})}),(0,$e.jsxs)(on,{style:{width:"250px",padding:"10px"},onKeyDown:u=>{u.key==="Escape"&&c(!1)},children:[(0,$e.jsx)(Br,{size:"small",placeholder:"Search",style:{marginBottom:"10px",width:"100%"},onChange:(u,f)=>{let h=f.value;if(h.length===0){a(n);return}let p=n.filter(g=>g.toLowerCase().includes(h.toLowerCase()));a(p)},onAbort:()=>{a(n),i([])}}),(0,$e.jsx)(ja,{selectionMode:"multiselect",style:{maxHeight:"150px",overflowY:"auto",padding:"5px"},selectedItems:o,onSelectionChange:(u,f)=>{i(f.selectedItems)},children:s.map(u=>(0,$e.jsx)(Qa,{value:u,children:(0,$e.jsx)(Ee,{style:{lineHeight:"30px"},children:u})},u))}),(0,$e.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"5px",justifyContent:"flex-end"},children:(0,$e.jsx)(se,{size:"small",style:{},onClick:()=>{i([])},appearance:"subtle",icon:(0,$e.jsx)(oa,{}),children:O.schemaDesigner.clearFilter})})]})]})}var qp=V(de());var $s=V(te());function Up(){let e=(0,qp.useContext)(ue);if(e)return(0,$s.jsx)(ke,{icon:(0,$s.jsx)(Ca,{}),onClick:()=>{J.emit("newTable",e.extractSchema())},title:O.schemaDesigner.addTable,appearance:"subtle",children:O.schemaDesigner.addTable})}var jo=V(de());var ne=V(te());var D_=ze({errorSection:{marginBottom:"15px",lineHeight:1.5},sectionNumber:{fontWeight:"bold",marginRight:"5px"}});function Yp(){let e=D_(),t=(0,jo.useContext)(ue);if(!t)return;let[n,r]=(0,jo.useState)({report:void 0,reportError:void 0,isConfirmationChecked:!1,selectedReportId:"",reportTab:"report",publishError:void 0,currentStage:"notStarted"}),o=()=>(0,ne.jsx)(ke,{icon:(0,ne.jsx)(wa,{}),title:O.schemaDesigner.publishChanges,appearance:"subtle",onClick:async()=>{r({...n,currentStage:"reportLoading",reportError:void 0,isConfirmationChecked:!1});let h=await t.getReport();h.error?r({...n,currentStage:"reportError",reportError:h.error}):h.report.reports.length===0?r({...n,currentStage:"reportSuccessNoChanges",reportError:void 0,report:h.report,selectedReportId:""}):r({...n,currentStage:"reportSuccessWithChanges",reportError:void 0,report:h.report,selectedReportId:h.report?.reports[0]?.tableId??"",isConfirmationChecked:!1})},children:O.schemaDesigner.publishChanges}),i=h=>(0,ne.jsx)(Cr,{size:"large",style:{marginBottom:"10px",marginTop:"10px"},label:h,labelPosition:"below"}),s=h=>(0,ne.jsxs)("div",{className:"error-container",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ne.jsx)(sa,{style:{marginRight:"10px",width:"50px",height:"50px"}}),(0,ne.jsx)("div",{className:"error-body",children:(g=>{let v=g.split(/(\d+\.\s)/g),y=[];for(let w=0;w<v.length;w++)if(v[w].match(/^\d+\.\s$/)){let b=v[w],x=v[w+1]||"";y.push((0,ne.jsxs)("div",{className:e.errorSection,children:[(0,ne.jsx)("strong",{className:e.sectionNumber,children:b}),(0,ne.jsx)("span",{children:x})]},w)),w++}else v[w].trim()&&y.push((0,ne.jsx)("div",{className:e.errorSection,children:(0,ne.jsx)("span",{children:v[w]})},w));return y})(h)})]}),a=()=>(0,ne.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ne.jsx)(na,{style:{marginRight:"10px",width:"50px",height:"50px"}}),O.schemaDesigner.changesPublishedSuccessfully]}),l=()=>(0,ne.jsx)(ne.Fragment,{children:(0,ne.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[n.report?.dacReport?.possibleDataLoss&&(0,ne.jsx)(ln,{intent:"warning",style:{marginBottom:"10px",marginTop:"10px"},children:O.schemaDesigner.possibleDataLoss}),n.report?.dacReport?.hasWarnings&&(0,ne.jsx)(ln,{intent:"warning",style:{marginBottom:"10px",marginTop:"10px"},children:O.schemaDesigner.hasWarnings}),(0,ne.jsx)("div",{style:{width:"100%",height:"500px",maxHeight:"100%",overflow:"auto"},children:(0,ne.jsx)(Za,{children:n?.report?.dacReport?.report??""})}),(0,ne.jsx)(Rn,{label:O.tableDesigner.designerPreviewConfirmation,style:{margin:"5px"},required:!0,checked:n.isConfirmationChecked,onChange:(h,p)=>{r({...n,isConfirmationChecked:p.checked})},autoFocus:!0,onFocus:h=>{h.target.parentElement&&(h.target.parentElement.style.outlineStyle="solid",h.target.parentElement.style.outlineColor="var(--vscode-focusBorder)")},onBlur:h=>{h.target.parentElement&&(h.target.parentElement.style.outline="none",h.target.parentElement.style.outlineColor="")}})]})}),c=()=>{if(n.currentStage==="reportLoading")return i(O.schemaDesigner.generatingReport);if(n.currentStage==="reportError")return s(n.reportError??"");if(n.currentStage==="reportSuccessNoChanges")return(0,ne.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ne.jsx)(ta,{style:{marginRight:"10px",width:"50px",height:"50px"}}),O.schemaDesigner.noChangesDetected]});if(n.currentStage==="reportSuccessWithChanges")return l();if(n.currentStage==="publishLoading")return i(O.schemaDesigner.publishingChanges);if(n.currentStage==="publishError")return s(n.publishError??"");if(n.currentStage==="publishSuccess")return a()},d=()=>n.currentStage==="reportSuccessWithChanges",u=()=>n.currentStage==="reportSuccessWithChanges"&&n.isConfirmationChecked,f=()=>(0,ne.jsxs)(ne.Fragment,{children:[d()&&(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(se,{appearance:"primary",disabled:!u(),onClick:async()=>{r({...n,currentStage:"publishLoading",publishError:void 0});let h=await t.publishSession();h.error?r({...n,currentStage:"publishError",publishError:h.error}):r({...n,currentStage:"publishSuccess"})},children:O.schemaDesigner.publish}),(0,ne.jsx)(se,{appearance:"secondary",disabled:!u(),onClick:()=>{t.openInEditorWithConnection(n?.report?.updateScript??"")},children:O.schemaDesigner.openPublishScript})]}),n.currentStage==="publishSuccess"&&(0,ne.jsx)(Nr,{disableButtonEnhancement:!0,children:(0,ne.jsx)(se,{appearance:"secondary",onClick:()=>{r({...n,currentStage:"notStarted"}),t.resetUndoRedoState()},children:O.schemaDesigner.continueEditing})}),n.currentStage!=="publishLoading"&&(0,ne.jsx)(Nr,{disableButtonEnhancement:!0,children:(0,ne.jsx)(se,{appearance:"secondary",onClick:()=>{r({...n,isConfirmationChecked:!1}),n.currentStage==="publishSuccess"&&t.closeDesigner()},children:O.schemaDesigner.Close})})]});return(0,ne.jsxs)(Ma,{children:[(0,ne.jsx)(Nr,{disableButtonEnhancement:!0,children:o()}),(0,ne.jsx)(Aa,{style:{width:"100%",maxWidth:"800px"},children:(0,ne.jsxs)(Ra,{children:[(0,ne.jsx)(Pa,{children:O.schemaDesigner.publishChanges}),(0,ne.jsx)(Fa,{children:c()}),(0,ne.jsx)(Oa,{children:f()})]})})]})}var Gp=V(de());var Hs=V(te());function Xp(){let e=(0,Gp.useContext)(ue),t=We();if(e)return(0,Hs.jsx)(ke,{icon:(0,Hs.jsx)(_a,{}),onClick:()=>{J.emit("pushState");let n=t.getNodes(),r=pe.extractSchemaModel(n,t.getEdges()),o=pe.generateSchemaDesignerFlowComponents(r);t.setNodes(o.nodes),t.setEdges(o.edges)},title:O.schemaDesigner.autoArrange,appearance:"subtle",children:O.schemaDesigner.autoArrange})}var Zp=V(de()),Vs=V(te());function jp(){let e=(0,Zp.useContext)(ue);return(0,Vs.jsx)(ke,{icon:(0,Vs.jsx)(va,{}),title:O.schemaDesigner.delete,appearance:"subtle",onClick:()=>e.deleteSelectedNodes(),children:O.schemaDesigner.delete})}var mr=V(de()),Et=V(te());function Qp(){let[e,t]=(0,mr.useState)(!1),[n,r]=(0,mr.useState)(!1);return(0,mr.useEffect)(()=>{let o=(i,s)=>{t(i),r(s)};return J.on("updateUndoRedoState",o),()=>{J.off("updateUndoRedoState",o)}},[]),(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(ke,{icon:(0,Et.jsx)(ya,{}),onClick:()=>{J.emit("undo")},disabled:!e,title:"Undo",appearance:"subtle",children:"Undo"}),(0,Et.jsx)(ke,{icon:(0,Et.jsx)(ga,{}),onClick:()=>{J.emit("redo")},disabled:!n,title:"Redo",appearance:"subtle",children:"Redo"})]})}var Ye=V(te());function Jp(){return(0,Ye.jsxs)(Tr,{size:"small",style:{paddingTop:"5px",paddingBottom:"5px",width:"100%",overflow:"hidden",overflowX:"auto"},children:[(0,Ye.jsx)(Yp,{}),(0,Ye.jsx)(vp,{}),(0,Ye.jsx)(Wp,{}),(0,Ye.jsx)(fi,{}),(0,Ye.jsx)(Up,{}),(0,Ye.jsx)(Qp,{}),(0,Ye.jsx)(Xp,{}),(0,Ye.jsx)(jp,{}),(0,Ye.jsx)(fi,{}),(0,Ye.jsx)(Kp,{})]})}var sm=V(de());var em=V(de());var gr=V(te()),I_=ze({editorFooter:{display:"flex",flexDirection:"row",gap:"10px",borderTop:"1px solid var(--vscode-badge-background)",padding:"10px"}});function tm(){let e=(0,em.useContext)(Je);if(!e)return;let t=I_(),n=()=>{let r=0;for(let o in e.errors)e.errors[o]&&r++;return r};return(0,gr.jsxs)("div",{className:t.editorFooter,children:[(0,gr.jsx)(se,{appearance:"primary",onClick:()=>{e.save(),J.emit("getScript")},disabled:n()>0,children:e.isNewTable?O.schemaDesigner.add:O.schemaDesigner.save}),(0,gr.jsx)(se,{appearance:"secondary",onClick:()=>{e.cancel()},children:O.schemaDesigner.cancel})]})}var Le=V(de());var q=V(te()),Ws=V(de()),nm=ze({panel:{height:"100%",display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",padding:"5px",gap:"10px"},scrollContainer:{flex:"1",overflowY:"auto",overflowX:"hidden"},newColumnButton:{width:"fit-content"},advancedOptionsContainer:{display:"flex",flexDirection:"column",gap:"5px"},fullWidthDivider:{width:"100vh"},columnInput:{minWidth:"150px",maxWidth:"150px",textOverflow:"ellipsis"}}),M_=({columns:e,updateColumn:t,deleteColumn:n,columnNameInputRefs:r,datatypes:o,isColumnDeletable:i})=>{let s=nm(),a=wr({axis:"grid"}),l=(0,Le.useContext)(Je),c=[nt({columnId:"name",renderHeaderCell:()=>(0,q.jsx)(Ee,{children:O.schemaDesigner.name})}),nt({columnId:"type",renderHeaderCell:()=>(0,q.jsx)(Ee,{children:O.schemaDesigner.dataType})}),nt({columnId:"primaryKey",renderHeaderCell:()=>(0,q.jsx)(Ee,{children:O.schemaDesigner.primaryKey})}),nt({columnId:"delete",renderHeaderCell:()=>(0,q.jsx)(Ee,{})}),nt({columnId:"menu",renderHeaderCell:()=>(0,q.jsx)(Ee,{})}),nt({columnId:"error",renderHeaderCell:()=>(0,q.jsx)(q.Fragment,{})})],[d]=(0,Le.useState)({error:{defaultWidth:18,minWidth:18,idealWidth:18},name:{defaultWidth:150,minWidth:150,idealWidth:150},type:{defaultWidth:150,minWidth:150,idealWidth:150},primaryKey:{defaultWidth:70,minWidth:70,idealWidth:70},delete:{defaultWidth:20,minWidth:20,idealWidth:20},menu:{defaultWidth:20,minWidth:20,idealWidth:20}}),[u]=(0,Le.useState)(c),{getRows:f,columnSizing_unstable:h,tableRef:p}=Dr({columns:u,items:e},[kr({columnSizingOptions:d,autoFitColumns:!1,containerWidthOffset:20})]),g=(y,w)=>{let b=ve.getAdvancedOptions(y);return(0,q.jsx)("div",{className:s.advancedOptionsContainer,children:b.map(x=>{switch(x.type){case"checkbox":return(0,q.jsx)(Ge,{children:(0,q.jsx)(Rn,{size:"medium",checked:y[x.columnProperty],onChange:(C,k)=>{t(w,x.columnModifier(y,k.checked))},label:x.label})},x.label);case"input":return(0,q.jsx)(Ge,{label:{children:(0,q.jsx)(Ar,{size:"small",info:x.hint,children:x.label})},children:(0,q.jsx)(Pt,{size:"small",value:y[x.columnProperty]?.toString(),onChange:(C,k)=>{t(w,x.columnModifier(y,k.value))}})},x.label);case"input-number":return(0,q.jsx)(Ge,{label:{children:(0,q.jsx)(Ar,{size:"small",info:x.hint,children:x.label})},children:(0,q.jsx)(Pt,{size:"small",type:"number",value:y[x.columnProperty]?.toString(),onChange:(C,k)=>{t(w,x.columnModifier(y,parseInt(k.value)))}})},x.label);case"textarea":return(0,q.jsx)(Ge,{label:{children:(0,q.jsx)(Ar,{size:"small",info:x.hint,children:x.label})},children:(0,q.jsx)(Ia,{size:"small",value:y[x.columnProperty],onChange:(C,k)=>{t(w,x.columnModifier(y,k.value))}})},x.label)}return(0,q.jsx)(q.Fragment,{})})})},v=(y,w,b)=>{switch(w){case"error":return(0,q.jsx)(q.Fragment,{children:l.errors[`columns_${y.id}`]&&(0,q.jsxs)(di,{children:[(0,q.jsx)(ui,{disableButtonEnhancement:!0,children:(0,q.jsx)(se,{icon:(0,q.jsx)(aa,{style:{color:"var(--vscode-errorForeground)"},title:l.errors[y.name]}),appearance:"transparent"})}),(0,q.jsx)(ci,{tabIndex:-1,children:(0,q.jsx)("div",{children:l.errors[`columns_${y.id}`]})})]})});case"name":return(0,q.jsx)(Pt,{size:"small",className:s.columnInput,ref:C=>{r.current&&(r.current[b]=C)},value:y.name,onChange:(C,k)=>{t(b,{...y,name:k.value})}});case"type":return(0,q.jsx)(cn,{placeholder:"Search Schema",options:o.map(C=>({displayName:C,value:C})),selectedOption:y.isComputed?{text:"Computed",value:"Computed"}:{text:y.dataType,value:y.dataType},onSelect:C=>{let k={...y,dataType:C.value,defaultValue:""};t(b,ve.fillColumnDefaults(k))},style:{minWidth:"150px",maxWidth:"150px"},size:"small",disabled:y.isComputed});case"primaryKey":return(0,q.jsx)(Rn,{size:"medium",checked:y.isPrimaryKey,onChange:(C,k)=>{t(b,{...y,isPrimaryKey:k.checked,isNullable:k.checked?!1:y.isNullable})},disabled:y.isComputed});case"delete":return(0,q.jsx)(se,{size:"small",appearance:"subtle",disabled:!i(y),icon:(0,q.jsx)(Rt,{}),onClick:()=>n(b)});case"menu":let x="schema-designer-menu-"+y.id;return(0,q.jsxs)(di,{positioning:{position:"below"},children:[(0,q.jsx)(ui,{disableButtonEnhancement:!0,children:(0,q.jsx)(se,{size:"small",appearance:"subtle",icon:(0,q.jsx)(da,{})})}),(0,q.jsxs)(ci,{"aria-labelledby":x,children:[(0,q.jsx)("div",{children:(0,q.jsx)("h3",{id:x,children:"Advanced options"})}),g(y,b)]})]});default:return(0,q.jsx)(Ee,{children:w})}};return(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)(Or,{...a,as:"table",size:"extra-small",...h.getTableProps(),ref:p,children:[(0,q.jsx)(Rr,{children:(0,q.jsx)(an,{children:c.map(y=>(0,Ws.createElement)(Pr,{...h.getTableHeaderCellProps(y.columnId),key:y.columnId},y.renderHeaderCell()))})}),(0,q.jsx)(Mr,{children:f().map((y,w)=>(0,q.jsx)(an,{children:u.map(b=>(0,Ws.createElement)(Ir,{...h.getTableCellProps(b.columnId),key:b.columnId},v(e[w],b.columnId,w)))},w))})]})})},rm=()=>{let e=nm(),t=(0,Le.useContext)(Je),n=(0,Le.useRef)([]),[r,o]=(0,Le.useState)(-1),i=(0,Le.useMemo)(()=>t.dataTypes,[t.dataTypes]),s=(0,Le.useMemo)(()=>mt.getAllTables(t.schema,t.table),[t.schema,t.table]);(0,Le.useEffect)(()=>{o(-1)},[t.table]),(0,Le.useEffect)(()=>{r>=0&&n.current[r]?.focus()},[r]);let a=h=>{let p=t.table.foreignKeys.some(v=>v.columns.includes(h.name)),g=s.some(v=>v.foreignKeys.some(y=>y.referencedColumns.includes(h.name)));return!p&&!g},l=()=>{let h=[...t.table.columns];h.push({id:it(),name:en.getNextColumnName(h),dataType:"int",isPrimaryKey:h.length===0,isIdentity:!1,isNullable:!0,maxLength:"",precision:0,scale:0,identitySeed:1,identityIncrement:1,defaultValue:"",isComputed:!1,computedFormula:"",computedPersisted:!1}),t.setTable({...t.table,columns:h}),o(h.length-1)},c=(h,p)=>{let g=[...t.table.columns];g[h]=p,t.setTable({...t.table,columns:g})},d=h=>{let p=[...t.table.columns];p.splice(h,1),t.setTable({...t.table,columns:p})},u=h=>{t.setTable({...t.table,schema:h})},f=h=>{t.setTable({...t.table,name:h})};if(t.table)return(0,q.jsxs)("div",{className:e.panel,children:[(0,q.jsxs)(Ge,{children:[(0,q.jsx)(_t,{children:O.schemaDesigner.schema}),(0,q.jsx)(cn,{placeholder:"Search Schema",options:t.schemas.map(h=>({displayName:h,value:h})),selectedOption:{text:t.table.schema,value:t.table.schema},onSelect:h=>u(h.value)})]}),(0,q.jsxs)(Ge,{validationMessage:t.errors[Ks],children:[(0,q.jsx)(_t,{children:O.schemaDesigner.name}),(0,q.jsx)(Pt,{autoFocus:!0,value:t.table.name,onChange:(h,p)=>f(p.value)})]}),(0,q.jsx)(se,{appearance:"secondary",icon:(0,q.jsx)(nn,{}),className:e.newColumnButton,onClick:l,children:O.schemaDesigner.newColumn}),(0,q.jsx)("div",{className:e.scrollContainer,children:(0,q.jsx)(M_,{columns:t.table.columns,updateColumn:c,deleteColumn:d,columnNameInputRefs:n,datatypes:i,isColumnDeletable:a})})]})};var Se=V(de());var ee=V(te()),qs=V(de()),om=ze({panel:{height:"100%",display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",padding:"10px",gap:"10px"},row:{display:"flex",flexDirection:"row",flex:"1",gap:"5px",padding:"0px 5px"},cardStyle:{marginBottom:"10px"},actionButton:{width:"fit-content"},scrollContainer:{flex:"1",overflow:"auto",padding:"5px"},newForeignKeyButton:{width:"200px"},mappingTableContainer:{backgroundColor:"var(--vscode-editorGroupHeader-tabsBackground)",padding:"10px"}}),O_=({foreignKey:e,foreignKeyIndex:t,selectedTable:n,updateForeignKey:r})=>{let o=wr({axis:"grid"}),i=[nt({columnId:"columnName",renderHeaderCell:()=>(0,ee.jsx)(Ee,{children:O.schemaDesigner.columnName})}),nt({columnId:"foreignKeyColumnName",renderHeaderCell:()=>(0,ee.jsx)(Ee,{children:O.schemaDesigner.foreignColumn})}),nt({columnId:"delete",renderHeaderCell:()=>(0,ee.jsx)(Ee,{})})],[s]=(0,Se.useState)({columnName:{defaultWidth:150,minWidth:150,idealWidth:150},foreignKeyColumnName:{defaultWidth:150,minWidth:150,idealWidth:150},delete:{defaultWidth:30,minWidth:30,idealWidth:30}}),a=e.columns.map((g,v)=>({columnName:g,foreignKeyColumnName:e.referencedColumns[v]})),[l]=(0,Se.useState)(i),{getRows:c,columnSizing_unstable:d,tableRef:u}=Dr({columns:l,items:a},[kr({columnSizingOptions:s,autoFitColumns:!1,containerWidthOffset:20})]),f=(0,Se.useContext)(Je),h=(0,Se.useMemo)(()=>f.schema?mt.getTableFromDisplayName(f.schema,`${e.referencedSchemaName}.${e.referencedTableName}`):{columns:[]},[f.schema,e.referencedSchemaName,e.referencedTableName]),p=(g,v)=>{switch(g){case"columnName":return(0,ee.jsx)(cn,{placeholder:"Search Schema",options:n.columns.map(y=>({displayName:y.name,value:y.name})),selectedOption:{text:e.columns[v],value:e.columns[v]},onSelect:y=>{let w=[...e.columns];w[v]=y.value,r(t,{...e,columns:w})},style:{minWidth:"150px",maxWidth:"150px"},size:"small"});case"foreignKeyColumnName":return(0,ee.jsx)(cn,{placeholder:"Search Schema",options:h.columns.map(y=>({displayName:y.name,value:y.name})),selectedOption:{text:e.referencedColumns[v],value:e.referencedColumns[v]},onSelect:y=>{let w=[...e.referencedColumns];w[v]=y.value,r(t,{...e,referencedColumns:w})},style:{minWidth:"150px",maxWidth:"150px"},size:"small"});case"delete":return(0,ee.jsx)(se,{appearance:"subtle",icon:(0,ee.jsx)(Rt,{}),onClick:()=>{let y=[...e.columns],w=[...e.referencedColumns];y.splice(v,1),w.splice(v,1),r(t,{...e,columns:y,referencedColumns:w})}});default:return null}};return(0,ee.jsxs)(Or,{...o,as:"table",size:"extra-small",...d.getTableProps(),ref:u,children:[(0,ee.jsx)(Rr,{children:(0,ee.jsx)(an,{children:i.map(g=>(0,qs.createElement)(Pr,{...d.getTableHeaderCellProps(g.columnId),key:g.columnId},g.renderHeaderCell()))})}),(0,ee.jsx)(Mr,{children:c().map((g,v)=>(0,ee.jsx)(an,{children:i.map(y=>(0,qs.createElement)(Ir,{...d.getTableCellProps(y.columnId),key:y.columnId},p(y.columnId,v)))},`mapping-${v}`))})]})},R_=({foreignKey:e,index:t,allTables:n,onDelete:r,onUpdate:o,lastAddedForeignKeyIndex:i})=>{let s=om(),a=(0,Se.useContext)(Je),l=(0,Se.useRef)(null),[c,d]=(0,Se.useState)(""),[u,f]=(0,Se.useState)("");(0,Se.useEffect)(()=>{t===i&&l.current?.focus()},[t,i]);let h=()=>{if(!a.schema)return;let p={...e},g=a.table.columns[0]?.name||"",y=mt.getTableFromDisplayName(a.schema,`${e.referencedSchemaName}.${e.referencedTableName}`).columns[0]?.name||"";p.columns.push(g),p.referencedColumns.push(y),o(t,p)};return(0,Se.useEffect)(()=>{let p=a.errors[`${yr}${e.id}`];d(p||"");let g=a.warnings[`${yr}${e.id}`];f(g||"")},[a.errors]),(0,ee.jsxs)(La,{className:s.cardStyle,children:[(0,ee.jsx)(za,{header:(0,ee.jsx)(Ee,{children:O.schemaDesigner.foreignKeyIndex(t+1)}),action:(0,ee.jsx)(se,{appearance:"subtle",icon:(0,ee.jsx)(Rt,{}),onClick:()=>r(t)})}),c&&(0,ee.jsx)(ln,{intent:"error",children:c}),u&&(0,ee.jsx)(ln,{intent:"warning",children:u}),(0,ee.jsx)("div",{className:s.row,children:(0,ee.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,ee.jsx)(_t,{children:O.schemaDesigner.name}),(0,ee.jsx)(Pt,{size:"small",value:e.name,ref:l,onChange:(p,g)=>{o(t,{...e,name:g.value})}})]})}),(0,ee.jsx)("div",{className:s.row,children:(0,ee.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,ee.jsx)(_t,{children:O.schemaDesigner.targetTable}),(0,ee.jsx)(Er,{size:"small",value:`${e.referencedSchemaName}.${e.referencedTableName}`,selectedOptions:[`${e.referencedSchemaName}.${e.referencedTableName}`],multiselect:!1,onOptionSelect:(p,g)=>{if(!g.optionText||!a.schema)return;let v=mt.getTableFromDisplayName(a.schema,g.optionText),y=v.columns[0]?.name||"";o(t,{...e,referencedTableName:v.name,referencedSchemaName:v.schema,referencedColumns:[y]})},style:{minWidth:"auto"},children:n.slice().sort((p,g)=>{let v=`${p.schema}.${p.name}`,y=`${g.schema}.${g.name}`;return v.toLowerCase().localeCompare(y.toLowerCase())}).map(p=>{let g=`${p.schema}.${p.name}`;return(0,ee.jsx)(Sr,{value:g,children:g},`table-option-${p.name}`)})})]})}),(0,ee.jsxs)("div",{className:s.row,children:[(0,ee.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,ee.jsx)(_t,{children:O.schemaDesigner.onDelete}),(0,ee.jsx)(Er,{size:"small",value:le.convertOnActionToString(e.onDeleteAction),selectedOptions:[le.convertOnActionToString(e.onDeleteAction)],multiselect:!1,onOptionSelect:(p,g)=>{o(t,{...e,onDeleteAction:le.convertStringToOnAction(g.optionValue)})},style:{minWidth:"auto"},children:le.getOnActionOptions().map((p,g)=>(0,ee.jsx)(Sr,{value:p.label,children:p.label},`on-delete-option-${g}-${e.id}`))})]}),(0,ee.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,ee.jsx)(_t,{children:O.schemaDesigner.onUpdate}),(0,ee.jsx)(Er,{size:"small",value:le.convertOnActionToString(e.onUpdateAction),selectedOptions:[le.convertOnActionToString(e.onUpdateAction)],multiselect:!1,onOptionSelect:(p,g)=>{o(t,{...e,onUpdateAction:le.convertStringToOnAction(g.optionValue)})},style:{minWidth:"auto"},children:le.getOnActionOptions().map((p,g)=>(0,ee.jsx)(Sr,{value:p.label,children:p.label},`on-update-option--${g}-${e.id}`))})]})]}),(0,ee.jsxs)("div",{className:s.mappingTableContainer,children:[(0,ee.jsx)(se,{icon:(0,ee.jsx)(nn,{}),className:s.actionButton,onClick:h,size:"small",children:O.schemaDesigner.newColumnMapping}),(0,ee.jsx)(O_,{foreignKey:e,foreignKeyIndex:t,selectedTable:a.table,updateForeignKey:o})]})]},`fk-card-${t}`)},im=()=>{let e=om(),t=(0,Se.useContext)(Je),n=(0,Se.useRef)([]),[r,o]=(0,Se.useState)(-1),i=(0,Se.useMemo)(()=>t.schema?mt.getAllTables(t.schema,t.table):[],[t.table]);if((0,Se.useEffect)(()=>{t.table&&o(-1)},[t.table]),(0,Se.useEffect)(()=>{r>=0&&n.current[r]?.focus()},[r]),!t.table)return;let s=()=>{if(!i.length)return;let c=i[0],d={id:it(),name:en.getNextForeignKeyName(t.table.foreignKeys,t.schema.tables),columns:[t.table.columns[0]?.name||""],referencedSchemaName:c.schema,referencedTableName:c.name,referencedColumns:[c.columns[0]?.name||""],onDeleteAction:xe.OnAction.CASCADE,onUpdateAction:xe.OnAction.CASCADE},u=[...t.table.foreignKeys,d];t.setTable({...t.table,foreignKeys:u}),o(u.length-1)},a=c=>{let d=[...t.table.foreignKeys];d.splice(c,1),t.setTable({...t.table,foreignKeys:d})},l=(c,d)=>{let u=[...t.table.foreignKeys];u[c]=d,t.setTable({...t.table,foreignKeys:u})};return(0,ee.jsxs)("div",{className:e.panel,children:[(0,ee.jsx)(se,{icon:(0,ee.jsx)(nn,{}),className:e.newForeignKeyButton,onClick:s,children:O.schemaDesigner.newForeignKey}),(0,ee.jsx)("div",{className:e.scrollContainer,children:t.table.foreignKeys.map((c,d)=>(0,ee.jsx)(R_,{foreignKey:c,index:d,allTables:i,onDelete:a,onUpdate:l,lastAddedForeignKeyIndex:r},`foreign-key-${c.id}`))})]})};var et=V(te()),P_=ze({editor:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},editorPanel:{flex:"1",overflow:"hidden"},tablePanel:{display:"flex",flexDirection:"column",padding:"5px 0px",gap:"5px",overflow:"hidden",maxHeight:"calc(100% - 10px)"},tablePanelRow:{display:"flex",flexDirection:"row",flex:"1",gap:"5px",padding:"0px 5px"},dataTypeDropdown:{minWidth:"110px",maxWidth:"110px","> button":{textOverflow:"ellipsis"}},foreignKeyContainer:{display:"flex",flexDirection:"column",gap:"5px",padding:"5px",borderTop:"1px solid"}}),am=()=>{let e=P_(),t=(0,sm.useContext)(Je);if(!t)return;let n=i=>Object.keys(t.errors).filter(s=>s.includes(`${i}_`)&&t.errors[s]).length,r=i=>Object.keys(t.warnings).filter(s=>s.includes(`${i}_`)&&t.warnings[s]).length;if(!t.table)return;let o=i=>(0,et.jsx)(ka,{value:i,children:(0,et.jsxs)("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[O.schemaDesigner[i],(0,et.jsx)(li,{size:"small",count:n(i),style:{backgroundColor:"var(--vscode-inputValidation-errorBackground)",color:"var(--vscode-problemsErrorIcon-foreground)",border:"1px solid var(--vscode-inputValidation-errorBorder)"},title:O.schemaDesigner.nErrors(n(i))}),(0,et.jsx)(li,{size:"small",count:r(i),style:{backgroundColor:"var(--vscode-inputValidation-warningBackground)",color:"var(--vscode-problemsWarningIcon-foreground)",border:"1px solid var(--vscode-inputValidation-warningBorder)"},title:O.schemaDesigner.nWarnings(r(i))})]})});return(0,et.jsxs)("div",{className:e.editor,children:[(0,et.jsxs)(Da,{selectedValue:t.selectedTabValue,onTabSelect:(i,s)=>t.setSelectedTabValue(s.value),children:[o("table"),o("foreignKeys")]}),(0,et.jsxs)("div",{className:e.editorPanel,children:[t.selectedTabValue==="table"&&(0,et.jsx)(rm,{}),t.selectedTabValue==="foreignKeys"&&(0,et.jsx)(im,{})]}),(0,et.jsx)(tm,{})]})};var Te=V(de());var gt=V(te()),Je=(0,Te.createContext)(void 0);var Ks="table_name",yr="foreignKeys_fk_",lm=()=>{let e=(0,Te.useContext)(ue);if(!e)return;let[t,n]=(0,Te.useState)(!1),[r,o]=(0,Te.useState)({tables:[]}),[i,s]=(0,Te.useState)({name:"",columns:[],schema:"",foreignKeys:[],id:""}),[a,l]=(0,Te.useState)(!1),[c,d]=(0,Te.useState)({}),[u,f]=(0,Te.useState)({}),[h,p]=(0,Te.useState)([]),[g,v]=(0,Te.useState)([]),[y,w]=(0,Te.useState)("table");(0,Te.useEffect)(()=>{p(e.schemaNames),v(e.datatypes)},[e]),(0,Te.useEffect)(()=>{let x=(k,N,P)=>{let A=e.getTableWithForeignKeys(k.id)||k;n(!0),o(N),s(A),l(!1),w(P?"foreignKeys":"table")},C=k=>{o(k),s(mt.createNewTable(k,h)),l(!0),n(!0),w("table")};return J.on("editTable",x),J.on("newTable",C),()=>{J.off("editTable",x),J.off("newTable",C)}},[h,g]);let b=async()=>{let x=!1;a?x=await e.addTable(i):x=await e.updateTable(i),x&&(n(!1),J.emit("getScript"),J.emit("pushState"))};return(0,Te.useEffect)(()=>{(()=>{let C={},k={},N=mt.tableNameValidationError(r,i);C[Ks]=N??"";for(let P of i.columns){let A=ve.isColumnValid(P,i.columns);A&&(C[`columns_${P.id}`]=A??"")}i.foreignKeys.forEach(P=>{let A=le.isForeignKeyValid(r.tables,i,P);A&&(C[`${yr}${P.id}`]=A.errorMessage??"");let F=le.getForeignKeyWarnings(r.tables,i,P);F&&(k[`${yr}${P.id}`]=F.errorMessage??"")}),d(C),f(k)})()},[i]),(0,gt.jsx)(Ka,{position:"end",open:t,onOpenChange:(x,{open:C})=>n(C),onKeyDown:x=>{x.key==="Backspace"&&x.stopPropagation()},style:{width:"600px"},children:(0,gt.jsxs)(Je.Provider,{value:{schemas:h,dataTypes:g,schema:r,table:i,setTable:s,isEditDrawerOpen:t,setIsEditDrawerOpen:n,save:b,cancel:()=>n(!1),isNewTable:a,errors:c,warnings:u,selectedTabValue:y,setSelectedTabValue:w},children:[(0,gt.jsx)(Lr,{children:(0,gt.jsx)(zr,{action:(0,gt.jsx)(se,{appearance:"subtle","aria-label":"Close",icon:(0,gt.jsx)(vr,{}),onClick:()=>n(!1)}),children:a?O.schemaDesigner.addTable:O.schemaDesigner.editTable})}),(0,gt.jsx)(Fr,{children:(0,gt.jsx)(am,{})})]})})};var tn=V(de());var He=V(te()),cm=()=>{let e=(0,tn.useContext)(ue),[t,n]=(0,tn.useState)(""),[r,o]=(0,tn.useState)(!1);return(0,tn.useEffect)(()=>{J.on("getScript",()=>{setTimeout(async()=>{let i=await e.getScript();n(i)},0)}),J.on("openCodeDrawer",()=>{o(!0),J.emit("getScript")})},[]),(0,He.jsxs)(qa,{separator:!0,open:r,position:"bottom",children:[(0,He.jsx)(Lr,{children:(0,He.jsx)(zr,{action:(0,He.jsxs)(Tr,{children:[(0,He.jsx)(se,{appearance:"subtle","aria-label":O.schemaDesigner.openInEditor,icon:(0,He.jsx)(fa,{}),onClick:()=>e.openInEditor(t),children:O.schemaDesigner.openInEditor}),(0,He.jsx)(se,{appearance:"subtle","aria-label":"Copy",icon:(0,He.jsx)(ra,{}),onClick:()=>e.copyToClipboard(t)}),(0,He.jsx)(se,{appearance:"subtle","aria-label":"Close",icon:(0,He.jsx)(vr,{}),onClick:()=>o(!1)})]}),children:O.schemaDesigner.viewCode})}),(0,He.jsx)(Fr,{children:(0,He.jsx)(Ja,{height:"100%",width:"100%",language:"sql",theme:Ga(e?.themeKind),value:t,options:{readOnly:!0}},t)})]})};var Jo=V(de());var Tn=V(de());var oe=V(te()),Qo=ze({tableNodeContainer:{width:`${Jt.NODE_WIDTH}px`,backgroundColor:"var(--vscode-editor-background)",borderRadius:"5px",display:"flex",flexDirection:"column",gap:"5px"},tableHeader:{width:"100%",display:"flex",height:"50px",flexDirection:"column"},tableHeaderRow:{width:"100%",display:"flex",height:"30px",flexDirection:"row",alignItems:"center",gap:"5px",paddingTop:"10px"},tableIcon:{padding:"0 5px",width:"20px",height:"20px"},tableTitle:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis",fontWeight:"600"},tableSubtitle:{fontSize:"11px",paddingLeft:"35px"},columnName:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis"},columnType:{fontSize:"12px",color:"var(--vscode-descriptionForeground)"},handleLeft:{marginLeft:"2px"},handleRight:{marginRight:"2px"},keyIcon:{padding:"0 5px",width:"16px",height:"16px"},actionButton:{marginLeft:"auto"}}),A_=({table:e})=>{let t=(0,Tn.useContext)(ue),n=Qo(),r=()=>{let s=t.extractSchema();if(!s.tables.find(c=>c.id===e.id))return;let l={...e};J.emit("editTable",l,s)},o=()=>{t.deleteTable(e)},i=()=>{let s=t.extractSchema();if(!s.tables.find(c=>c.id===e.id))return;let l={...e};J.emit("editTable",l,s,!0)};return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(se,{appearance:"subtle",icon:(0,oe.jsx)(ia,{}),onClick:r,className:n.actionButton,size:"small"}),(0,oe.jsxs)(rn,{children:[(0,oe.jsx)(sn,{disableButtonEnhancement:!0,children:(0,oe.jsx)(Na,{icon:(0,oe.jsx)(ua,{}),className:n.actionButton,size:"small",appearance:"subtle"})}),(0,oe.jsx)(on,{children:(0,oe.jsxs)(_r,{children:[(0,oe.jsx)(At,{icon:(0,oe.jsx)(la,{}),onClick:i,children:O.schemaDesigner.manageRelationships}),(0,oe.jsx)(At,{icon:(0,oe.jsx)(Rt,{}),onClick:o,children:O.schemaDesigner.delete})]})})]})]})},F_=({table:e})=>{let t=Qo(),[n,r]=(0,Tn.useState)("");(0,Tn.useEffect)(()=>{let i=s=>{r(s)};return J.on("onFindWidgetValueChange",i),()=>{J.off("onFindWidgetValueChange",i)}});let o=i=>{if(!n||n.trim()==="")return(0,oe.jsx)("span",{children:i});let s=new RegExp(`(${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),a=i.split(s);return(0,oe.jsx)(oe.Fragment,{children:a.map((l,c)=>l.toLowerCase()===n.toLowerCase()?(0,oe.jsx)("span",{style:{backgroundColor:"var(--vscode-editor-findMatchBackground)",color:"var(--vscode-editor-background)",padding:"0 2px",borderRadius:"3px"},children:l},c):(0,oe.jsx)("span",{children:l},c))})};return(0,oe.jsxs)("div",{className:t.tableHeader,children:[(0,oe.jsxs)("div",{className:t.tableHeaderRow,children:[(0,oe.jsx)(ha,{className:t.tableIcon}),(0,oe.jsx)(Ee,{className:t.tableTitle,children:o(`${e.schema}.${e.name}`)}),(0,oe.jsx)(A_,{table:e})]}),(0,oe.jsx)("div",{className:t.tableSubtitle,children:O.schemaDesigner.tableNodeSubText(e.columns.length)})]})},L_=({column:e})=>{let t=Qo();return(0,oe.jsxs)("div",{className:"column",children:[(0,oe.jsx)(Zt,{type:"source",position:U.Left,id:`left-${e.name}`,isConnectable:!0,className:t.handleLeft}),e.isPrimaryKey&&(0,oe.jsx)(ca,{className:t.keyIcon}),(0,oe.jsx)(Ee,{className:t.columnName,style:{paddingLeft:e.isPrimaryKey?"0px":"30px"},children:e.name}),(0,oe.jsx)(Ee,{className:t.columnType,children:e.isComputed?"COMPUTED":e.dataType?.toUpperCase()}),(0,oe.jsx)(Zt,{type:"source",position:U.Right,id:`right-${e.name}`,isConnectable:!0,className:t.handleRight})]},e.name)},z_=({columns:e})=>(0,oe.jsx)("div",{children:e.map((t,n)=>(0,oe.jsx)(L_,{column:t},`${n}-${t.name}`))}),dm=e=>{let t=Qo();return(0,oe.jsxs)("div",{className:t.tableNodeContainer,children:[(0,oe.jsx)(F_,{table:e.data}),(0,oe.jsx)(Ta,{}),(0,oe.jsx)(z_,{columns:e.data.columns})]})};var at=V(te()),B_={tableNode:dm},um=()=>{let e=ea("toaster"),{dispatchToast:t}=Ba(e),n=(0,Jo.useContext)(ue),[r,o,i]=$u([]),[s,a,l]=Hu([]);(0,Jo.useEffect)(()=>{(async()=>{let{nodes:p,edges:g}=await n.initializeSchemaDesigner();o(p),a(g)})()},[]);let c=h=>t((0,at.jsxs)(Ha,{appearance:"inverted",children:[(0,at.jsx)(Va,{children:"Failed to create foreign key"}),(0,at.jsx)(Wa,{children:h})]}),{pauseOnHover:!0,intent:"error"});return(0,at.jsxs)("div",{style:{width:"100vw",height:"100vh"},children:[(0,at.jsx)($a,{toasterId:e,position:"top-end"}),(0,at.jsxs)(Bu,{nodes:r,edges:s,nodeTypes:B_,onNodesChange:i,onEdgesChange:l,onConnect:h=>{let p=r.find(N=>N.id===h.source),g=r.find(N=>N.id===h.target);if(!p||!g||!h.sourceHandle||!h.targetHandle)return;let v=le.extractColumnNameFromHandle(h.sourceHandle),y=le.extractColumnNameFromHandle(h.targetHandle),w=p.data.columns.find(N=>N.name===v),b=g.data.columns.find(N=>N.name===y);if(!w||!b)return;let x=pe.extractSchemaModel(r,s),C=le.extractForeignKeysFromEdges(s,p.data.id,x),k={id:`${p.id}-${g.id}-${w.name}-${b.name}`,source:p.id,target:g.id,sourceHandle:h.sourceHandle,targetHandle:h.targetHandle,markerEnd:{type:ft.ArrowClosed},data:le.createForeignKeyFromConnection(p,g,w.name,b.name,it(),en.getNextForeignKeyName(C,x.tables))};a(N=>ar(k,N)),J.emit("getScript"),J.emit("pushState")},onConnectEnd:(h,p)=>{if(!p.isValid){if(!p.fromHandle||!p.toHandle||!p.fromNode||!p.toNode||!p.fromHandle.id||!p.toHandle.id)return;let g=le.extractColumnNameFromHandle(p.fromHandle.id),v=le.extractColumnNameFromHandle(p.toHandle.id),y=le.createForeignKeyFromConnection(p.fromNode,p.toNode,g,v),w=le.isForeignKeyValid(pe.extractSchemaModel(r,s).tables,p.fromNode.data,y);w.errorMessage&&c(w.errorMessage)}},proOptions:{hideAttribution:!0},isValidConnection:h=>le.validateConnection(h,r,s).isValid,connectionMode:dt.Loose,onDelete:()=>{J.emit("getScript"),J.emit("pushState")},onNodeDragStop:()=>{J.emit("pushState")},minZoom:.05,fitView:!0,children:[(0,at.jsx)(qu,{}),(0,at.jsx)(Yu,{pannable:!0,zoomable:!0}),(0,at.jsx)(Wu,{variant:pt.Dots,gap:12,size:1})]})]})};var hm=V(de());var _e=V(de());var tt=V(te()),$_=ze({floatingContainer:{position:"absolute",right:"16px",top:"0px",display:"flex",flexDirection:"row",alignItems:"center",backgroundColor:"var(--vscode-editorWidget-background)",boxShadow:"0 0 8px 2px var(--vscode-widget-shadow)",borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",paddingLeft:"4px",paddingRight:"4px",paddingTop:"0px",paddingBottom:"0px",zIndex:"35",transform:"translateY(-10px)",opacity:"0",transition:"opacity 0.2s ease, transform 0.2s ease",overflow:"hidden",borderLeft:"3px solid var(--vscode-editorWidget-border)",height:"33px",gap:"3px"},visible:{opacity:"1",transform:"translateY(0)"},srOnly:{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}});function fm({getItems:e,onItemSelected:t,onSearch:n,placeholder:r=O.common.find,searchLabel:o="Search items",nextLabel:i=O.common.findNext,previousLabel:s=O.common.findPrevious,width:a="200px",emitSearchEvent:l,disabled:c=!1,parentRef:d,zIndex:u=1e3}){let[f,h]=(0,_e.useState)(e()),[p,g]=(0,_e.useState)(""),[v,y]=(0,_e.useState)(O.common.noResults),[w,b]=(0,_e.useState)([]),[x,C]=(0,_e.useState)(0),[k,N]=(0,_e.useState)(!1),P=(0,_e.useRef)(null),A=(0,_e.useRef)(null),F=(0,_e.useRef)(null),B=(0,_e.useRef)(null),L=$_(),z=_=>_.trim()?f.filter(I=>I.getSearchableText().toLowerCase().includes(_.toLowerCase())):[];(0,_e.useEffect)(()=>{let _=O.common.noResults;w.length>0&&(_=O.common.searchResultSummary(x+1,w.length)),y(_),F.current&&(F.current.textContent=p?`${_}${w.length>0?`. Found "${p}" in ${w[x]?.getDisplayText()}`:""}`:"Search cleared"),w.length>0&&t&&t(w[x]),l&&l(p)},[w,x,p,t,l]);let m=_=>{if(g(_),_.trim().length===0)y(O.common.noResults),b([]),C(0);else{let I=z(_);b(I),C((I.length>0,0))}n&&n(_)},E=()=>{if(w.length===0)return;let _=(x+1)%w.length;C(_)},S=()=>{if(w.length===0)return;let _=(x-1+w.length)%w.length;C(_)},T=(0,_e.useCallback)(()=>{B.current=document.activeElement,N(!0),requestAnimationFrame(()=>{P.current&&P.current.focus()})},[]),M=(0,_e.useCallback)(()=>{N(!1),g(""),b([]),B.current?.focus()},[]);return(0,_e.useEffect)(()=>{if(c)return;let _=I=>{if(!d?.current?.contains(document.activeElement))return;let $=I.ctrlKey&&I.key==="f";if(navigator.userAgent.includes("Macintosh")&&($=I.metaKey&&I.key==="f"),$)if(I.preventDefault(),k)P.current&&P.current.focus();else{T();let K=window.getSelection()?.toString();K&&m(K)}else I.key==="Escape"&&k&&(M(),d?.current&&d.current.focus(),I.preventDefault())};return document.addEventListener("keydown",I=>{_(I)}),()=>{document.removeEventListener("keydown",I=>{_(I)})}},[c,k,T,M,d]),(0,_e.useEffect)(()=>{h(e())},[e,k]),(0,_e.useEffect)(()=>{if(p){let _=z(p);b(_),C((_.length>0,0))}},[f,p]),(0,tt.jsxs)("div",{ref:A,role:"search","aria-label":o,className:`${L.floatingContainer} ${k?L.visible:""}`,style:{zIndex:u},children:[(0,tt.jsx)(Br,{size:"small",placeholder:r,value:p,onChange:(_,I)=>m(I.value),style:{width:a,maxWidth:a,marginLeft:"17px"},ref:P,"aria-label":o,"aria-controls":"search-results-status",onKeyDown:_=>{_.key==="Enter"?_.shiftKey?(S(),_.preventDefault()):(E(),_.preventDefault()):_.key==="Escape"&&(M(),_.preventDefault())}}),(0,tt.jsx)(Ee,{size:200,style:{marginLeft:"5px",color:w.length===0&&p?"var(--vscode-errorForeground)":"",minWidth:"70px"},id:"search-results-count","aria-live":"polite",children:v}),(0,tt.jsx)("div",{ref:F,id:"search-results-status","aria-live":"polite",className:L.srOnly}),(0,tt.jsx)(se,{size:"small",icon:(0,tt.jsx)(pa,{}),appearance:"subtle",disabled:w.length===0,onClick:E,title:i,"aria-label":i}),(0,tt.jsx)(se,{size:"small",icon:(0,tt.jsx)(ba,{}),appearance:"subtle",disabled:w.length===0,onClick:S,title:s,"aria-label":s}),(0,tt.jsx)(se,{size:"small",icon:(0,tt.jsx)(Sa,{}),appearance:"subtle",onClick:M,title:O.common.closeFind,"aria-label":O.common.closeFind})]})}var mm=V(te()),Us=class{node;constructor(t){this.node=t}get id(){return this.node.id}getDisplayText(){return`${this.node.data.schema||""}.${this.node.data.name}`}getSearchableText(){return this.getDisplayText()}getNode(){return this.node}},pm=({parentRef:e})=>{let t=We(),n=(0,hm.useContext)(ue);return(0,mm.jsx)(fm,{getItems:()=>t.getNodes().filter(s=>s.data&&s.data.name).map(s=>new Us(s)),onItemSelected:i=>{n.updateSelectedNodes([i.id]),n.setCenter(i.id,!0)},searchLabel:O.common.find,width:"200px",emitSearchEvent:i=>J.emit("onFindWidgetValueChange",i),parentRef:e})};var Me=V(te()),gm=()=>{let e=(0,ei.useContext)(ue);if(e)return(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(lm,{}),(0,Me.jsxs)(H_,{children:[(0,Me.jsxs)(V_,{children:[(0,Me.jsx)(Jp,{}),(0,Me.jsx)(um,{})]}),(0,Me.jsx)(cm,{}),!e.isInitialized&&(0,Me.jsx)(W_,{})]})]})},H_=({children:e})=>{let t=(0,ei.useRef)(null);return(0,Me.jsxs)("div",{tabIndex:0,ref:t,style:{height:"100%",width:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[(0,Me.jsx)(pm,{parentRef:t}),e]})},V_=({children:e})=>(0,Me.jsx)("div",{style:{maxHeight:"100%",minHeight:"60%",flex:1,width:"100%",display:"flex",flexDirection:"column",position:"relative"},children:e}),W_=()=>(0,Me.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Me.jsx)(Cr,{label:O.schemaDesigner.loadingSchemaDesigner,labelPosition:"below"})});var br=V(te());ym.default.createRoot(document.getElementById("root")).render((0,br.jsx)(Ua,{children:(0,br.jsx)(as,{children:(0,br.jsx)(xp,{children:(0,br.jsx)(gm,{})})})}));
/*! Bundled license information:

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
