"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.deactivate=exports.activate=void 0;var s=require("vscode"),h=require("@vscode/node-speech"),g=require("path"),x=require("crypto"),P=Buffer.from("c497ecfc6c7615e1151ae411f56395a8","hex"),O=Buffer.from("1e69a917232a3369fb03b1ce","hex"),I=Buffer.from("cd5a211f82c6e5f10eccb6646598410461ad75b9a7c0504e62a9822db42ba1f1f76d0fcee2ca1985e45269edf7948b9787311c788323677d1cdeb542aad7c93c700e53dbb5d597dac5653df0127f46f086223389082d6f6617b50632ebab82c23fdb20a51dcb4c052462bfd6e8fbbb746c5c8542660d4a3a4a763f0525c892d859ea6e41e84bdee67c35c2af3fef940766e940928f3f60c9eec50e4d58759871945c6f184d243475849edac019b4dfc893f42f9e3fc373f27c913e5124eef223ef01b463bbbc30d859b685c2ce5e409fddcaf748ac7fde8013f681ef65548deef0d961babeb41dc2e1b97135887ff708b14fd9d7ad6ad57234221a6815a583d9964a4961cb03d685bf013def92de2593adf5eee927c51723445fe9c4e4ad83a2d2a08739f7648a5720e973b1f0044e530a67b1dec363a2ba5a62730e81ec3c90d3b3f08763441480bca6fc81b920317cb2ac7fcb0d9006ea5719413fb03f88211aa38e9b5db175cda4f7004cbda72a7ecedd3249263804aed82d4f407ba7e4a9cce4ca3cb695263a3b0cefde26eb8b3fae0ebde10149112c9a9e374a501636c223d4dfdc9e8b0336414eae54512e0bb59e137d9a377cc0a8f63dcf13b55501d2b35b33806ebb5d88d10b2788651f5b51941be2b2bf09e482a57af758fbe2816bfa93c6ddbded8fe3e2aae6b05351335e9860cba6dfe671beac52a4f3b8dfd3216d1bb9e1d7ce37d623c4f09d84bc9b141360737859bd4e9051ada0b5e8350a2de5a60824c3b267c86ffae9d1d7823d9f9c38007d9e193cbe6c037566a63ab09be78c3c6447ae7da011f2f2999b9002b479c160a50309bb8322456c464d55c16779f15e275a0a42d67a37f37bad26ab6ede1938b9e747f4c95a77574947f30140ceae21f5b86e2f348c2bdef36811bf9703ad7d5935d944a46ddee2470b82d85a73de7a81c6701ae8bee8add484f1e9badfa5cb88a51bc359e2375fd7caa7ae86fa2be8d7fc6494593d298145935b6deaa7","hex"),_="You may only use the C/C++ Extension for Visual Studio Code and C# Extension for Visual Studio Code with Visual Studio Code, Visual Studio or Xamarin Studio software to help you develop and test your applications. The software is licensed, not sold. This agreement only gives you some rights to use the software. Microsoft reserves all other rights. You may not work around any technical limitations in the software; reverse engineer, decompile or disassemble the software remove, minimize, block or modify any notices of Microsoft or its suppliers in the software share, publish, rent, or lease the software, or provide the software as a stand-alone hosted as solution for others to use.";function M(a,e,l,u){let d=(0,x.createHash)("sha256");d.update(a);let o=d.digest(),i=(0,x.createDecipheriv)("aes-256-gcm",o,l);return i.setAuthTag(e),Buffer.concat([i.update(u),i.final()]).toString()}var m="2",k=M(_,P,O,I),N=process.env.VSCODE_SPEECH_LOGS_PATH,v=new Map,S={version:m,modelName:"Microsoft Speech Recognizer en-US FP Model V9",modelPath:(0,g.join)(__dirname,"..","assets","stt"),locale:"en-US",phrases:["slash","Slash","At workspace","workspace","At code","code","fix","search","explain"]};v.set(S.locale,S);function A({modelName:a,modelPath:e,phrases:l},u){return h.createTranscriber({modelName:a,modelPath:e,modelKey:k,logsPath:N,phrases:l},(d,o)=>u(d,o))}var $=class{transcriber;constructor(e){this.transcriber=this.create(e)}create(e){let l=new s.EventEmitter,u=new s.EventEmitter,d=A(e,(o,i)=>{o?u.fire(o):l.fire(i)});return{onResult:l.event,onError:u.event,start:()=>d.start(),stop:()=>d.stop(),dispose:()=>{d.dispose(),l.dispose(),u.dispose()}}}start(e,l){let u=this.transcriber.onResult(o=>l(void 0,o)),d=this.transcriber.onError(o=>l(o,{status:h.TranscriptionStatusCode.ERROR,data:o.message}));e.onabort=()=>{this.transcriber.stop(),u.dispose(),d.dispose()},this.transcriber.start()}};function R(){for(let a of s.extensions.all)if(a.packageJSON.contributes?.vscodeSpeechModels)for(let e of a.packageJSON.contributes.vscodeSpeechModels)v.set(e.locale,{version:e.version,modelName:e.modelName,modelPath:(0,g.join)(a.extensionPath,e.modelPath),locale:e.locale})}var T=new Map,E={version:m,modelName:"Microsoft Server Speech Text to Speech Voice (en-US, AriaNeural)",modelPath:(0,g.join)(__dirname,"..","assets","tts"),locale:"en-US"};T.set(E.locale,E);function K({modelName:a,modelPath:e},l){return h.createSynthesizer({modelName:a,modelPath:e,modelKey:k,logsPath:N},(u,d)=>l(u,d))}var y=class{model;synthesizer=void 0;constructor(e){this.model=e}synthesize(e,l,u){this.synthesizer&&this.synthesizer.dispose();let d=this.synthesizer=this.create(this.model),o=d.onResult(t=>u(void 0,t)),i=d.onError(t=>u(t,{status:h.SynthesizerStatusCode.ERROR,data:t.message}));l.onabort=()=>{d.stop(),o.dispose(),i.dispose()},d.synthesize(e)}create(e){let l=new s.EventEmitter,u=new s.EventEmitter,d=K(e,(o,i)=>{o?u.fire(o):l.fire(i)});return{onResult:l.event,onError:u.event,synthesize:o=>d.synthesize(o),stop:()=>d.stop(),dispose:()=>{d.dispose(),l.dispose(),u.dispose()}}}};function w(){for(let a of s.extensions.all)if(a.packageJSON.contributes?.vscodeSynthesizerModels)for(let e of a.packageJSON.contributes.vscodeSynthesizerModels)T.set(e.locale,{version:e.version,modelName:e.modelName,modelPath:(0,g.join)(a.extensionPath,e.modelPath),locale:e.locale})}var q=(0,g.join)(__dirname,"..","assets","keyword","heycode.table");function L(a){return h.recognize({modelPath:q,signal:a})}function z(a,e){s.commands.executeCommand("workbench.extensions.installExtension",U(a),{justification:e?`Support for '${D[a]}' in speech recognition requires this extension.`:`Support for '${D[a]}' in speech synthesis requires this extension.`,enable:!0})}var D={"da-DK":"Danish (Denmark)","de-DE":"German (Germany)","en-AU":"English (Australia)","en-CA":"English (Canada)","en-GB":"English (United Kingdom)","en-IE":"English (Ireland)","en-IN":"English (India)","en-NZ":"English (New Zealand)",[S.locale]:"English (United States)","es-ES":"Spanish (Spain)","es-MX":"Spanish (Mexico)","fr-CA":"French (Canada)","fr-FR":"French (France)","hi-IN":"Hindi (India)","it-IT":"Italian (Italy)","ja-JP":"Japanese (Japan)","ko-KR":"Korean (South Korea)","nl-NL":"Dutch (Netherlands)","pt-PT":"Portuguese (Portugal)","pt-BR":"Portuguese (Brazil)","ru-RU":"Russian (Russia)","sv-SE":"Swedish (Sweden)","tr-TR":"Turkish (Turkey)","zh-CN":"Chinese (Simplified, China)","zh-HK":"Chinese (Traditional, Hong Kong)","zh-TW":"Chinese (Traditional, Taiwan)"};function U(a){return`ms-vscode.vscode-speech-language-pack-${a.toLowerCase()}`}function V(){return!!["Visual Studio Code","Visual Studio Code - Insiders","Visual Studio Code - Exploration","Code - OSS","Code - OSS Dev"].includes(s.env.appName)}function G(a){let e=s.window.createOutputChannel("VS Code Speech",{log:!0});if(a.subscriptions.push(e),!V()){e.error(`[vscode-speech] This extension is not supported in ${s.env.appName}.`);return}a.subscriptions.push(s.commands.registerCommand("vscode-speech.openSettings",()=>{s.commands.executeCommand("workbench.action.openSettings","voice")})),R(),w(),a.subscriptions.push(s.extensions.onDidChange(()=>{R(),w()}));let l=0,u=new Map,d=new Map;a.subscriptions.push(s.speech.registerSpeechProvider(a.extension.id,{provideSpeechToTextSession:(o,i)=>{let t=new s.EventEmitter;if(o.isCancellationRequested)return{onDidChange:t.event};if(i?.language&&!v.has(i.language))return z(i.language,!0),setTimeout(()=>t.fire({status:s.SpeechToTextStatus.Stopped})),{onDidChange:t.event};let r=l++,n=v.get(i?.language??S.locale);(!n||n.version!==m)&&(n=S),e.trace(`[vscode-speech-${r}] starting speech-to-text session (language: ${n.locale}, model: ${n.modelName}, path: ${n.modelPath})`);let b=new AbortController;o.onCancellationRequested(()=>{e.trace(`[vscode-speech-${r}] aborting speech-to-text session`),b.abort(),t.dispose()});let p=u.get(n.locale);return p||(p=new $(n),u.set(n.locale,p)),p.start(b.signal,(f,c)=>{switch(f&&(e.error(`[vscode-speech-${r}] speech-to-text error: ${f.message}`),t.fire({status:s.SpeechToTextStatus.Error,text:f.message})),c.status){case h.TranscriptionStatusCode.STARTED:e.trace(`[vscode-speech-${r}] started speech-to-text session${c.data?`: ${c.data}`:""}`),t.fire({status:s.SpeechToTextStatus.Started});break;case h.TranscriptionStatusCode.RECOGNIZING:e.trace(`[vscode-speech-${r}] recognizing: ${c.data}`),t.fire({status:s.SpeechToTextStatus.Recognizing,text:c.data});break;case h.TranscriptionStatusCode.RECOGNIZED:e.trace(`[vscode-speech-${r}] recognized: ${c.data}`),t.fire({status:s.SpeechToTextStatus.Recognized,text:c.data});break;case h.TranscriptionStatusCode.STOPPED:e.trace(`[vscode-speech-${r}] stopped speech-to-text session${c.data?`: ${c.data}`:""}`),t.fire({status:s.SpeechToTextStatus.Stopped});break;case h.TranscriptionStatusCode.ERROR:e.error(`[vscode-speech-${r}] speech-to-text error: ${c.data}`),t.fire({status:s.SpeechToTextStatus.Error,text:c.data});break;case h.TranscriptionStatusCode.SPEECH_START_DETECTED:e.trace(`[vscode-speech-${r}] speech start detected${c.data?`: ${c.data}`:""}`);break;case h.TranscriptionStatusCode.SPEECH_END_DETECTED:e.trace(`[vscode-speech-${r}] speech end detected${c.data?`: ${c.data}`:""}`);break;case h.TranscriptionStatusCode.NOT_RECOGNIZED:e.trace(`[vscode-speech-${r}] not recognized${c.data?`: ${c.data}`:""}`);break;case h.TranscriptionStatusCode.INITIAL_SILENCE_TIMEOUT:e.trace(`[vscode-speech-${r}] initial silence timeout${c.data?`: ${c.data}`:""}`);break;case h.TranscriptionStatusCode.END_SILENCE_TIMEOUT:e.trace(`[vscode-speech-${r}] end silence timeout${c.data?`: ${c.data}`:""}`);break;case h.TranscriptionStatusCode.DISPOSED:e.trace(`[vscode-speech-${r}] disposed speech-to-text session${c.data?`: ${c.data}`:""}`);break}}),{onDidChange:t.event}},provideTextToSpeechSession(o,i){let t=new s.EventEmitter;if(o.isCancellationRequested)return{onDidChange:t.event,synthesize:()=>{}};if(i?.language&&!T.has(i.language))return z(i.language,!1),setTimeout(()=>t.fire({status:s.TextToSpeechStatus.Stopped})),{onDidChange:t.event,synthesize:()=>{}};let r=l++,n=T.get(i?.language??E.locale);(!n||n.version!==m)&&(n=E),e.trace(`[vscode-speech-${r}] starting text-to-speech session (language: ${n.locale}, model: ${n.modelName}, path: ${n.modelPath})`);let b=new AbortController;o.onCancellationRequested(()=>{e.trace(`[vscode-speech-${r}] aborting text-to-speech session`),b.abort(),t.dispose()});let p=d.get(n.locale);return p||(p=new y(n),d.set(n.locale,p)),{onDidChange:t.event,synthesize(f){o.isCancellationRequested||(e.trace(`[vscode-speech-${r}] synthesize: ${f}`),p.synthesize(f,b.signal,(c,C)=>{switch(c&&(e.error(`[vscode-speech-${r}] text-to-speech error: ${c.message}`),t.fire({status:s.TextToSpeechStatus.Error,text:c.message})),C.status){case h.SynthesizerStatusCode.STARTED:e.trace(`[vscode-speech-${r}] started text-to-speech session`),t.fire({status:s.TextToSpeechStatus.Started});break;case h.SynthesizerStatusCode.STOPPED:e.trace(`[vscode-speech-${r}] stopped text-to-speech session`),t.fire({status:s.TextToSpeechStatus.Stopped});break;case h.SynthesizerStatusCode.ERROR:e.error(`[vscode-speech-${r}] text-to-speech error: ${C.data}`),t.fire({status:s.TextToSpeechStatus.Error,text:C.data});break;case h.SynthesizerStatusCode.DISPOSED:e.trace(`[vscode-speech-${r}] disposed text-to-speech session`);break}}))}}},provideKeywordRecognitionSession:o=>{let i=new s.EventEmitter;if(o.isCancellationRequested)return{onDidChange:i.event};let t=l++;e.trace(`[vscode-speech-${t}] starting keyword-recognition session`);let r=new AbortController;return o.onCancellationRequested(()=>{e.trace(`[vscode-speech-${t}] aborting keyword-recognition session`),r.abort(),i.dispose()}),L(r.signal).then(n=>{switch(n.status){case h.KeywordRecognitionStatusCode.RECOGNIZED:e.trace(`[vscode-speech-${t}] keyword recognized: ${n.data}`),i.fire({status:s.KeywordRecognitionStatus.Recognized,text:n.data});break;case h.KeywordRecognitionStatusCode.STOPPED:e.trace(`[vscode-speech-${t}] stopped keyword-recognition session${n.data?`: ${n.data}`:""}`),i.fire({status:s.KeywordRecognitionStatus.Stopped});break;case h.KeywordRecognitionStatusCode.ERROR:e.error(`[vscode-speech-${t}] keyword-recognition error: ${n.data}`);break}},n=>{e.error(`[vscode-speech-${t}] keyword-recognition error: ${n.message}`)}),{onDidChange:i.event}}}))}exports.activate=G;function H(){}exports.deactivate=H;
//# sourceMappingURL=extension.js.map
